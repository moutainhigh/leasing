<?xml version="1.0" encoding="GBK"?>
<!DOCTYPE mapper
PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN"
"http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">
<mapper namespace="FinancingInstitution">
<select id="getFinancingList" parameterType="Map" resultType="Map">
	SELECT TT.* FROM (
	   SELECT T.*,ROWNUM ROWNO FROM (
		   SELECT SUP.SUP_ID,
		          SUP.SCODE,
				  SUP.SUP_FLAG,
				  SUP.SUP_CODE,
				  SUP.SUP_NAME,
				  SUP.SUP_SHORTNAME,
				  SUP.COMPANY_ID,
				  SUP.CORP_BUSINESS_LICENSE,
				  SUP.SUP_ADDRESS,
				  SUP.SUP_FAX,
				  SUP.SUP_ZIP,
				  SUP.ORAGNIZATION_CODE,
				  SUP.TAX_CODE,
				  SUP.CREDIT_GRADE,
				  TO_CHAR(SUP.SETUP_DATE,'YYYY-MM-DD') SETUP_DATE,
				  TO_CHAR(SUP.PERIOD_VALIDITY,'YYYY-MM-DD') PERIOD_VALIDITY,
				  SUP.REGISTE_CAPITAL,
				  SUP.PAICLUP_CAPITAL,
				  SUP.BUSINESS_RANGE,
				  SUP.SUP_WEBSITE,
				  SUP.SUP_MANAGER,
				  SUP.PRO_INDUSTRY,
				  SUP.IS_REPO,
				  SUP.AREA_ID,
				  (SELECT AR.NAME FROM T_SYS_AREA AR WHERE AR.ID=SUP.AREA_ID) AREA_NAME,
				  SUP.PROV_ID,
				  (SELECT AR.NAME FROM T_SYS_AREA AR WHERE AR.ID=SUP.PROV_ID) PROV_NAME,
				  SUP.CITY_ID,
				  (SELECT AR.NAME FROM T_SYS_AREA AR WHERE AR.ID=SUP.CITY_ID) CITY_NAME,
				  TO_CHAR(SUP.SIGN_DATE,'YYYY-MM-DD') SIGN_DATE,
				  SUP.OPEN_BANK,
				  SUP.OPEN_BANK_NUMBER,
				  SUP.SUP_LEGAL_NAME,
				  SUP.SUP_LEGAL_PHONE,
				  SUP.SUP_LEGAL_MOBIL,
				  SUP.SUB_LEGAL_ADDRESS,
				  SUP.SUB_LEGAL_EMAIL,
				  SUP.BILL_ADDRESS,
				  SUP.BILL_PHONE,
				  SUP.TAX_QUAL,
				  SUP.TAX_IDEN_NUM,
				  SUP.EMS_TO_NAME,
				  SUP.EMS_TO_ADDRESS,
				  SUP.EMS_TO_PHONE,
				  SUP.EMS_TO_ZIP,
				  SUP.LOANS_OWN_UNIT,
				  SUP.LOANS_OWN_ADDR,
				  SUP.LOANS_OWN_BANK,
				  SUP.LOANS_OWN_ACCOUNT,
				  SUP.LOANS_TOTAL_UNIT,
				  SUP.LOANS_TOTAL_ADDDR,
				  SUP.LOANS_TOTAL_BANK,
				  SUP.LOANS_TOTAL_ACCOUNT,
				  SUP.SUB_SCORE,
				  SUP.FILE_NUMBER,
				  SUP.USER_ID,
				  SUP.CREATE_DATE,
				  SUP.SUP_LEVEL,
				  NVL(SUP.SUP_SWITCH,0) SUP_SWITCH,
				  NVL(SUP.SCAN_SWITCH,0) SCAN_SWITCH,
				  NVL(SUP.CREDIT_SWITCH,0) CREDIT_SWITCH,
				  NVL(SUP.PAYMENT_SWITCH,0) PAYMENT_SWITCH, 
				  NVL(SUP.YINGYE_STATUS,0) YINGYE_STATUS,
				  NVL(SUP.BALANCE_LOAN_SWITCH,0) BALANCE_LOAN_SWITCH,
				  NVL(SUP.IRREGULAR_REPAYMENT_SWITCH,0) IRREGULAR_REPAYMENT_SWITCH,
				  NVL(SUP.B_MODEL_SWITCH,0) B_MODEL_SWITCH,
				  NVL(SUP.SMS_SWITCH,0) SMS_SWITCH,
				  NVL(SUP.DATAFILL_SWITCH,0) DATAFILL_SWITCH,
				  (SELECT DIC.FLAG FROM T_SYS_DATA_DICTIONARY DIC WHERE DIC.CODE = SUP.STATUS AND DIC.TYPE = #{DIC_SUP_STATUS}) STATUS,
				  TTT.ZLSTATUS,
				  SUP.SCORE,
				  SUP.SUP_TYPE,
				  SUP.STATUS AS SUP_STATUS
			 FROM T_SYS_SUPPLIERS SUP,
			      --存在已到期未补齐的项目 STATUS是4
			      (SELECT  VESC.SUPPLIER_IDS SUPPLIER_ID,
						   FPSI.STATUS ZLSTATUS
				   FROM FIL_PROJ_SUB_INFO FPSI
				   LEFT JOIN FIL_PROJECT_HEAD FPH
				     ON FPH.ID = FPSI.PROJ_ID
				   LEFT JOIN FIL_CUST_CLIENT FCC
				     ON FCC.ID = FPH.CLIENT_ID
				   LEFT JOIN V_EQUIPMENT_SUPS_COMS VESC
				     ON VESC.PROJECT_ID = FPH.ID
				   LEFT JOIN T_SYS_DATA_DICTIONARY TSDD
				     ON TSDD.TYPE = '资料补齐状态'
				    AND FPSI.STATUS = TSDD.CODE
				  WHERE FPH.PRO_CODE NOT LIKE '%TEST%'
				    AND FPSI.QZ_DATE IS NOT NULL 
				    AND FPSI.STATUS = 4
			   GROUP BY VESC.SUPPLIER_IDS,FPSI.STATUS) TTT
			WHERE  SUP.SUP_ID = TTT.SUPPLIER_ID(+) 
			and  sup.sup_id not in (select ssd.sup_id from t_sys_supp_dealer ssd)
			<if test="SUP_NAME !=null and SUP_NAME !=''">AND SUP.SUP_NAME LIKE  '%${SUP_NAME}%'</if>
			<if test="SUP_SHORTNAME !=null and SUP_SHORTNAME !=''">AND SUP.SUP_SHORTNAME LIKE  '%${SUP_SHORTNAME}%'</if>
			<if test="BUSINESS_SECTOR !=null and BUSINESS_SECTOR !=''">AND COM.BUSINESS_SECTOR = #{BUSINESS_SECTOR}</if>
			<if test="CREATE_TIME !=null and CREATE_TIME !=''">AND SUP.CREATE_DATE = TO_DATE(#{CREATE_TIME},'YYYY-MM-DD')</if>
			
			<if test="SUP_TYPE !=null and SUP_TYPE != ''">AND SUP.SUP_TYPE = #{SUP_TYPE}</if>
			<if test="SYS_BIGAREAID != null and SYS_BIGAREAID != ''">and SUP.AREA_ID = #{SYS_BIGAREAID}</if>
			ORDER BY SUP.CREATE_DATE DESC
	 )T)TT WHERE ROWNO BETWEEN #{PAGE_BEGIN} AND #{PAGE_END}
</select>

<select id="getFinancingCount" parameterType="Map" resultType="int">
   SELECT COUNT(1)
	 FROM (SELECT SUP.SUP_ID,
		          SUP.SCODE,
				  SUP.SUP_FLAG,
				  SUP.SUP_CODE,
				  SUP.SUP_NAME,
				  SUP.SUP_SHORTNAME,
				  SUP.COMPANY_ID,
				  SUP.CORP_BUSINESS_LICENSE,
				  SUP.SUP_ADDRESS,
				  SUP.SUP_FAX,
				  SUP.SUP_ZIP,
				  SUP.ORAGNIZATION_CODE,
				  SUP.TAX_CODE,
				  SUP.CREDIT_GRADE,
				  TO_CHAR(SUP.SETUP_DATE,'YYYY-MM-DD') SETUP_DATE,
				  TO_CHAR(SUP.PERIOD_VALIDITY,'YYYY-MM-DD') PERIOD_VALIDITY,
				  SUP.REGISTE_CAPITAL,
				  SUP.PAICLUP_CAPITAL,
				  SUP.BUSINESS_RANGE,
				  SUP.SUP_WEBSITE,
				  SUP.SUP_MANAGER,
				  SUP.PRO_INDUSTRY,
				  SUP.IS_REPO,
				  SUP.AREA_ID,
				  (SELECT AR.NAME FROM T_SYS_AREA AR WHERE AR.ID=SUP.AREA_ID) AREA_NAME,
				  SUP.PROV_ID,
				  (SELECT AR.NAME FROM T_SYS_AREA AR WHERE AR.ID=SUP.PROV_ID) PROV_NAME,
				  SUP.CITY_ID,
				  (SELECT AR.NAME FROM T_SYS_AREA AR WHERE AR.ID=SUP.CITY_ID) CITY_NAME,
				  TO_CHAR(SUP.SIGN_DATE,'YYYY-MM-DD') SIGN_DATE,
				  SUP.OPEN_BANK,
				  SUP.OPEN_BANK_NUMBER,
				  SUP.SUP_LEGAL_NAME,
				  SUP.SUP_LEGAL_PHONE,
				  SUP.SUP_LEGAL_MOBIL,
				  SUP.SUB_LEGAL_ADDRESS,
				  SUP.SUB_LEGAL_EMAIL,
				  SUP.BILL_ADDRESS,
				  SUP.BILL_PHONE,
				  SUP.TAX_QUAL,
				  SUP.TAX_IDEN_NUM,
				  SUP.EMS_TO_NAME,
				  SUP.EMS_TO_ADDRESS,
				  SUP.EMS_TO_PHONE,
				  SUP.EMS_TO_ZIP,
				  SUP.LOANS_OWN_UNIT,
				  SUP.LOANS_OWN_ADDR,
				  SUP.LOANS_OWN_BANK,
				  SUP.LOANS_OWN_ACCOUNT,
				  SUP.LOANS_TOTAL_UNIT,
				  SUP.LOANS_TOTAL_ADDDR,
				  SUP.LOANS_TOTAL_BANK,
				  SUP.LOANS_TOTAL_ACCOUNT,
				  SUP.SUB_SCORE,
				  SUP.FILE_NUMBER,
				  SUP.USER_ID,
				  SUP.CREATE_DATE,
				  SUP.SUP_LEVEL,
				  NVL(SUP.SUP_SWITCH,0) SUP_SWITCH,
				  NVL(SUP.SCAN_SWITCH,0) SCAN_SWITCH,
				  NVL(SUP.CREDIT_SWITCH,0) CREDIT_SWITCH,
				  NVL(SUP.PAYMENT_SWITCH,0) PAYMENT_SWITCH, 
				  NVL(SUP.YINGYE_STATUS,0) YINGYE_STATUS,
				  NVL(SUP.BALANCE_LOAN_SWITCH,0) BALANCE_LOAN_SWITCH,
				  NVL(SUP.IRREGULAR_REPAYMENT_SWITCH,0) IRREGULAR_REPAYMENT_SWITCH,
				  NVL(SUP.B_MODEL_SWITCH,0) B_MODEL_SWITCH,
				  NVL(SUP.SMS_SWITCH,0) SMS_SWITCH,
				  NVL(SUP.DATAFILL_SWITCH,0) DATAFILL_SWITCH,
				  (SELECT DIC.FLAG FROM T_SYS_DATA_DICTIONARY DIC WHERE DIC.CODE = SUP.STATUS AND DIC.TYPE = #{DIC_SUP_STATUS}) STATUS,
				  TTT.ZLSTATUS,
				  SUP.SCORE,
				  SUP.SUP_TYPE,
				  SUP.STATUS AS SUP_STATUS
			 FROM T_SYS_SUPPLIERS SUP,
			      --存在已到期未补齐的项目 STATUS是4
			      (SELECT  VESC.SUPPLIER_IDS SUPPLIER_ID,
						   FPSI.STATUS ZLSTATUS
				   FROM FIL_PROJ_SUB_INFO FPSI
				   LEFT JOIN FIL_PROJECT_HEAD FPH
				     ON FPH.ID = FPSI.PROJ_ID
				   LEFT JOIN FIL_CUST_CLIENT FCC
				     ON FCC.ID = FPH.CLIENT_ID
				   LEFT JOIN V_EQUIPMENT_SUPS_COMS VESC
				     ON VESC.PROJECT_ID = FPH.ID
				   LEFT JOIN T_SYS_DATA_DICTIONARY TSDD
				     ON TSDD.TYPE = '资料补齐状态'
				    AND FPSI.STATUS = TSDD.CODE
				  WHERE FPH.PRO_CODE NOT LIKE '%TEST%'
				    AND FPSI.QZ_DATE IS NOT NULL 
				    AND FPSI.STATUS = 4
			   GROUP BY VESC.SUPPLIER_IDS,FPSI.STATUS) TTT
			WHERE  SUP.SUP_ID = TTT.SUPPLIER_ID(+) 
			and  sup.sup_id not in (select ssd.sup_id from t_sys_supp_dealer ssd)
			<if test="SUP_NAME !=null and SUP_NAME !=''">AND SUP.SUP_NAME LIKE  '%${SUP_NAME}%'</if>
			<if test="SUP_SHORTNAME !=null and SUP_SHORTNAME !=''">AND SUP.SUP_SHORTNAME LIKE  '%${SUP_SHORTNAME}%'</if>
			<if test="BUSINESS_SECTOR !=null and BUSINESS_SECTOR !=''">AND COM.BUSINESS_SECTOR = #{BUSINESS_SECTOR}</if>
			<if test="CREATE_TIME !=null and CREATE_TIME !=''">AND SUP.CREATE_DATE = TO_DATE(#{CREATE_TIME},'YYYY-MM-DD')</if>
			
			<if test="SUP_TYPE !=null and SUP_TYPE != ''">AND SUP.SUP_TYPE = #{SUP_TYPE}</if>
			<if test="SYS_BIGAREAID != null and SYS_BIGAREAID != ''">and SUP.AREA_ID = #{SYS_BIGAREAID}</if>
			ORDER BY SUP.CREATE_DATE DESC)
</select>

<select id="getOneSupp" parameterType="Map" resultType="Map">
   SELECT SUP.SUP_ID,
          SUP.SCODE,
		  SUP.SUP_FLAG,
		  SUP.SUP_CODE,
		  SUP.SUP_NAME,
		  SUP.SUP_SHORTNAME,
		  SUP.COMPANY_ID,
		  SUP.CORP_BUSINESS_LICENSE,
		  SUP.SUP_ADDRESS,
		  SUP.SUP_FAX,
		  SUP.SUP_ZIP,
		  SUP.CREDIT_GRADE,
		  SUP.ORAGNIZATION_CODE,
		  SUP.TAX_CODE,
		  TO_CHAR(SUP.SETUP_DATE,'YYYY-MM-DD') SETUP_DATE,
		  TO_CHAR(SUP.PERIOD_VALIDITY,'YYYY-MM-DD') PERIOD_VALIDITY,
		  SUP.REGISTE_CAPITAL,
		  SUP.PAICLUP_CAPITAL,
		  SUP.BUSINESS_RANGE,
		  SUP.SUP_WEBSITE,
		  SUP.SUP_MANAGER,
		  SUP.PRO_INDUSTRY,
		  SUP.IS_REPO,
		  SUP.AREA_ID,
		  (SELECT AR.NAME FROM T_SYS_AREA AR WHERE AR.ID=SUP.AREA_ID) AREA_NAME,
		  SUP.PROV_ID,
		  (SELECT AR.NAME FROM T_SYS_AREA AR WHERE AR.ID=SUP.PROV_ID) PROV_NAME,
		  SUP.CITY_ID,
		  (SELECT AR.NAME FROM T_SYS_AREA AR WHERE AR.ID=SUP.CITY_ID) CITY_NAME,
		  TO_CHAR(SUP.SIGN_DATE,'YYYY-MM-DD') SIGN_DATE,
		  SUP.OPEN_BANK,
		  SUP.OPEN_BANK_NUMBER,
		  SUP.SUP_LEGAL_NAME,
		  SUP.SUP_LEGAL_PHONE,
		  SUP.SUP_LEGAL_MOBIL,
		  SUP.SUB_LEGAL_ADDRESS,
		  SUP.SUB_LEGAL_EMAIL,
		  SUP.SUP_LEGAL_IDCARD,
		  SUP.BILL_ADDRESS,
		  SUP.BILL_PHONE,
		  getDictShortnameByCode('纳税资质',SUP.TAX_QUAL) TAX_QUAL,
		  SUP.TAX_IDEN_NUM,
		  SUP.EMS_TO_NAME,
		  SUP.EMS_TO_ADDRESS,
		  SUP.EMS_TO_PHONE,
		  SUP.EMS_TO_ZIP,
		  SUP.LOANS_OWN_UNIT,
		  SUP.LOANS_OWN_ADDR,
		  SUP.LOANS_OWN_BANK,
		  SUP.LOANS_OWN_ACCOUNT,
		  SUP.LOANS_TOTAL_UNIT,
		  SUP.LOANS_TOTAL_ADDDR,
		  SUP.LOANS_TOTAL_BANK,
		  SUP.LOANS_TOTAL_ACCOUNT,
		  SUP.LOANS_COMPANY_UNIT,
		  SUP.LOANS_COMPANY_ADDR,
		  SUP.LOANS_COMPANY_BANK,
		  SUP.LOANS_COMPANY_ACCOUNT,
		  SUP.SUB_SCORE,
		  SUP.FILE_NUMBER,
		  SUP.USER_ID,
		  SUP.CREATE_DATE,
		  SUP.SUP_LEVEL,
		  NVL(SUP.SUP_SWITCH,0) SUP_SWITCH,
		  NVL(SUP.CREDIT_SWITCH,0) CREDIT_SWITCH,
		  NVL(SUP.SCAN_SWITCH,0) SCAN_SWITCH,
		  NVL(SUP.PAYMENT_SWITCH,0) PAYMENT_SWITCH, 
		  NVL(SUP.SCAN_SWITCH,0) SCAN_SWITCH, 
		  NVL(SUP.BALANCE_LOAN_SWITCH,0) BALANCE_LOAN_SWITCH,
		  NVL(SUP.IRREGULAR_REPAYMENT_SWITCH,0) IRREGULAR_REPAYMENT_SWITCH,
		  NVL(SUP.B_MODEL_SWITCH,0) B_MODEL_SWITCH,
		  NVL(SUP.SMS_SWITCH,0) SMS_SWITCH,
		  NVL(SUP.DATAFILL_SWITCH,0) DATAFILL_SWITCH,
		  SUP.STATUS,
		  SUP.LENDING_TYPE,
		  SUP.SUP_TYPE,
		  SUP.PARENT_ID,
		  SUP.COMMISSION_RATIO,
		  SUP.COMMISSION_AMOUNT,
		  SUP.SUB_LEGAL_PROV,
		  SUP.SUB_LEGAL_CITY,
		  SUP.SUB_LEGAL_AREA,
		  SUP.LOANS_OWN_PAY,
		  SUP.LOANS_TOTAL_PAY,
		  SUP.LOANS_COMPANY_PAY
	 FROM T_SYS_SUPPLIERS SUP
	WHERE 1=1
	<if test="SUP_ID !=null and SUP_ID !=''">AND SUP.SUP_ID = #{SUP_ID}</if>
	<if test="SUP_NAME !=null and SUP_NAME !=''">AND SUP.SUP_NAME LIKE  '%${SUP_NAME}%'</if>
</select>

<select id="getOneSuppInfo" parameterType="Map" resultType="Map">
   SELECT 
          INFO.NAME
          ,INFO.TYPE
          ,INFO.ID_CARD_TYPE
          ,INFO.ID_CARD_NO
          ,INFO.SEX
          ,INFO.BIRTHDAY
          ,INFO.TEL_PHONE
          ,INFO.PHONE
          ,INFO.POST
          ,INFO.DEGREE_EDU
          ,INFO.POSITION
          ,INFO.WORK_UNIT
          ,INFO.COMPANY_ADDR
          ,INFO.COMPANY_PROPERTY
          ,INFO.ENTRY_TIME
          ,INFO.HOUSE_ADDRESS
          ,INFO.HOUSR_RE_ADDRESS
          ,INFO.IS_MARRY
          ,INFO.IS_CHILDRED
          ,INFO.NATION
          ,INFO.FAX
          ,INFO.BUSINESS_TYPE
          ,INFO.CORP_BUSINESS_LICENSE
          ,INFO.TAX_CODE
          ,TO_CHAR(INFO.SETUP_DATE,'YYYY-MM-DD') SETUP_DATE
          ,TO_CHAR(INFO.REGISTE_DATE,'YYYY-MM-DD') REGISTE_DATE
          ,INFO.REGISTE_CAPITAL
          ,INFO.ORAGNIZATION_CODE
          ,INFO.REGISTE_ADDRESS
          ,INFO.RATEPAYING
          ,INFO.REGISTE_PHONE
          ,INFO.NUMBER_PER
          ,INFO.WORK_ADDRESS
          ,INFO.TAX_QUALIFICATION
          ,INFO.PROVINCE
          ,INFO.CITY
          ,INFO.REMARK
          ,INFO.CREATE_CODE
          ,INFO.CREATE_TIME
          ,INFO.UPDATE_CODE
          ,INFO.UPDATE_TIME
          ,INFO.STATUS
          ,INFO.CLERK_CODE
          ,INFO.CLERK_NAME
          ,INFO.PERIOD_OF_VALIDITY
          ,INFO.IS_GUARANTEE
          ,INFO.MAIN_BUSINESS
          ,INFO.LEGAL_PERSON
          ,INFO.LEGAL_PERSON_PHONE
          ,INFO.IDCARD_CHECK
          ,INFO.IDCARD_PHOTO
          ,INFO.CUST_ID
          ,INFO.ORG_ID
          ,INFO.SUPP_ID
          ,INFO.PROV_INSTALMENT_ID
          ,INFO.PROV_ID
          ,INFO.EMS_ID
          ,INFO.SCALE_ENTERPRISE
          ,INFO.INDUSTRY_FICATION
          ,INFO.USER_NAME
          ,INFO.PASSWORD
          ,INFO.JUDGE_GUARANTOR
          ,INFO.USER_YEAR
          ,INFO.PHYSICAL_STATE
          ,INFO.CUST_LEVER
          ,INFO.SCORE
          ,INFO.SCALE_SOURCE
          ,INFO.CUST_STATUS
          ,INFO.MAIL_ADDRESS
          ,INFO.RC_CURRENCY_TYPE
          ,INFO.SUP_ID
          ,INFO.WORK_PROV
          ,INFO.WORK_CITY
          ,INFO.WORK_AREA
          
	 FROM T_SYS_SUPPLIERS_INFO INFO,
	      T_SYS_SUPPLIERS SUP
	WHERE INFO.SUP_ID = SUP.SUP_ID(+)
	<if test="SUP_ID !=null and SUP_ID !=''">AND SUP.SUP_ID = #{SUP_ID}</if>
</select>

<select id="getSupplierSeq" resultType="int">
  SELECT SEQ_T_SYS_SUPPLIERS.NEXTVAL FROM DUAL
</select>

<insert id="addSupplier" parameterType="Map">
INSERT INTO T_SYS_SUPPLIERS
  ( 
    SUP_ID
    ,SCODE
    <if test="SUP_FLAG !=null and SUP_FLAG !=''">,SUP_FLAG</if>
    <if test="SUP_CODE !=null and SUP_CODE !=''">,SUP_CODE</if>
    <if test="SUP_NAME !=null and SUP_NAME !=''">,SUP_NAME</if>
    <if test="SUP_SHORTNAME !=null and SUP_SHORTNAME !=''">,SUP_SHORTNAME</if>
    <!-- <if test="COMPANY_ID !=null and COMPANY_ID !=''">,COMPANY_ID</if> -->
    <if test="CORP_BUSINESS_LICENSE !=null and CORP_BUSINESS_LICENSE !=''">,CORP_BUSINESS_LICENSE</if>
    <if test="SUP_ADDRESS !=null and SUP_ADDRESS !=''">,SUP_ADDRESS</if>
    <if test="SUP_FAX !=null and SUP_FAX !=''">,SUP_FAX</if>
    <if test="SUP_ZIP !=null and SUP_ZIP !=''">,SUP_ZIP</if>
    <if test="ORAGNIZATION_CODE !=null and ORAGNIZATION_CODE !=''">,ORAGNIZATION_CODE</if>
    <if test="TAX_CODE !=null and TAX_CODE !=''">,TAX_CODE</if>
    <if test="CREDIT_GRADE !=null and CREDIT_GRADE !=''">,CREDIT_GRADE</if>
    <if test="SETUP_DATE !=null and SETUP_DATE !=''">,SETUP_DATE</if>
    <if test="PERIOD_VALIDITY !=null and PERIOD_VALIDITY !=''">,PERIOD_VALIDITY</if>
    <if test="REGISTE_CAPITAL !=null and REGISTE_CAPITAL !=''">,REGISTE_CAPITAL</if>
    <if test="PAICLUP_CAPITAL !=null and PAICLUP_CAPITAL !=''">,PAICLUP_CAPITAL</if>
    <if test="BUSINESS_RANGE !=null and BUSINESS_RANGE !=''">,BUSINESS_RANGE</if>
    <if test="SUP_WEBSITE !=null and SUP_WEBSITE !=''">,SUP_WEBSITE</if>
    <if test="SUP_MANAGER !=null and SUP_MANAGER !=''">,SUP_MANAGER</if>
    <if test="PRO_INDUSTRY !=null and PRO_INDUSTRY !=''">,PRO_INDUSTRY</if>
    <if test="IS_REPO !=null and IS_REPO !=''">,IS_REPO</if>
    <if test="AREA_ID !=null and AREA_ID !=''"> ,AREA_ID</if>
    <if test="PROV_ID !=null and PROV_ID !=''"> ,PROV_ID</if>
    <if test="CITY_ID !=null and CITY_ID !=''">,CITY_ID</if>
    <if test="SIGN_DATE !=null and SIGN_DATE !=''">,SIGN_DATE</if>
    <if test="OPEN_BANK !=null and OPEN_BANK !=''">,OPEN_BANK</if>
    <if test="OPEN_BANK_NUMBER !=null and OPEN_BANK_NUMBER !=''">,OPEN_BANK_NUMBER</if>
    <if test="SUP_LEGAL_NAME !=null and SUP_LEGAL_NAME !=''">,SUP_LEGAL_NAME</if>
    <if test="SUP_LEGAL_PHONE !=null and SUP_LEGAL_PHONE !=''"> ,SUP_LEGAL_PHONE</if>
    <if test="SUP_LEGAL_MOBIL !=null and SUP_LEGAL_MOBIL !=''">,SUP_LEGAL_MOBIL</if>
    <if test="SUB_LEGAL_ADDRESS !=null and SUB_LEGAL_ADDRESS !=''">,SUB_LEGAL_ADDRESS</if>
    <if test="SUB_LEGAL_EMAIL !=null and SUB_LEGAL_EMAIL !=''">,SUB_LEGAL_EMAIL</if>
    <if test="BILL_ADDRESS !=null and BILL_ADDRESS !=''">,BILL_ADDRESS</if>
    <if test="BILL_PHONE !=null and BILL_PHONE !=''">,BILL_PHONE</if>
    <if test="TAX_QUAL !=null and TAX_QUAL !=''">,TAX_QUAL</if>
    <if test="TAX_IDEN_NUM !=null and TAX_IDEN_NUM !=''">,TAX_IDEN_NUM</if>
    <if test="EMS_TO_NAME !=null and EMS_TO_NAME !=''">,EMS_TO_NAME</if>
    <if test="EMS_TO_ADDRESS !=null and EMS_TO_ADDRESS !=''">,EMS_TO_ADDRESS</if>
    <if test="EMS_TO_PHONE !=null and EMS_TO_PHONE !=''">,EMS_TO_PHONE</if>
    <if test="EMS_TO_ZIP !=null and EMS_TO_ZIP !=''">,EMS_TO_ZIP</if>
    <if test="LOANS_OWN_UNIT !=null and LOANS_OWN_UNIT !=''">,LOANS_OWN_UNIT</if>
    <if test="LOANS_OWN_ADDR !=null and LOANS_OWN_ADDR !=''">,LOANS_OWN_ADDR</if>
    <if test="LOANS_OWN_BANK !=null and LOANS_OWN_BANK !=''">,LOANS_OWN_BANK</if>
    <if test="LOANS_OWN_ACCOUNT !=null and LOANS_OWN_ACCOUNT !=''">,LOANS_OWN_ACCOUNT</if>
    <if test="LOANS_TOTAL_UNIT !=null and LOANS_TOTAL_UNIT != ''">,LOANS_TOTAL_UNIT</if>
    <if test="LOANS_TOTAL_ADDDR !=null and LOANS_TOTAL_ADDDR !=''">,LOANS_TOTAL_ADDDR</if>
    <if test="LOANS_TOTAL_BANK !=null and LOANS_TOTAL_BANK !=''">,LOANS_TOTAL_BANK</if>
    <if test="LOANS_TOTAL_ACCOUNT !=null and LOANS_TOTAL_ACCOUNT !=''">,LOANS_TOTAL_ACCOUNT</if>
    <if test="LOANS_COMPANY_UNIT !=null and LOANS_COMPANY_UNIT !=''">,LOANS_COMPANY_UNIT</if>
    <if test="LOANS_COMPANY_ADDR !=null and LOANS_COMPANY_ADDR !=''">,LOANS_COMPANY_ADDR</if>
    <if test="LOANS_COMPANY_BANK !=null and LOANS_COMPANY_BANK !=''">,LOANS_COMPANY_BANK</if>
    <if test="LOANS_COMPANY_ACCOUNT !=null and LOANS_COMPANY_ACCOUNT !=''">,LOANS_COMPANY_ACCOUNT</if>
    <if test="SUB_SCORE !=null and SUB_SCORE !=''">,SUB_SCORE</if>
    <if test="FILE_NUMBER !=null and FILE_NUMBER !=''">,FILE_NUMBER</if>
    <if test="USER_ID !=null and USER_ID !=''">,USER_ID</if>
    ,CREATE_DATE
    <if test="SUP_LEVEL !=null and SUP_LEVEL !=''">,SUP_LEVEL</if>
    <if test="SUP_SWITCH !=null and SUP_SWITCH !=''">,SUP_SWITCH</if>
    <if test="CREDIT_SWITCH !=null and CREDIT_SWITCH !=''">,CREDIT_SWITCH</if>
    <if test="PAYMENT_SWITCH !=null and PAYMENT_SWITCH !=''">,PAYMENT_SWITCH</if>
    <if test="BALANCE_LOAN_SWITCH !=null and BALANCE_LOAN_SWITCH !=''">,BALANCE_LOAN_SWITCH</if>
    <if test="IRREGULAR_REPAYMENT_SWITCH !=null and IRREGULAR_REPAYMENT_SWITCH !=''">,IRREGULAR_REPAYMENT_SWITCH</if>
    <if test="B_MODEL_SWITCH !=null and B_MODEL_SWITCH !=''">,B_MODEL_SWITCH</if>
    <if test="SUP_LEGAL_IDCARD !=null and SUP_LEGAL_IDCARD !=''">,SUP_LEGAL_IDCARD</if>
    <if test="SUP_TYPE != null and SUP_TYPE != ''">,SUP_TYPE</if>
    <if test="LENDING_TYPE != null and LENDING_TYPE != ''">,LENDING_TYPE</if>
    <if test="PARENT_ID != null and PARENT_ID != ''">,PARENT_ID</if>
    <if test="COMMISSION_RATIO != null and COMMISSION_RATIO != ''">,COMMISSION_RATIO</if>
    <if test="COMMISSION_AMOUNT != null and COMMISSION_AMOUNT != ''">,COMMISSION_AMOUNT</if>
    <if test="SUB_LEGAL_PROV != null and SUB_LEGAL_PROV != ''">,SUB_LEGAL_PROV</if>
    <if test="SUB_LEGAL_CITY != null and SUB_LEGAL_CITY != ''">,SUB_LEGAL_CITY</if>
    <if test="SUB_LEGAL_AREA != null and SUB_LEGAL_AREA != ''">,SUB_LEGAL_AREA</if>
    <if test="LOANS_OWN_PAY != null and LOANS_OWN_PAY != ''">,LOANS_OWN_PAY</if>
    <if test="LOANS_TOTAL_PAY != null and LOANS_TOTAL_PAY != ''">,LOANS_TOTAL_PAY</if>
    <if test="LOANS_COMPANY_PAY != null and LOANS_COMPANY_PAY != ''">,LOANS_COMPANY_PAY</if>
    ,STATUS 
  )
  VALUES
  (
     #{SUP_ID}
    ,#{SCODE}
    <if test="SUP_FLAG !=null and SUP_FLAG !=''">,#{SUP_FLAG}</if>
    <if test="SUP_CODE !=null and SUP_CODE !=''">,#{SUP_CODE}</if>
    <if test="SUP_NAME !=null and SUP_NAME !=''">,#{SUP_NAME}</if>
    <if test="SUP_SHORTNAME !=null and SUP_SHORTNAME !=''">,#{SUP_SHORTNAME}</if>
    <!-- <if test="COMPANY_ID !=null and COMPANY_ID !=''">,#{COMPANY_ID}</if> -->
    <if test="CORP_BUSINESS_LICENSE !=null and CORP_BUSINESS_LICENSE !=''">,#{CORP_BUSINESS_LICENSE}</if>
    <if test="SUP_ADDRESS !=null and SUP_ADDRESS !=''">,#{SUP_ADDRESS}</if>
    <if test="SUP_FAX !=null and SUP_FAX !=''">,#{SUP_FAX}</if>
    <if test="SUP_ZIP !=null and SUP_ZIP !=''">,#{SUP_ZIP}</if>
    <if test="ORAGNIZATION_CODE !=null and ORAGNIZATION_CODE !=''">,#{ORAGNIZATION_CODE}</if>
    <if test="TAX_CODE !=null and TAX_CODE !=''">,#{TAX_CODE}</if>
    <if test="CREDIT_GRADE !=null and CREDIT_GRADE !=''">,#{CREDIT_GRADE}</if>
    <if test="SETUP_DATE !=null and SETUP_DATE !=''">,TO_DATE(#{SETUP_DATE},'YYYY-MM-DD')</if>
    <if test="PERIOD_VALIDITY !=null and PERIOD_VALIDITY !=''">,TO_DATE(#{PERIOD_VALIDITY},'YYYY-MM-DD')</if>
    <if test="REGISTE_CAPITAL !=null and REGISTE_CAPITAL !=''">,#{REGISTE_CAPITAL}</if>
    <if test="PAICLUP_CAPITAL !=null and PAICLUP_CAPITAL !=''">,#{PAICLUP_CAPITAL}</if>
    <if test="BUSINESS_RANGE !=null and BUSINESS_RANGE !=''">,#{BUSINESS_RANGE}</if>
    <if test="SUP_WEBSITE !=null and SUP_WEBSITE !=''">,#{SUP_WEBSITE}</if>
    <if test="SUP_MANAGER !=null and SUP_MANAGER !=''">,#{SUP_MANAGER}</if>
    <if test="PRO_INDUSTRY !=null and PRO_INDUSTRY !=''">,#{PRO_INDUSTRY}</if>
    <if test="IS_REPO !=null and IS_REPO !=''">,#{IS_REPO}</if>
    <if test="AREA_ID !=null and AREA_ID !=''">,#{AREA_ID}</if>
    <if test="PROV_ID !=null and PROV_ID !=''">,#{PROV_ID}</if>
    <if test="CITY_ID !=null and CITY_ID !=''">,#{CITY_ID}</if>
    <if test="SIGN_DATE !=null and SIGN_DATE !=''">,TO_DATE(#{SIGN_DATE},'YYYY-MM-DD')</if>
    <if test="OPEN_BANK !=null and OPEN_BANK !=''">,#{OPEN_BANK}</if>
    <if test="OPEN_BANK_NUMBER !=null and OPEN_BANK_NUMBER !=''">,#{OPEN_BANK_NUMBER}</if>
    <if test="SUP_LEGAL_NAME !=null and SUP_LEGAL_NAME !=''"> ,#{SUP_LEGAL_NAME}</if>
    <if test="SUP_LEGAL_PHONE !=null and SUP_LEGAL_PHONE !=''">,#{SUP_LEGAL_PHONE}</if>
    <if test="SUP_LEGAL_MOBIL !=null and SUP_LEGAL_MOBIL !=''">,#{SUP_LEGAL_MOBIL}</if>
    <if test="SUB_LEGAL_ADDRESS !=null and SUB_LEGAL_ADDRESS !=''">,#{SUB_LEGAL_ADDRESS}</if>
    <if test="SUB_LEGAL_EMAIL !=null and SUB_LEGAL_EMAIL !=''">,#{SUB_LEGAL_EMAIL}</if>
    <if test="BILL_ADDRESS !=null and BILL_ADDRESS !=''">,#{BILL_ADDRESS}</if>
    <if test="BILL_PHONE !=null and BILL_PHONE !=''">,#{BILL_PHONE}</if>
    <if test="TAX_QUAL !=null and TAX_QUAL !=''">,#{TAX_QUAL}</if>
    <if test="TAX_IDEN_NUM !=null and TAX_IDEN_NUM !=''">,#{TAX_IDEN_NUM}</if>
    <if test="EMS_TO_NAME !=null and EMS_TO_NAME !=''">,#{EMS_TO_NAME}</if>
    <if test="EMS_TO_ADDRESS !=null and EMS_TO_ADDRESS !=''">,#{EMS_TO_ADDRESS}</if>
    <if test="EMS_TO_PHONE !=null and EMS_TO_PHONE !=''">,#{EMS_TO_PHONE}</if>
    <if test="EMS_TO_ZIP !=null and EMS_TO_ZIP !=''">,#{EMS_TO_ZIP}</if>
    <if test="LOANS_OWN_UNIT !=null and LOANS_OWN_UNIT !=''">,#{LOANS_OWN_UNIT}</if>
    <if test="LOANS_OWN_ADDR !=null and LOANS_OWN_ADDR !=''">,#{LOANS_OWN_ADDR}</if>
    <if test="LOANS_OWN_BANK !=null and LOANS_OWN_BANK !=''">,#{LOANS_OWN_BANK}</if>
    <if test="LOANS_OWN_ACCOUNT !=null and LOANS_OWN_ACCOUNT !=''">,#{LOANS_OWN_ACCOUNT}</if>
    <if test="LOANS_TOTAL_UNIT !=null and LOANS_TOTAL_UNIT != ''">,#{LOANS_TOTAL_UNIT}</if>
    <if test="LOANS_TOTAL_ADDDR !=null and LOANS_TOTAL_ADDDR !=''">,#{LOANS_TOTAL_ADDDR}</if>
    <if test="LOANS_TOTAL_BANK !=null and LOANS_TOTAL_BANK !=''">,#{LOANS_TOTAL_BANK}</if>
    <if test="LOANS_TOTAL_ACCOUNT !=null and LOANS_TOTAL_ACCOUNT !=''">,#{LOANS_TOTAL_ACCOUNT}</if>
    <if test="LOANS_COMPANY_UNIT !=null and LOANS_COMPANY_UNIT !=''">,#{LOANS_COMPANY_UNIT}</if>
    <if test="LOANS_COMPANY_ADDR !=null and LOANS_COMPANY_ADDR !=''">,#{LOANS_COMPANY_ADDR}</if>
    <if test="LOANS_COMPANY_BANK !=null and LOANS_COMPANY_BANK !=''">,#{LOANS_COMPANY_BANK}</if>
    <if test="LOANS_COMPANY_ACCOUNT !=null and LOANS_COMPANY_ACCOUNT !=''">,#{LOANS_COMPANY_ACCOUNT}</if>
    <if test="SUB_SCORE !=null and SUB_SCORE !=''">,#{SUB_SCORE}</if>
    <if test="FILE_NUMBER !=null and FILE_NUMBER !=''">,#{FILE_NUMBER}</if>
    <if test="USER_ID !=null and USER_ID !=''">,#{USER_ID}</if>
     ,SYSDATE
    <if test="SUP_LEVEL !=null and SUP_LEVEL !=''">,#{SUP_LEVEL}</if>
    <if test="SUP_SWITCH !=null and SUP_SWITCH !=''">,#{SUP_SWITCH}</if>
    <if test="CREDIT_SWITCH !=null and CREDIT_SWITCH !=''">,#{CREDIT_SWITCH}</if>
    <if test="PAYMENT_SWITCH !=null and PAYMENT_SWITCH !=''">,#{PAYMENT_SWITCH}</if>
    <if test="BALANCE_LOAN_SWITCH !=null and BALANCE_LOAN_SWITCH !=''">,#{BALANCE_LOAN_SWITCH}</if>
    <if test="IRREGULAR_REPAYMENT_SWITCH !=null and IRREGULAR_REPAYMENT_SWITCH !=''">,#{IRREGULAR_REPAYMENT_SWITCH}</if>
    <if test="B_MODEL_SWITCH !=null and B_MODEL_SWITCH !=''">,#{B_MODEL_SWITCH}</if>
    <if test="SUP_LEGAL_IDCARD !=null and SUP_LEGAL_IDCARD !=''">,#{SUP_LEGAL_IDCARD}</if>
    <if test="SUP_TYPE != null and SUP_TYPE != ''">,#{SUP_TYPE}</if>
    <if test="LENDING_TYPE != null and LENDING_TYPE != ''">,#{LENDING_TYPE}</if>
    <if test="PARENT_ID != null and PARENT_ID != ''">,#{PARENT_ID}</if>
    <if test="COMMISSION_RATIO != null and COMMISSION_RATIO != ''">,#{COMMISSION_RATIO}</if>
    <if test="COMMISSION_AMOUNT != null and COMMISSION_AMOUNT != ''">,#{COMMISSION_AMOUNT}</if>
    <if test="SUB_LEGAL_PROV != null and SUB_LEGAL_PROV != ''">,#{SUB_LEGAL_PROV}</if>
    <if test="SUB_LEGAL_CITY != null and SUB_LEGAL_CITY != ''">,#{SUB_LEGAL_CITY}</if>
    <if test="SUB_LEGAL_AREA != null and SUB_LEGAL_AREA != ''">,#{SUB_LEGAL_AREA}</if>
    <if test="LOANS_OWN_PAY != null and LOANS_OWN_PAY != ''">,#{LOANS_OWN_PAY}</if>
    <if test="LOANS_TOTAL_PAY != null and LOANS_TOTAL_PAY != ''">,#{LOANS_TOTAL_PAY}</if>
    <if test="LOANS_COMPANY_PAY != null and LOANS_COMPANY_PAY != ''">,#{LOANS_COMPANY_PAY}</if>
    ,0 
  )
</insert>

<update id="updateSupplier" parameterType="Map">
 UPDATE T_SYS_SUPPLIERS
    SET SUP_ID = #{SUP_ID}
        ,SCODE = #{SCODE}
		<if test="SUP_FLAG !=null ">,SUP_FLAG = #{SUP_FLAG}</if>
		<if test="SUP_CODE !=null ">,SUP_CODE = #{SUP_CODE}</if>
		<if test="SUP_NAME !=null ">,SUP_NAME = #{SUP_NAME}</if>
		<if test="SUP_SHORTNAME !=null ">,SUP_SHORTNAME = #{SUP_SHORTNAME}</if>
		<!-- <if test="COMPANY_ID !=null ">,COMPANY_ID = #{COMPANY_ID}</if> -->
		<if test="CORP_BUSINESS_LICENSE !=null ">,CORP_BUSINESS_LICENSE = #{CORP_BUSINESS_LICENSE}</if>
		<if test="SUP_ADDRESS !=null ">,SUP_ADDRESS = #{SUP_ADDRESS}</if>
		<if test="SUP_FAX !=null ">,SUP_FAX = #{SUP_FAX}</if>
		<if test="SUP_ZIP !=null ">,SUP_ZIP = #{SUP_ZIP}</if>
		<if test="ORAGNIZATION_CODE !=null ">,ORAGNIZATION_CODE = #{ORAGNIZATION_CODE}</if>
		<if test="TAX_CODE !=null ">,TAX_CODE = #{TAX_CODE}</if>
		<if test="CREDIT_GRADE !=null ">,CREDIT_GRADE = #{CREDIT_GRADE}</if>
		<if test="SETUP_DATE !=null ">,SETUP_DATE = TO_DATE(#{SETUP_DATE},'YYYY-MM-DD')</if>
		<if test="PERIOD_VALIDITY !=null ">,PERIOD_VALIDITY = TO_DATE(#{PERIOD_VALIDITY},'YYYY-MM-DD')</if>
		<if test="REGISTE_CAPITAL !=null ">,REGISTE_CAPITAL = #{REGISTE_CAPITAL}</if>
		<if test="PAICLUP_CAPITAL !=null ">,PAICLUP_CAPITAL = #{PAICLUP_CAPITAL}</if>
		<if test="BUSINESS_RANGE !=null ">,BUSINESS_RANGE = #{BUSINESS_RANGE}</if>
		<if test="SUP_WEBSITE !=null ">,SUP_WEBSITE = #{SUP_WEBSITE}</if>
		<if test="SUP_MANAGER !=null ">,SUP_MANAGER = #{SUP_MANAGER}</if>
		<if test="PRO_INDUSTRY !=null ">,PRO_INDUSTRY = #{PRO_INDUSTRY}</if>
		<if test="IS_REPO !=null ">,IS_REPO = #{IS_REPO}</if>
		<if test="AREA_ID !=null ">,AREA_ID = #{AREA_ID}</if>
		<if test="PROV_ID !=null ">,PROV_ID = #{PROV_ID}</if>
		<if test="CITY_ID !=null ">,CITY_ID = #{CITY_ID}</if>
		<if test="SIGN_DATE !=null ">,SIGN_DATE = TO_DATE(#{SIGN_DATE},'YYYY-MM-DD')</if>
		<if test="OPEN_BANK !=null ">,OPEN_BANK = #{OPEN_BANK}</if>
		<if test="OPEN_BANK_NUMBER !=null ">,OPEN_BANK_NUMBER = #{OPEN_BANK_NUMBER}</if>
		<if test="SUP_LEGAL_NAME !=null ">,SUP_LEGAL_NAME = #{SUP_LEGAL_NAME}</if>
		<if test="SUP_LEGAL_PHONE !=null ">,SUP_LEGAL_PHONE = #{SUP_LEGAL_PHONE}</if>
		<if test="SUP_LEGAL_MOBIL !=null ">,SUP_LEGAL_MOBIL = #{SUP_LEGAL_MOBIL}</if>
		<if test="SUB_LEGAL_ADDRESS !=null ">,SUB_LEGAL_ADDRESS = #{SUB_LEGAL_ADDRESS}</if>
		<if test="SUB_LEGAL_EMAIL !=null ">,SUB_LEGAL_EMAIL = #{SUB_LEGAL_EMAIL}</if>
		<if test="SUP_LEGAL_IDCARD !=null ">,SUP_LEGAL_IDCARD = #{SUP_LEGAL_IDCARD}</if>
		<if test="BILL_ADDRESS !=null ">,BILL_ADDRESS = #{BILL_ADDRESS}</if>
		<if test="BILL_PHONE !=null ">,BILL_PHONE = #{BILL_PHONE}</if>
		<if test="TAX_QUAL !=null ">,TAX_QUAL = #{TAX_QUAL}</if>
		<if test="TAX_IDEN_NUM !=null ">,TAX_IDEN_NUM = #{TAX_IDEN_NUM}</if>
		<if test="EMS_TO_NAME !=null ">,EMS_TO_NAME = #{EMS_TO_NAME}</if>
		<if test="EMS_TO_ADDRESS !=null ">,EMS_TO_ADDRESS = #{EMS_TO_ADDRESS}</if>
		<if test="EMS_TO_PHONE !=null ">,EMS_TO_PHONE = #{EMS_TO_PHONE}</if>
		<if test="EMS_TO_ZIP !=null ">,EMS_TO_ZIP = #{EMS_TO_ZIP}</if>
		<if test="LOANS_OWN_UNIT !=null ">,LOANS_OWN_UNIT = #{LOANS_OWN_UNIT}</if>
		<if test="LOANS_OWN_ADDR !=null ">,LOANS_OWN_ADDR = #{LOANS_OWN_ADDR}</if>
		<if test="LOANS_OWN_BANK !=null ">,LOANS_OWN_BANK = #{LOANS_OWN_BANK}</if>
		<if test="LOANS_OWN_ACCOUNT !=null ">,LOANS_OWN_ACCOUNT= #{LOANS_OWN_ACCOUNT}</if>
		<if test="LOANS_TOTAL_UNIT !=null ">,LOANS_TOTAL_UNIT = #{LOANS_TOTAL_UNIT}</if>
		<if test="LOANS_TOTAL_ADDDR !=null ">,LOANS_TOTAL_ADDDR = #{LOANS_TOTAL_ADDDR}</if>
		<if test="LOANS_TOTAL_BANK !=null ">,LOANS_TOTAL_BANK = #{LOANS_TOTAL_BANK}</if>
		<if test="LOANS_TOTAL_ACCOUNT !=null ">,LOANS_TOTAL_ACCOUNT = #{LOANS_TOTAL_ACCOUNT}</if>
		<if test="LOANS_COMPANY_UNIT !=null ">,LOANS_COMPANY_UNIT = #{LOANS_COMPANY_UNIT}</if>
	    <if test="LOANS_COMPANY_ADDR !=null ">,LOANS_COMPANY_ADDR = #{LOANS_COMPANY_ADDR}</if>
	    <if test="LOANS_COMPANY_BANK !=null ">,LOANS_COMPANY_BANK = #{LOANS_COMPANY_BANK}</if>
	    <if test="LOANS_COMPANY_ACCOUNT !=null ">,LOANS_COMPANY_ACCOUNT = #{LOANS_COMPANY_ACCOUNT}</if>
		<if test="SUB_SCORE !=null ">,SUB_SCORE = #{SUB_SCORE}</if>
		<if test="FILE_NUMBER !=null ">,FILE_NUMBER = #{FILE_NUMBER}</if>
		<if test="USER_ID !=null ">,USER_ID = #{USER_ID}</if>
		<if test="CREATE_DATE !=null ">,CREATE_DATE = #{CREATE_DATE}</if>
		<if test="SUP_LEVEL !=null ">,SUP_LEVEL = #{SUP_LEVEL}</if>
		<if test="SUP_SWITCH !=null ">,SUP_SWITCH = #{SUP_SWITCH}</if>
		<if test="CREDIT_SWITCH !=null ">,CREDIT_SWITCH = #{CREDIT_SWITCH}</if>
		<if test="PAYMENT_SWITCH !=null ">,PAYMENT_SWITCH = #{PAYMENT_SWITCH}</if>
		<if test="BALANCE_LOAN_SWITCH !=null ">,BALANCE_LOAN_SWITCH = #{BALANCE_LOAN_SWITCH}</if>
		<if test="IRREGULAR_REPAYMENT_SWITCH !=null ">,IRREGULAR_REPAYMENT_SWITCH = #{IRREGULAR_REPAYMENT_SWITCH}</if>
		<if test="B_MODEL_SWITCH !=null ">,B_MODEL_SWITCH = #{B_MODEL_SWITCH}</if>
		<if test="STATUS !=null ">,STATUS = #{STATUS}</if>
		<if test="SCAN_SWITCH !=null ">,SCAN_SWITCH = #{SCAN_SWITCH}</if>
		<if test="LENDING_TYPE != null ">,LENDING_TYPE = #{LENDING_TYPE} </if>
		<if test="SUP_TYPE != null ">,SUP_TYPE = #{SUP_TYPE} </if>
		<if test="PARENT_ID != null ">,PARENT_ID = #{PARENT_ID}</if>
		<if test="COMMISSION_RATIO != null "> ,COMMISSION_RATIO = #{COMMISSION_RATIO}</if>
		<if test="COMMISSION_AMOUNT != null "> ,COMMISSION_AMOUNT = #{COMMISSION_AMOUNT}</if>
		<if test="SUB_LEGAL_PROV != null ">,SUB_LEGAL_PROV = #{SUB_LEGAL_PROV}</if>
	    <if test="SUB_LEGAL_CITY != null ">,SUB_LEGAL_CITY = #{SUB_LEGAL_CITY}</if>
	    <if test="SUB_LEGAL_AREA != null ">,SUB_LEGAL_AREA = #{SUB_LEGAL_AREA}</if>
	    <if test="LOANS_OWN_PAY != null ">,LOANS_OWN_PAY = #{LOANS_OWN_PAY}</if>
	    <if test="LOANS_TOTAL_PAY != null ">,LOANS_TOTAL_PAY = #{LOANS_TOTAL_PAY}</if>
	    <if test="LOANS_COMPANY_PAY != null ">,LOANS_COMPANY_PAY = #{LOANS_COMPANY_PAY}</if>
   WHERE SUP_ID = #{SUP_ID}

</update>

<delete id="delSupplier" parameterType="Map">
	DELETE FROM T_SYS_SUPPLIERS SUP WHERE SUP.SUP_ID =#{SUP_ID}
</delete>

<delete id="delSupplierInfo" parameterType="Map">
	DELETE FROM T_SYS_SUPPLIERS_INFO SUP WHERE SUP.SUP_ID =#{SUP_ID}
</delete>

<select id="getLinkManList" parameterType="Map" resultType="Map">
   SELECT SL.LINK_ID,
		  SL.LINK_NAME,
		  SL.LINK_IDCARD,
		  SL.LINK_PHONE,
		  SL.LINK_MOBILE,
		  SL.LINK_EMAIL,
		  SL.LINK_ADDR,
		  SL.CREATE_TIME,
		  SL.SALE_ID,
		  SL.SUP_ID 
     FROM T_SUPPLIER_LINKMAN SL 
    WHERE SL.SUP_ID = #{SUP_ID}
</select>

<insert id="addLinkMan" parameterType="Map">
INSERT INTO T_SUPPLIER_LINKMAN
  (
    LINK_ID
    <if test="LINK_NAME !=null and LINK_NAME !=''">,LINK_NAME</if>
    <if test="LINK_IDCARD !=null and LINK_IDCARD !=''">,LINK_IDCARD</if>
    <if test="LINK_PHONE !=null and LINK_PHONE !=''">,LINK_PHONE</if>
    <if test="LINK_MOBILE !=null and LINK_MOBILE !=''">,LINK_MOBILE</if>
    <if test="LINK_EMAIL !=null and LINK_EMAIL !=''">,LINK_EMAIL</if>
    <if test="LINK_ADDR !=null and LINK_ADDR !=''">,LINK_ADDR</if>
    ,CREATE_TIME
    <if test="SALE_ID !=null and SALE_ID !=''">,SALE_ID</if>
    <if test="SUP_ID !=null and SUP_ID !=''">,SUP_ID</if> 
  )
  VALUES
  (
    SEQ_T_SUPPLIER_LINKMAN.NEXTVAL
    <if test="LINK_NAME !=null and LINK_NAME !=''">,#{LINK_NAME}</if>
    <if test="LINK_IDCARD !=null and LINK_IDCARD !=''">,#{LINK_IDCARD}</if>
    <if test="LINK_PHONE !=null and LINK_PHONE !=''">,#{LINK_PHONE}</if>
    <if test="LINK_MOBILE !=null and LINK_MOBILE !=''">,#{LINK_MOBILE}</if>
    <if test="LINK_EMAIL !=null and LINK_EMAIL !=''">,#{LINK_EMAIL}</if>
    <if test="LINK_ADDR !=null and LINK_ADDR !=''">,#{LINK_ADDR}</if>
    ,SYSDATE
    <if test="SALE_ID !=null and SALE_ID !=''">,#{SALE_ID}</if>
    <if test="SUP_ID !=null and SUP_ID !=''">,#{SUP_ID}</if>
  )
</insert>

<update id="updateLinkMan" parameterType="Map">
 UPDATE T_SUPPLIER_LINKMAN
	SET LINK_ID = #{LINK_ID}
		<if test="LINK_NAME !=null and LINK_NAME !=''">,LINK_NAME = #{LINK_NAME}</if>
		<if test="LINK_IDCARD !=null and LINK_IDCARD !=''">,LINK_IDCARD = #{LINK_IDCARD}</if>
		<if test="LINK_PHONE !=null and LINK_PHONE !=''">,LINK_PHONE  = #{LINK_PHONE}</if>
		<if test="LINK_MOBILE !=null and LINK_MOBILE !=''">,LINK_MOBILE = #{LINK_MOBILE}</if>
		<if test="LINK_EMAIL !=null and LINK_EMAIL !=''">,LINK_EMAIL  = #{LINK_EMAIL}</if>
		<if test="LINK_ADDR !=null and LINK_ADDR !=''">,LINK_ADDR  = #{LINK_ADDR}</if>
   WHERE LINK_ID   = #{LINK_ID}
</update>

<delete id="delLinkMan" parameterType="Map">
DELETE FROM T_SUPPLIER_LINKMAN SL WHERE SL.LINK_ID = #{LINK_ID}
</delete>

<select id="getInvestsByType" parameterType="Map" resultType="Map">
   SELECT SUPIV.ID,
		  SUPIV.INVEST_NAME,
		  SUPIV.INVEST_LEGAL_NAME,
		  SUPIV.INVEST_TYPE,
		  SUPIV.INVEST_SEX,
		  SUPIV.INVEST_ID_CARD,
		  SUPIV.INVEST_MONEY,
		  SUPIV.INVEST_STOCK,
		  SUPIV.INVEST_ADDR,
		  SUPIV.INVEST_PHONE,
		  SUPIV.INVEST_ORG_CODE,
		  SUPIV.INVEST_DUTY,
		  SUPIV.CREATE_DATE,
		  SUPIV.SALE_ID,
		  SUPIV.SUP_ID
     FROM T_SUPPLIER_INVEST SUPIV
    WHERE 1=1
    <if test="ID !=null and ID !=''">AND SUPIV.ID = #{ID}</if>
    AND SUPIV.SUP_ID = #{SUP_ID}
    AND SUPIV.INVEST_TYPE = #{INVEST_TYPE} 
</select>

<insert id="addInvestor" parameterType="Map">
INSERT INTO T_SUPPLIER_INVEST
  (
    ID
    <if test="INVEST_NAME !=null and INVEST_NAME !=''">,INVEST_NAME</if>
    <if test="INVEST_LEGAL_NAME !=null and INVEST_LEGAL_NAME !=''">,INVEST_LEGAL_NAME</if>
    <if test="INVEST_TYPE !=null and INVEST_TYPE !=''">,INVEST_TYPE</if> 
    <if test="INVEST_SEX !=null and INVEST_SEX !=''">,INVEST_SEX</if>
    <if test="INVEST_ID_CARD !=null and INVEST_ID_CARD !=''">,INVEST_ID_CARD</if>
    <if test="INVEST_MONEY !=null and INVEST_MONEY !=''">,INVEST_MONEY</if>
    <if test="INVEST_STOCK !=null and INVEST_STOCK !=''">,INVEST_STOCK</if>
    <if test="INVEST_ADDR !=null and INVEST_ADDR !=''">,INVEST_ADDR</if>
    <if test="INVEST_PHONE !=null and INVEST_PHONE !=''">,INVEST_PHONE</if>
    <if test="INVEST_ORG_CODE !=null and INVEST_ORG_CODE !=''">,INVEST_ORG_CODE</if>
    <if test="INVEST_DUTY !=null and INVEST_DUTY !=''">,INVEST_DUTY</if>
    ,CREATE_DATE
    <if test="SALE_ID !=null and SALE_ID !=''">,SALE_ID</if>
    <if test="SUP_ID !=null and SUP_ID !=''">,SUP_ID</if>
  )
  VALUES
  (
    SEQ_T_SUPPLIER_INVEST.NEXTVAL
    <if test="INVEST_NAME !=null and INVEST_NAME !=''">,#{INVEST_NAME}</if>
    <if test="INVEST_LEGAL_NAME !=null and INVEST_LEGAL_NAME !=''">,#{INVEST_LEGAL_NAME}</if>
    <if test="INVEST_TYPE !=null and INVEST_TYPE !=''">,#{INVEST_TYPE}</if>
    <if test="INVEST_SEX !=null and INVEST_SEX !=''">,#{INVEST_SEX}</if>
    <if test="INVEST_ID_CARD !=null and INVEST_ID_CARD !=''">,#{INVEST_ID_CARD}</if>
    <if test="INVEST_MONEY !=null and INVEST_MONEY !=''">,#{INVEST_MONEY}</if>
    <if test="INVEST_STOCK !=null and INVEST_STOCK !=''">,#{INVEST_STOCK}</if>
    <if test="INVEST_ADDR !=null and INVEST_ADDR !=''">,#{INVEST_ADDR}</if>
    <if test="INVEST_PHONE !=null and INVEST_PHONE !=''">,#{INVEST_PHONE}</if>
    <if test="INVEST_ORG_CODE !=null and INVEST_ORG_CODE !=''">,#{INVEST_ORG_CODE}</if>
    <if test="INVEST_DUTY !=null and INVEST_DUTY !=''">,#{INVEST_DUTY}</if>
    ,SYSDATE
    <if test="SALE_ID !=null and SALE_ID !=''">,#{SALE_ID}</if>
    <if test="SUP_ID !=null and SUP_ID !=''">,#{SUP_ID}</if>
  )
</insert>

<update id="updateInvestor" parameterType="Map">
 UPDATE T_SUPPLIER_INVEST SUPIV
	SET SUPIV.ID = #{ID}
	<if test="INVEST_NAME !=null and INVEST_NAME !=''">,SUPIV.INVEST_NAME = #{INVEST_NAME}</if>
	<if test="INVEST_LEGAL_NAME !=null and INVEST_LEGAL_NAME !=''">,SUPIV.INVEST_LEGAL_NAME = #{INVEST_LEGAL_NAME}</if>
	<if test="INVEST_SEX !=null and INVEST_SEX !=''">,SUPIV.INVEST_SEX = #{INVEST_SEX}</if>
	<if test="INVEST_ID_CARD !=null and INVEST_ID_CARD !=''">,SUPIV.INVEST_ID_CARD = #{INVEST_ID_CARD}</if>
	<if test="INVEST_MONEY !=null and INVEST_MONEY !=''">,SUPIV.INVEST_MONEY = #{INVEST_MONEY}</if>
	<if test="INVEST_STOCK !=null and INVEST_STOCK !=''">,SUPIV.INVEST_STOCK = #{INVEST_STOCK}</if>
	<if test="INVEST_ADDR !=null and INVEST_ADDR !=''">,SUPIV.INVEST_ADDR = #{INVEST_ADDR}</if>
	<if test="INVEST_PHONE !=null and INVEST_PHONE !=''">,SUPIV.INVEST_PHONE = #{INVEST_PHONE}</if>
	<if test="INVEST_ORG_CODE !=null and INVEST_ORG_CODE !=''">,SUPIV.INVEST_ORG_CODE = #{INVEST_ORG_CODE}</if>
	<if test="INVEST_DUTY !=null and INVEST_DUTY !=''">,SUPIV.INVEST_DUTY = #{INVEST_DUTY}</if>
WHERE ID = #{ID}
</update>

<delete id="delInvest" parameterType="Map">
 DELETE FROM T_SUPPLIER_INVEST SUPIV WHERE SUPIV.ID = #{ID}
</delete>

<insert id="addSupFileUpload" parameterType="Map">
INSERT INTO T_SUPPLIER_FILE
  (
    FIL_ID
    <if test="FIL_NAME !=null and FIL_NAME !=''">,FIL_NAME</if>
    <if test="FIL_PATH !=null and FIL_PATH !=''">,FIL_PATH</if>
    ,CREATE_TIME
    <if test="SALE_ID !=null and SALE_ID !=''">,SALE_ID</if>
    <if test="SUP_ID !=null and SUP_ID !=''">,SUP_ID</if>
    <if test="FIL_MEMO !=null and FIL_MEMO !=''">,FIL_MEMO</if>
  )
  VALUES
  (
    SEQ_T_SUPPLIER_FILE.NEXTVAL
    <if test="FIL_NAME !=null and FIL_NAME !=''">,#{FIL_NAME}</if>
    <if test="FIL_PATH !=null and FIL_PATH !=''">,#{FIL_PATH}</if>
    ,SYSDATE
    <if test="SALE_ID !=null and SALE_ID !=''">,#{SALE_ID}</if>
    <if test="SUP_ID !=null and SUP_ID !=''">,#{SUP_ID}</if>
    <if test="FIL_MEMO !=null and FIL_MEMO !=''">,#{FIL_MEMO}</if>
    
  )

</insert>

<select id="findSupFileUploads" parameterType="Map" resultType="Map">
  SELECT F.FIL_ID,
         F.FIL_NAME,
         F.FIL_PATH,
         F.FIL_MEMO,
         F.SALE_ID,
         F.CREATE_TIME,
         F.SUP_ID
    FROM T_SUPPLIER_FILE F
   WHERE F.SUP_ID = #{SUP_ID}
</select>

<select id="findDupFileByID" parameterType="Map" resultType="Map">
 SELECT F.FIL_ID,
         F.FIL_NAME,
         F.FIL_PATH,
         F.FIL_MEMO,
         F.SALE_ID,
         F.CREATE_TIME,
         F.SUP_ID
    FROM T_SUPPLIER_FILE F
   WHERE F.FIL_ID = #{FIL_ID}
</select>

<delete id="deleteSupFile" parameterType="Map">
 DELETE FROM T_SUPPLIER_FILE F WHERE F.FIL_ID = #{FIL_ID}
</delete>

<select id="selectArea" parameterType="Map" resultType="Map">
  SELECT QU.ID,QU.NAME,QU.PARENT_ID,QU.LESSEE_AREA  
  FROM T_SYS_AREA QU WHERE QU.PARENT_ID IS NULL
  ORDER BY QU.AREA_LEVEL,nlssort(QU.NAME, 'NLS_SORT=SCHINESE_PINYIN_M')  
</select>

<select id="selectProvOrCity" parameterType="Map" resultType="Map">
  SELECT PROV.ID,PROV.NAME,PROV.PARENT_ID,PROV.LESSEE_AREA 
  FROM T_SYS_AREA PROV WHERE PROV.PARENT_ID= #{PARENT_ID} 
  ORDER BY PROV.AREA_LEVEL,nlssort(PROV.NAME, 'NLS_SORT=SCHINESE_PINYIN_M')
</select>

<select id="getQuYuSubset" parameterType="map" resultType="map">
		SELECT *
		  FROM T_SYS_AREA
		 WHERE PARENT_ID NOT IN (SELECT ID
		                           FROM T_SYS_AREA
		                          WHERE AREA_ID = #{PARENT_ID} 
		                            AND AREA_LEVEL = 2)
		   AND AREA_ID = #{PARENT_ID} 
		 ORDER BY AREA_LEVEL, nlssort(NAME, 'NLS_SORT=SCHINESE_PINYIN_M')
</select>

<select id="selectAllCompany" parameterType="Map" resultType="Map">
   SELECT distinct CO.COMPANY_ID,
          CO.COMPANY_NAME NAME,
--          TRIM(TO_CHAR(MAX(NVL(SUBSTR(NVL(SUP.SCODE,CO.FLAG),3),0)),'099')) MAXSCODE,
          CO.FLAG
--          CO.FLAG||TRIM(TO_CHAR(MAX(NVL(SUBSTR(NVL(SUP.SCODE,CO.FLAG),3),0))+1,'099')) NEWSCODE 
     FROM T_SYS_COMPANY CO,T_SYS_SUPPLIERS SUP 
    WHERE CO.COMPANY_ID=SUP.COMPANY_ID(+) 
      AND NVL(SUP.SUP_SHORTNAME,'NULL') NOT LIKE '%测试%'   
 --GROUP BY CO.COMPANY_ID, CO.COMPANY_NAME, CO.FLAG 
 ORDER BY CO.COMPANY_NAME
</select>

<select id="findGroup" parameterType="Map" resultType="Map">
	SELECT * FROM T_SYS_SUPPLIERS SUP
	WHERE SUP.SUP_TYPE = 4
	<if test="SUP_ID != null and SUP_ID != ''">AND SUP.SUP_ID != #{SUP_ID}</if>
	
</select>

<update id="updateSuppStatus" parameterType="Map">
UPDATE T_SYS_SUPPLIERS SUP SET SUP.STATUS = #{STATUS} WHERE SUP.SUP_ID = #{SUP_ID}
</update>

<update id="updateSupOrgIdBySupId" parameterType="Map">
UPDATE T_SYS_SUPPLIERS SUP SET SUP.ORG_BMID = #{ORG_ID} WHERE SUP.SUP_ID = #{SUP_ID}
</update>


<update id="updateSupOrgIdForBlankBySupId" parameterType="Map">
UPDATE T_SYS_SUPPLIERS SUP SET SUP.ORG_BMID = '' WHERE SUP.SUP_ID = #{SUP_ID}
</update>


<select id="doShowSwitch" parameterType="string" resultType="map">
SELECT * FROM(SELECT nvl(T.SUP_SWITCH,0) SUP_SWITCH,nvl(T.BALANCE_LOAN_SWITCH,0) BALANCE_LOAN_SWITCH,nvl(T.B_MODEL_SWITCH,0) B_MODEL_SWITCH,nvl(T.IRREGULAR_REPAYMENT_SWITCH,0) IRREGULAR_REPAYMENT_SWITCH,nvl(t.SCAN_SWITCH,1)SCAN_SWITCH,nvl(t.DATAFILL_SWITCH,0)DATAFILL_SWITCH FROM T_SYS_SUPPLIERS T WHERE T.SUP_ID=#{SUP_ID})WHERE ROWNUM=1
</select>
<update id="updateSwitchStatus" parameterType="Map">
UPDATE T_SYS_SUPPLIERS SUP SET SUP_ID = #{SUP_ID}
   <if test="SUP_SWITCH !=null and SUP_SWITCH !=''">,SUP.SUP_SWITCH = #{SUP_SWITCH}</if>
   <if test="BALANCE_LOAN_SWITCH !=null and BALANCE_LOAN_SWITCH !=''">,SUP.BALANCE_LOAN_SWITCH = #{BALANCE_LOAN_SWITCH}</if>
   <if test="IRREGULAR_REPAYMENT_SWITCH !=null and IRREGULAR_REPAYMENT_SWITCH !=''">,SUP.IRREGULAR_REPAYMENT_SWITCH = #{IRREGULAR_REPAYMENT_SWITCH}</if>
   <if test="B_MODEL_SWITCH !=null and B_MODEL_SWITCH !=''">,SUP.B_MODEL_SWITCH = #{B_MODEL_SWITCH}</if>
   <if test="SMS_SWITCH !=null and SMS_SWITCH !=''">,SUP.SMS_SWITCH = #{SMS_SWITCH}</if>
   <if test="CREDIT_SWITCH !=null and CREDIT_SWITCH !=''">,SUP.CREDIT_SWITCH = #{CREDIT_SWITCH}</if>
   <if test="SCAN_SWITCH !=null and SCAN_SWITCH !=''">,SUP.SCAN_SWITCH = #{SCAN_SWITCH}</if>
   <if test="DATAFILL_SWITCH !=null and DATAFILL_SWITCH !=''">,SUP.DATAFILL_SWITCH = #{DATAFILL_SWITCH}</if>
   <if test="YINGYE_STATUS !=null and YINGYE_STATUS !=''">,SUP.YINGYE_STATUS = #{YINGYE_STATUS}</if>
  WHERE SUP.SUP_ID = #{SUP_ID}
</update>

<select id="querySuppByCom" parameterType="map" resultType="map">
	select SUP_NAME,SCORE,SUP_ID from T_SYS_SUPPLIERS TSS where (TSS.SUP_SWITCH!=1 OR TSS.SUP_SWITCH IS NULL) 
	<if test="COMPANY_ID!=null and COMPANY_ID!=''">and TSS.COMPANY_ID=#{COMPANY_ID}</if> 
	<if test="SPID !=null and SPID!=''">AND TSS.SUP_ID IN (SELECT TT.SUP_ID FROM T_SYS_SUPP_DEALER TT WHERE TT.SP_ID=#{SPID})</if>
	and TSS.SUP_ID in (select TYPE_ID from FHFA_MANAGER_AFFILIATED FMA where FMA.MANAGER_ID=#{MANAGER_ID} and FMA.TYPE='供应商')
</select>

<select id="getUnderSuppliersList" parameterType="Map" resultType="Map">
	SELECT TT.* FROM (
	   SELECT T.*,ROWNUM ROWNO FROM (
	   	SELECT 
			SUP.SUP_ID,
		          SUP.SCODE,
				  SUP.SUP_FLAG,
				  SUP.SUP_CODE,
				  SUP.SUP_NAME,
				  SUP.SUP_SHORTNAME,
				  SUP.COMPANY_ID,
				  SUP.CORP_BUSINESS_LICENSE,
				  SUP.SUP_ADDRESS,
				  SUP.SUP_FAX,
				  SUP.SUP_ZIP,
				  SUP.ORAGNIZATION_CODE,
				  SUP.TAX_CODE,
				  SUP.CREDIT_GRADE,
				  TO_CHAR(SUP.SETUP_DATE,'YYYY-MM-DD') SETUP_DATE,
				  TO_CHAR(SUP.PERIOD_VALIDITY,'YYYY-MM-DD') PERIOD_VALIDITY,
				  SUP.REGISTE_CAPITAL,
				  SUP.PAICLUP_CAPITAL,
				  SUP.BUSINESS_RANGE,
				  SUP.SUP_WEBSITE,
				  SUP.SUP_MANAGER,
				  SUP.PRO_INDUSTRY,
				  SUP.IS_REPO,
				  SUP.AREA_ID,
				  (SELECT AR.NAME FROM T_SYS_AREA AR WHERE AR.ID=SUP.AREA_ID) AREA_NAME,
				  SUP.PROV_ID,
				  (SELECT AR.NAME FROM T_SYS_AREA AR WHERE AR.ID=SUP.PROV_ID) PROV_NAME,
				  SUP.CITY_ID,
				  (SELECT AR.NAME FROM T_SYS_AREA AR WHERE AR.ID=SUP.CITY_ID) CITY_NAME,
				  TO_CHAR(SUP.SIGN_DATE,'YYYY-MM-DD') SIGN_DATE,
				  SUP.OPEN_BANK,
				  SUP.OPEN_BANK_NUMBER,
				  SUP.SUP_LEGAL_NAME,
				  SUP.SUP_LEGAL_PHONE,
				  SUP.SUP_LEGAL_MOBIL,
				  SUP.SUB_LEGAL_ADDRESS,
				  SUP.SUB_LEGAL_EMAIL,
				  SUP.BILL_ADDRESS,
				  SUP.BILL_PHONE,
				  SUP.TAX_QUAL,
				  SUP.TAX_IDEN_NUM,
				  SUP.EMS_TO_NAME,
				  SUP.EMS_TO_ADDRESS,
				  SUP.EMS_TO_PHONE,
				  SUP.EMS_TO_ZIP,
				  SUP.LOANS_OWN_UNIT,
				  SUP.LOANS_OWN_ADDR,
				  SUP.LOANS_OWN_BANK,
				  SUP.LOANS_OWN_ACCOUNT,
				  SUP.LOANS_TOTAL_UNIT,
				  SUP.LOANS_TOTAL_ADDDR,
				  SUP.LOANS_TOTAL_BANK,
				  SUP.LOANS_TOTAL_ACCOUNT,
				  SUP.SUB_SCORE,
				  SUP.FILE_NUMBER,
				  SUP.USER_ID,
				  SUP.CREATE_DATE,
				  SUP.SUP_LEVEL,
				  NVL(SUP.SUP_SWITCH,0) SUP_SWITCH,
				  NVL(SUP.SCAN_SWITCH,0) SCAN_SWITCH,
				  NVL(SUP.CREDIT_SWITCH,0) CREDIT_SWITCH,
				  NVL(SUP.PAYMENT_SWITCH,0) PAYMENT_SWITCH, 
				  NVL(SUP.YINGYE_STATUS,0) YINGYE_STATUS,
				  NVL(SUP.BALANCE_LOAN_SWITCH,0) BALANCE_LOAN_SWITCH,
				  NVL(SUP.IRREGULAR_REPAYMENT_SWITCH,0) IRREGULAR_REPAYMENT_SWITCH,
				  NVL(SUP.B_MODEL_SWITCH,0) B_MODEL_SWITCH,
				  NVL(SUP.SMS_SWITCH,0) SMS_SWITCH,
				  NVL(SUP.DATAFILL_SWITCH,0) DATAFILL_SWITCH,
				  SUP.SCORE,
				  SUP.SUP_TYPE 
	   	FROM T_SYS_SUPPLIERS SUP
	   	WHERE 
	   	SUP.PARENT_ID = #{SUP_ID}
	   	<if test="SUP_SHORTNAME !=null and SUP_SHORTNAME !=''">AND SUP.SUP_SHORTNAME LIKE  '%${SUP_SHORTNAME}%'</if>
		<if test="CREATE_TIME !=null and CREATE_TIME !=''">AND SUP.CREATE_DATE = TO_DATE(#{CREATE_TIME},'YYYY-MM-DD')</if>
	 )T)TT WHERE ROWNO BETWEEN #{PAGE_BEGIN} AND #{PAGE_END}
</select>

<select id="getUnderSuppliersCount" parameterType="Map" resultType="int">
   SELECT COUNT(1)
	 FROM T_SYS_SUPPLIERS SUP
	WHERE 
		SUP.PARENT_ID = #{SUP_ID}
	   	<if test="SUP_SHORTNAME !=null and SUP_SHORTNAME !=''">AND SUP.SUP_SHORTNAME LIKE  '%${SUP_SHORTNAME}%'</if>
		<if test="CREATE_TIME !=null and CREATE_TIME !=''">AND SUP.CREATE_DATE = TO_DATE(#{CREATE_TIME},'YYYY-MM-DD')</if>
</select>

<select id="checkGroup" parameterType="map" resultType="int">
	SELECT COUNT(1) FROM T_SYS_SUPPLIERS WHERE PARENT_ID = #{SUP_ID}
</select>

<insert id="addSuppCompany" parameterType="map">
	INSERT INTO T_SYS_SUPP_COMPANY
	(
	SUP_ID,
	COMPANY_ID
	)VALUES(
	#{SUP_ID},
	#{COMPANY_ID}
	)
</insert>

<select id="getSuppCompany" parameterType="map" resultType="map">
	SELECT COM.COMPANY_ID,COM.COMPANY_NAME
 	FROM T_SYS_SUPP_COMPANY S_C,T_SYS_COMPANY COM
  	WHERE 
  	S_C.COMPANY_ID = COM.COMPANY_ID 
  	AND S_C.SUP_ID = #{SUP_ID}
</select>

<select id="getSuppCompanyBySupid" parameterType="map" resultType="map">
	SELECT * FROM T_SYS_SUPP_COMPANY WHERE SUP_ID = #{SUP_ID}
</select>

<delete id="delSuppCompany" parameterType="map" >
	DELETE FROM T_SYS_SUPP_COMPANY WHERE SUP_ID = #{SUP_ID} AND COMPANY_ID = #{COMPANY_ID}
</delete>

<select id="checkDel" parameterType="map" resultType="int">
	SELECT COUNT(1) FROM FIL_PROJECT_EQUIPMENT WHERE SUPPLIERS_ID = #{SUP_ID}
</select>
<select id="checkDel2" parameterType="map" resultType="int">
	SELECT COUNT(1) FROM FIL_PROJECT_HEAD WHERE BUSINESS_SOURCE = #{SUP_ID}
</select>

<update id="updateStatus" parameterType="map">
	UPDATE T_SYS_SUPPLIERS T SET T.STATUS = #{STATUS} WHERE T.SUP_ID = #{SUP_ID}
</update>

<select id="selectSupName" parameterType="map" resultType="int">
	SELECT COUNT(1) FROM T_SYS_SUPPLIERS SUP WHERE SUP.SUP_TYPE IN (1,4)
	<if test="SUP_SHORTNAME != null and SUP_SHORTNAME !=''">AND SUP.SUP_SHORTNAME = #{SUP_SHORTNAME}</if>
	<if test="SUP_NAME != null and SUP_NAME !=''">AND SUP.SUP_NAME = #{SUP_NAME}</if>
	<if test="SCODE != null and SCODE !=''">AND SUP.SCODE = #{SCODE}</if>
	<if test="SUP_ID !=null and SUP_ID != ''">AND SUP.SUP_ID != #{SUP_ID}</if>
</select>

<insert id="addManager" parameterType="map" >
	INSERT INTO FHFA_MANAGER_AFFILIATED
		(
		ID
		,TYPE
		,TYPE_ID
		,MANAGER_ID
		)
		VALUES(
		SEQ_MANAGER_AFFILIATED.nextval
		,#{TYPE}
		,#{TYPE_ID}
		,#{MANAGER_ID}
		)
</insert>

<insert id="addSpSupp" parameterType="map">
	INSERT INTO t_sys_supp_dealer
	(
	ID
	,SUP_ID
	,SP_ID
	)VALUES(
	SEQ_sys_supp_dealer.NEXTVAL
	,#{SUP_ID}
	,#{SP_ID}
	)
</insert>

<insert id="addSupplierInfo" parameterType="Map">
INSERT INTO T_SYS_SUPPLIERS_INFO
  ( 
    ID
    <if test="SUP_NAME != null and SUP_NAME != ''">,NAME</if>
    <if test="TAX_CODE != null and TAX_CODE != ''">,CORP_BUSINESS_LICENSE</if>
    <if test="SUP_LEGAL_NAME != null and SUP_LEGAL_NAME != ''">,LEGAL_PERSON</if>
    <if test="SUP_LEGAL_MOBIL != null and SUP_LEGAL_MOBIL != ''">,LEGAL_PERSON_PHONE</if>
    <if test="TAX_IDEN_NUM != null and TAX_IDEN_NUM != ''">,TAX_CODE</if>
    <if test="ORAGNIZATION_CODE != null and ORAGNIZATION_CODE != ''">,ORAGNIZATION_CODE</if>
    <if test="REGISTE_CAPITAL != null and REGISTE_CAPITAL != ''">,REGISTE_CAPITAL</if>
    <if test="PERIOD_VALIDITY != null and PERIOD_VALIDITY != ''">,PERIOD_OF_VALIDITY</if>
    <if test="SETUP_DATE != null and SETUP_DATE != ''">,SETUP_DATE</if>
    <if test="SUP_FAX != null and SUP_FAX != ''">,FAX</if>
    <if test="SUP_ZIP != null and SUP_ZIP != ''">,POST</if>
    <if test="PROV_ID != null and PROV_ID != ''">,PROVINCE</if>
    <if test="CITY_ID != null and CITY_ID != ''">,CITY</if>
    <if test="TAX_QUAL != null and TAX_QUAL != ''">,TAX_QUALIFICATION</if>
    <if test="BILL_ADDRESS != null and BILL_ADDRESS != ''">,REGISTE_ADDRESS</if>
    
    <if test="TYPE !=null and TYPE !=''">,TYPE</if>
    <if test="BUSINESS_TYPE !=null and BUSINESS_TYPE !=''">,BUSINESS_TYPE</if>
    <if test="IS_GUARANTEE !=null and IS_GUARANTEE !=''">,IS_GUARANTEE</if>
    <if test="REGISTE_DATE !=null and REGISTE_DATE !=''">,REGISTE_DATE</if>
    <if test="REGISTE_PHONE !=null and REGISTE_PHONE !=''">,REGISTE_PHONE</if>
    <if test="NUMBER_PER !=null and NUMBER_PER !=''">,NUMBER_PER</if>
    <if test="RATEPAYING !=null and RATEPAYING !=''">,RATEPAYING</if>
    <if test="MAIN_BUSINESS !=null and MAIN_BUSINESS !=''">,MAIN_BUSINESS</if>
    <if test="SCALE_ENTERPRISE !=null and SCALE_ENTERPRISE !=''">,SCALE_ENTERPRISE</if>
    <if test="WORK_ADDRESS !=null and WORK_ADDRESS !=''">,WORK_ADDRESS</if>
    <if test="REMARK !=null and REMARK !=''">,REMARK</if>
    <if test="SUP_ID !=null and SUP_ID !=''">,SUP_ID</if>
    <if test="WORK_PROV !=null and WORK_PROV !=''">,WORK_PROV</if>
    <if test="WORK_CITY !=null and WORK_CITY !=''">,WORK_CITY</if>
    <if test="WORK_AREA !=null and WORK_AREA !=''">,WORK_AREA</if>
  )
  VALUES
  (
    SEQ_T_SYS_SUPPLIERS_INFO.NEXTVAL
    <if test="SUP_NAME != null and SUP_NAME != ''">,#{SUP_NAME}</if>
    <if test="TAX_CODE != null and TAX_CODE != ''">,#{TAX_CODE}</if>
    <if test="SUP_LEGAL_NAME != null and SUP_LEGAL_NAME != ''">,#{SUP_LEGAL_NAME}</if>
    <if test="SUP_LEGAL_MOBIL != null and SUP_LEGAL_MOBIL != ''">,#{SUP_LEGAL_MOBIL}</if>
    <if test="TAX_IDEN_NUM != null and TAX_IDEN_NUM != ''">,#{TAX_IDEN_NUM}</if>
    <if test="ORAGNIZATION_CODE != null and ORAGNIZATION_CODE != ''">,#{ORAGNIZATION_CODE}</if>
    <if test="REGISTE_CAPITAL != null and REGISTE_CAPITAL != ''">,#{REGISTE_CAPITAL}</if>
    <if test="PERIOD_VALIDITY != null and PERIOD_VALIDITY != ''">,TO_DATE(#{PERIOD_VALIDITY},'YYYY-MM-DD')</if>
    <if test="SETUP_DATE != null and SETUP_DATE != ''">,TO_DATE(#{SETUP_DATE},'YYYY-MM-DD')</if>
    <if test="SUP_FAX != null and SUP_FAX != ''">,#{SUP_FAX}</if>
    <if test="SUP_ZIP != null and SUP_ZIP != ''">,#{SUP_ZIP}</if>
    <if test="PROV_ID != null and PROV_ID != ''">,#{PROV_ID}</if>
    <if test="CITY_ID != null and CITY_ID != ''">,#{CITY_ID}</if>
    <if test="TAX_QUAL != null and TAX_QUAL != ''">,#{TAX_QUAL}</if>
    <if test="BILL_ADDRESS != null and BILL_ADDRESS != ''">,#{BILL_ADDRESS}</if>
    
    <if test="TYPE !=null and TYPE !=''">,#{TYPE}</if>
    <if test="BUSINESS_TYPE !=null and BUSINESS_TYPE !=''">,#{BUSINESS_TYPE}</if>
    <if test="IS_GUARANTEE !=null and IS_GUARANTEE !=''">,#{IS_GUARANTEE}</if>
    <if test="REGISTE_DATE !=null and REGISTE_DATE !=''">,TO_DATE(#{REGISTE_DATE},'YYYY-MM-DD')</if>
    <if test="REGISTE_PHONE !=null and REGISTE_PHONE !=''">,#{REGISTE_PHONE}</if>
    <if test="NUMBER_PER !=null and NUMBER_PER !=''">,#{NUMBER_PER}</if>
    <if test="RATEPAYING !=null and RATEPAYING !=''">,#{RATEPAYING}</if>
    <if test="MAIN_BUSINESS !=null and MAIN_BUSINESS !=''">,#{MAIN_BUSINESS}</if>
    <if test="SCALE_ENTERPRISE !=null and SCALE_ENTERPRISE !=''">,#{SCALE_ENTERPRISE}</if>
    <if test="WORK_ADDRESS !=null and WORK_ADDRESS !=''">,#{WORK_ADDRESS}</if>
    <if test="REMARK !=null and REMARK !=''">,#{REMARK}</if>
    <if test="SUP_ID !=null and SUP_ID !=''">,#{SUP_ID}</if>
    <if test="WORK_PROV !=null and WORK_PROV !=''">,#{WORK_PROV}</if>
    <if test="WORK_CITY !=null and WORK_CITY !=''">,#{WORK_CITY}</if>
    <if test="WORK_AREA !=null and WORK_AREA !=''">,#{WORK_AREA}</if>
  )
</insert>

<update id="updateSupplierInfo" parameterType="Map">
	UPDATE T_SYS_SUPPLIERS_INFO 
		SET TYPE = #{TYPE}
          <if test="SUP_NAME != null ">,NAME = #{SUP_NAME}</if>
		<if test="TAX_CODE != null ">,CORP_BUSINESS_LICENSE = #{TAX_CODE}</if>
		<if test="SUP_LEGAL_NAME != null ">,LEGAL_PERSON = #{SUP_LEGAL_NAME}</if>
		<if test="SUP_LEGAL_MOBIL != null ">,LEGAL_PERSON_PHONE = #{SUP_LEGAL_MOBIL}</if>
		<if test="TAX_IDEN_NUM != null ">,TAX_CODE = #{TAX_IDEN_NUM}</if>
		<if test="ORAGNIZATION_CODE != null ">,ORAGNIZATION_CODE = #{ORAGNIZATION_CODE}</if>
		<if test="REGISTE_CAPITAL != null ">,REGISTE_CAPITAL = #{REGISTE_CAPITAL}</if>
		<if test="PERIOD_VALIDITY != null ">,PERIOD_OF_VALIDITY = TO_DATE(#{PERIOD_VALIDITY},'YYYY-MM-DD')</if>
		<if test="SETUP_DATE != null ">,SETUP_DATE = TO_DATE(#{SETUP_DATE},'YYYY-MM-DD')</if>
		<if test="SUP_FAX != null ">,FAX = #{SUP_FAX}</if>
		<if test="SUP_ZIP != null ">,POST = #{SUP_ZIP}</if>
		<if test="PROV_ID != null ">,PROVINCE = #{PROV_ID}</if>
		<if test="CITY_ID != null ">,CITY = #{CITY_ID}</if>
		<if test="TAX_QUAL != null ">,TAX_QUALIFICATION = #{TAX_QUAL}</if>
		<if test="BILL_ADDRESS != null ">,REGISTE_ADDRESS = #{BILL_ADDRESS}</if>
		
		<if test="BUSINESS_TYPE !=null ">,BUSINESS_TYPE = #{BUSINESS_TYPE}</if>
		<if test="IS_GUARANTEE !=null ">,IS_GUARANTEE = #{IS_GUARANTEE}</if>
		<if test="REGISTE_DATE !=null ">,REGISTE_DATE = TO_DATE(#{REGISTE_DATE},'YYYY-MM-DD')</if>
		<if test="REGISTE_PHONE !=null ">,REGISTE_PHONE = #{REGISTE_PHONE}</if>
		<if test="NUMBER_PER !=null ">,NUMBER_PER = #{NUMBER_PER}</if>
		<if test="RATEPAYING !=null ">,RATEPAYING = #{RATEPAYING}</if>
		<if test="MAIN_BUSINESS !=null ">,MAIN_BUSINESS = #{MAIN_BUSINESS}</if>
		<if test="SCALE_ENTERPRISE !=null ">,SCALE_ENTERPRISE = #{SCALE_ENTERPRISE}</if>
		<if test="WORK_ADDRESS !=null ">,WORK_ADDRESS = #{WORK_ADDRESS}</if>
		<if test="REMARK !=null ">,REMARK = #{REMARK}</if>
		<if test="WORK_PROV !=null ">,WORK_PROV = #{WORK_PROV}</if>
		<if test="WORK_CITY !=null ">,WORK_CITY = #{WORK_CITY}</if>
		<if test="WORK_AREA !=null ">,WORK_AREA = #{WORK_AREA}</if>
          WHERE SUP_ID = #{SUP_ID}
</update>

<select id="select_count" parameterType="Map" resultType="int">
	SELECT COUNT(1) 
		FROM T_SYS_SUPPLIERS_INFO INFO 
		WHERE INFO.SUP_ID = #{SUP_ID}
</select>

</mapper>
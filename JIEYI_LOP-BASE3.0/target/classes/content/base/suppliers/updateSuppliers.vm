<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>经销商信息修改</title>
	<!-- 路径定义-->
	#set ( $_basePath = $request.ContextPath )
	<script type="text/javascript">
		var _basePath = "$!_basePath";
	</script>
	  #parse("content/importBase.vm")
	<script type="text/javascript" src="$_basePath/res/jquery/plugins/jquery.form.js"></script>
	<script type="text/javascript" src="$_basePath/js/ajaxfileupload.js"></script>
	<script type="text/javascript"  src="js/suppliers.js"></script>
	<script type="text/javascript"  src="js/yanzheng.js"></script>
	<script >
		
    	$(function(){
			$.ajaxSetup ({
	   			 cache: false //关闭AJAX相应的缓存c
			});
			$(".defineParent").click(function(){
				var t = $(this);
				var parent_id = t.val();
				var short_name = t.attr("SHORTNAME");
				$("#PARENT_ID").val(parent_id);
				$("#PARENT_SHORTNAME").val(short_name);
				$("#dialogParent").dialog("close");
			});
			
			$('#LENDING_TYPE').combobox('setValues','$!supplier.LENDING_TYPE'.split(','));
			
##			$('#cc').combogrid({
##			   	panelWidth:150,
##			    idField:'ID',
##			    textField:'NAME',
##			    showHeader:false,
##			    url:'$_basePath/base/suppliers/Suppliers!getProv.action',
##			    columns:[[
##			        {field:'ID',hidden:true},
##			        {field:'NAME',width:150},
##			    ]]
##			    ,filter : function(q, row) {
##					//var opts = $(this).combogrid("options");
##					//var fieldTxt = row[opts.textField];
##					var reg = new RegExp("^"+q, "gi");
##					
##					return reg.test(row['SHORT_NAME'] ) ||  reg.test(row['NAME'] );
##				}
##				,onSelect:function(rowIndex, rowData){
##	                $('#dd').combogrid({
##	                	panelWidth:150,
##					    idField:'ID',
##					    textField:'NAME',
##					    showHeader:false,
##					    url:'$_basePath/base/suppliers/Suppliers!getCity.action?PARENT_ID='+rowData.ID,
##					    columns:[[
##					        {field:'ID',hidden:true},
##					        {field:'NAME',width:150},
##					    ]]
##					   
##					});
##					$('#ee').combogrid({
##						data:[]
##					});
##					$('#ee').combogrid('options',[]);
##	            }
##			});
##			$('#dd').combogrid({
##				onSelect:function(rowIndex, rowData){
##					$('#ee').combogrid({
##	                	panelWidth:150,
##					    idField:'ID',
##					    textField:'NAME',
##					    showHeader:false,
##					    url:'$_basePath/base/suppliers/Suppliers!getCity.action?PARENT_ID='+rowData.ID,
##					    columns:[[
##					        {field:'ID',hidden:true},
##					        {field:'NAME',width:150},
##					    ]]
##					   
##					});
##				}
##			});
##			$('#ee').combogrid({
##			});

			$(".SSFGS").click(function(){
				$("#addCompany_FGS").dialog('open',{top:300,left:200});
			});
			//添加类型
			$("#doCompany_FGS").click(function(){
				var checkIdData = [];
				var BusinessName = '';
				var checkIds = '';
				$("[name = FGS_ID]:checkbox").each(function(){
					if($(this).is(":checked")){
						BusinessName = $(this).attr("SSFGSValue")+","+ BusinessName ;
						checkIds = $(this).attr("SSFGSId")+","+ checkIds ;
					}
				});
				$("#SSJGNM").empty();
				$("#SSJGNM").val(BusinessName);
				$("#SSJG").empty();
				$("#SSJG").val(checkIds);
				closeDailog('addCompany_FGS');
			});
        })
		
		function closeDailog(div){
			$("#"+div).dialog('close');
		}
		function selectArea(a){
		    var tr=$(a).parent().parent();
        	jQuery.ajax({
        		url:"$_basePath/base/suppliers/Suppliers!getAreaMess.action?PARENT_ID="+a.value,
        		type:"post", 
        		dataType:"json",
        		success:function(data){
        			//将本行的输入框初始化
        			$(tr).find(".eqProv").each(function (){
        				//初始化
        				if ($(this).is("select"))
        				{
        					$(this).empty();
        					$(this).append($("<option>").val("").text("--请选择--"));
        				}
        			});
        			var PROV_ID = $(tr).find("select[name='PROV_ID']");
        			for (var i=0; i<data.provs.length;i++) {
        				$(PROV_ID).append($("<option>").val(data.provs[i].ID).text(data.provs[i].NAME));
        			}
        		}
        	});
		
		}
		
		function selectProv(b){
		    var tr=$(b).parent().parent();
        	jQuery.ajax({
        		url:"$_basePath/base/suppliers/Suppliers!getCityMess.action?PARENT_ID="+b.value,
        		type:"post", 
        		dataType:"json",
        		success:function(data){
        			//将本行的输入框初始化
        			$(tr).next().find(".cityMess").each(function (){
        				//初始化
        				if ($(this).is("select"))
        				{
        					$(this).empty();
        					$(this).append($("<option>").val("").text("--请选择--"));
        				}
        			});
        			var CITY_ID = $(tr).next().find("select[name='CITY_ID']");
        			for (var i=0; i<data.provs.length;i++) {
						$(CITY_ID).append($("<option>").val(data.provs[i].ID).text(data.provs[i].NAME));
        			}
        		}
        	});
		}
		
		
		
		//获取设备类型
         function updateNatural(obj){
		     var INVEST_ID = obj.getAttribute("INVEST_ID");
        	 var INVEST_NAME = obj.getAttribute("PERSON_NAME");
			 var INVEST_SEX = obj.getAttribute("INVEST_SEX");
			 var INVEST_MONEY = obj.getAttribute("INVEST_MONEY");
			 var INVEST_STOCK = obj.getAttribute("INVEST_STOCK");
			 var INVEST_DUTY = obj.getAttribute("INVEST_DUTY");
			 var INVEST_ID_CARD = obj.getAttribute("INVEST_ID_CARD");
			 var INVEST_PHONE = obj.getAttribute("INVEST_PHONE");
			 $("#invesNaturalForm input[name='ID']").val(INVEST_ID);
			 $("#invesNaturalForm input[name='INVEST_NAME']").val(INVEST_NAME);
			 $("#invesNaturalForm input[name='INVEST_MONEY']").val(INVEST_MONEY);
			 $("#invesNaturalForm input[name='INVEST_STOCK']").val(INVEST_STOCK);
			 $("#invesNaturalForm input[name='INVEST_DUTY']").val(INVEST_DUTY);
			 $("#invesNaturalForm input[name='INVEST_ID_CARD']").val(INVEST_ID_CARD);
			 $("#invesNaturalForm input[name='INVEST_PHONE']").val(INVEST_PHONE);
			 $('#dialogNatural').dialog('open').dialog('setTitle','修改投资者(个人)');
		}
		
		function updateLegal(obj){
			
        	 var INVEST_ID = obj.getAttribute("INVEST_ID");
        	 var INVEST_NAME = obj.getAttribute("COMPANY_NAME");
			 var INVEST_LEGAL_NAME = obj.getAttribute("LEGAL_NAME");
			 var INVEST_MONEY = obj.getAttribute("INVEST_MONEY");
			 var INVEST_STOCK = obj.getAttribute("INVEST_STOCK");
			 var INVEST_ORG_CODE = obj.getAttribute("INVEST_ORG_CODE");
			 var INVEST_PHONE = obj.getAttribute("INVEST_PHONE");
			 $("#invesLegalForm input[name='ID']").val(INVEST_ID);
			 $("#invesLegalForm input[name='INVEST_NAME']").val(INVEST_NAME);
			 $("#invesLegalForm input[name='INVEST_MONEY']").val(INVEST_MONEY);
			 $("#invesLegalForm input[name='INVEST_STOCK']").val(INVEST_STOCK);
			 $("#invesLegalForm input[name='INVEST_LEGAL_NAME']").val(INVEST_LEGAL_NAME);
			 $("#invesLegalForm input[name='INVEST_ORG_CODE']").val(INVEST_ORG_CODE);
			 $("#invesLegalForm input[name='INVEST_PHONE']").val(INVEST_PHONE);
			 $('#dialogLegal').dialog('open').dialog('setTitle','修改投资者(法人)');
		}
		
	    function updateLinkMan(obj){
        	 var LINK_ID = obj.getAttribute("LINK_ID");
			 var LINK_NAME = obj.getAttribute("LINK_NAME")
        	 var LINK_ADDR = obj.getAttribute("ADDRESS");
			 var LINK_EMAIL = obj.getAttribute("EMAIL");
			 var LINK_IDCARD = obj.getAttribute("IDCARD");
			 var LINK_MOBILE = obj.getAttribute("MOBILE");
			 var LINK_PHONE = obj.getAttribute("PHONE");
			 $("#linkManForm input[name='LINK_ID']").val(LINK_ID);
			 $("#linkManForm input[name='LINK_NAME']").val(LINK_NAME);
			 $("#linkManForm input[name='LINK_ADDR']").val(LINK_ADDR);
			 $("#linkManForm input[name='LINK_EMAIL']").val(LINK_EMAIL);
			 $("#linkManForm input[name='LINK_MOBILE']").val(LINK_MOBILE);
			 $("#linkManForm input[name='LINK_IDCARD']").val(LINK_IDCARD);
			 $("#linkManForm input[name='LINK_PHONE']").val(LINK_PHONE);
			 $('#dialogLinkMan').dialog('open').dialog('setTitle','修改联系人');
		}

		//关闭dialog
		function closeDialog(name){
		   $('#'+name).dialog('close')
		}
		
		//打开dialog
		function openDialog(div,name){
			if(div=='dialogNatural')
			{
				//添加，清ID
				 $("#invesNaturalForm input[name='ID']").val("");
			}
			else if(div=='dialogLegal'){
				//添加，清ID
				  $("#invesLegalForm input[name='ID']").val("");
			}
			else if(div=='dialogLinkMan'){
				//添加，清ID
				  $("#dialogLinkMan input[name='LINK_ID']").val("");
			}
		    $('#'+div).dialog('open').dialog('setTitle',name);
		}
		
		//根据条件取数据，需jQuery json支持
        function getFromData(str){
        	var data={};
        	$(str +' [name]').each(function(){
        		if($(this).is(":checkbox,:radio")){
        			if($(this).attr("checked")){
        				data[$(this).attr("name")]=$(this).val();
        			}
        		}else{
        			if($(this).is("select")){
        				data[$(this).attr("name")]=$(this).find(":selected").val();
        			}else{
        				data[$(this).attr("name")]=$(this).val();
        			}
        		}
        	});
        	 
        	return JSON.stringify(data);
        }
		
		function saveSupplier(){
			var fkfs = $('#LENDING_TYPE').combobox('getValues');
			if(fkfs==''){
				return alert('请选择放款方式！');
			}
			var cglx = $('#WHETHER_SALES_SI').val();
			if(cglx==''){
				return alert('请选择采购类型！');
			}
    		var data = getFromData("#frmSearch");
    		var dataObj = JSON.parse(data);
    		dataObj.LENDING_TYPE = $('#LENDING_TYPE').combobox('getValues').join(",");
    		data = JSON.stringify(dataObj);
    		console.debug(dataObj.LENDING_TYPE);
    		
			if(!$("#frmSearch").form('validate'))
				return ;  
			var SUP_ID = $("#SUP_ID").val();
        	jQuery.ajax({
        		type: "POST",
        		url: "Suppliers!saveSupplierMess.action",
        		data: "json="+data+"&SUP_ID="+SUP_ID,
        		dataType: "json",
        		success: function(data){
        			 if(data.flag==false){
					     jQuery.messager.alert("提示",data.msg) ;
					 }else{
					    jQuery.messager.alert("提示",data.msg,"info",function(){
							top.addTab("经销商管理",_basePath+"/base/suppliers/Suppliers.action");
							top.closeTab("添加经销商");
						}); 
					 }
        		}
        	});
		}
		

		
		function saveNatural(){
		   var data1 = getFromData("#invesNaturalForm");
		   var SUP_ID = $("#SUP_ID").val();
		   jQuery.ajax({
        		type: "POST",
        		url: "Suppliers!saveInvestor.action",
        		data: "json="+data1+"&SUP_ID="+SUP_ID,
        		dataType: "json",
        		success: function(data){
        			 if(data.flag==false){
					    jQuery.messager.alert("提示",data.msg); 
					 }else{
					    var bsdte="";
						for(var i=0;i<data.length;i++){
							bsdte=bsdte+"<tr>";
                    		bsdte=bsdte+"<td align='left'>"+notUndefined(data[i].INVEST_NAME)+"</td>";
                    		bsdte=bsdte+"<td  align='left'>"+notUndefined(data[i].INVEST_SEX)+"</td>";
                    		bsdte=bsdte+"<td  align='left'>"+notUndefined(data[i].INVEST_MONEY)+"</td>";
                    		bsdte=bsdte+"<td  align='left'>"+notUndefined(data[i].INVEST_STOCK)+"</td>";
                    		bsdte=bsdte+"<td  align='left'>"+notUndefined(data[i].INVEST_DUTY)+"</td>";
                    		bsdte=bsdte+"<td  align='left'>"+notUndefined(data[i].INVEST_ID_CARD)+"</td>";
                    		bsdte=bsdte+"<td  align='left'>"+notUndefined(data[i].INVEST_PHONE)+"</td>";
                    		bsdte=bsdte+"<td  align='center' ><a href='javascript:void(0);' onclick='deleteNatural(this,"+data[i].ID+")'>删除</a>&nbsp;&nbsp;";
							bsdte=bsdte+"<a href='javascript:void(0);' PERSON_NAME='"+data[i].INVEST_NAME+"' INVEST_SEX='"+data[i].INVEST_SEX+"' INVEST_MONEY='"+data[i].INVEST_MONEY+"' INVEST_STOCK='"+data[i].INVEST_STOCK+"' INVEST_DUTY='"+data[i].INVEST_DUTY+"' INVEST_ID_CARD='"+data[i].INVEST_ID_CARD+"' INVEST_PHONE='"+data[i].INVEST_PHONE+"' INVEST_ID='"+data[i].ID+"' onclick='updateNatural(this)'>修改</a></td>";
                    		bsdte=bsdte+"</tr>";
						}
						$("#naturalBody").html(bsdte);
						$('#dialogNatural').dialog('close');
					 }
        		}
        	});
		}
		
		
		function notUndefined(para)
    	{
   			 if(para != null && para != "null" && para != undefined && para != "undefined")
    			return(para);
   			 else
   				return "";
    	}
		
		function saveLinkMan(){
		   var data = getFromData("#linkManForm");
		   var SUP_ID = $("#SUP_ID").val();
		   jQuery.ajax({
        		type: "POST",
        		url: "Suppliers!saveLinkMan.action",
        		data: "json="+data+"&SUP_ID="+SUP_ID,
        		dataType: "json",
        		success: function(data){
        			 if(data.flag==false){
					    jQuery.messager.alert("提示",data.msg); 
					 }else{
					    var bsdte="";
						for(var i=0;i<data.length;i++){
							bsdte=bsdte+"<tr>";
                    		bsdte=bsdte+"<td align='left'>"+notUndefined(data[i].LINK_NAME)+"</td>";
                    		bsdte=bsdte+"<td  align='left'>"+notUndefined(data[i].LINK_IDCARD)+"</td>";
							bsdte=bsdte+"<td align='left'>"+notUndefined(data[i].LINK_PHONE)+"</td>";
                    		bsdte=bsdte+"<td  align='left'>"+notUndefined(data[i].LINK_MOBILE)+"</td>";
							bsdte=bsdte+"<td align='left'>"+notUndefined(data[i].LINK_EMAIL)+"</td>";
                    		bsdte=bsdte+"<td  align='left'>"+notUndefined(data[i].LINK_ADDR)+"</td>";
                    		bsdte=bsdte+"<td  align='center' ><a href='javascript:void(0);' onclick='deleteLinkMan(this,"+data[i].LINK_ID+")'>删除</a>&nbsp;&nbsp;";
							bsdte=bsdte+"<a href='javascript:void(0);' LINK_NAME='"+data[i].LINK_NAME+"' IDCARD='"+data[i].LINK_IDCARD+"' PHONE='"+data[i].LINK_PHONE+"' MOBILE='"+data[i].LINK_MOBILE+"' EMAIL='"+data[i].LINK_EMAIL+"' ADDRESS='"+data[i].LINK_ADDR+"' LINK_ID='"+data[i].LINK_ID+"' onclick='updateLinkMan(this)'>修改</a></td>";
                    		bsdte=bsdte+"</tr>";
						}
						$("#linkBody").html(bsdte);
						$('#dialogLinkMan').dialog('close');
					 }
        		}
        	});
		}
		
		function saveLegal(){
		   var data = getFromData("#invesLegalForm");
		   var SUP_ID = $("#SUP_ID").val();
		   jQuery.ajax({
        		type: "POST",
        		url: "Suppliers!saveInvestor.action",
        		data: "json="+data+"&SUP_ID="+SUP_ID,
        		dataType: "json",
        		success: function(data,v){
					    var bsdte="";
						for(var i=0;i<data.length;i++){
							bsdte=bsdte+"<tr>";
                    		bsdte=bsdte+"<td align='left'>"+notUndefined(data[i].INVEST_NAME)+"</td>";
                    		bsdte=bsdte+"<td  align='left'>"+notUndefined(data[i].INVEST_LEGAL_NAME)+"</td>";
							bsdte=bsdte+"<td  align='left'>"+notUndefined(data[i].INVEST_MONEY)+"</td>";
							bsdte=bsdte+"<td  align='left'>"+notUndefined(data[i].INVEST_STOCK)+"</td>";
                    		bsdte=bsdte+"<td  align='left'>"+notUndefined(data[i].INVEST_ORG_CODE)+"</td>";
							bsdte=bsdte+"<td  align='left'>"+notUndefined(data[i].INVEST_ADDR)+"</td>";
							bsdte=bsdte+"<td align='left'>"+notUndefined(data[i].INVEST_PHONE)+"</td>";
                    		bsdte=bsdte+"<td  align='center' ><a href='javascript:void(0);' onclick='deleteLegal(this,"+data[i].ID+")'>删除</a>&nbsp;&nbsp;";
                            bsdte=bsdte+"<a href='javascript:void(0);' COMPANY_NAME='"+data[i].INVEST_NAME+"' LEGAL_NAME='"+data[i].INVEST_LEGAL_NAME+"' INVEST_MONEY='"+data[i].INVEST_MONEY+"' INVEST_STOCK='"+data[i].INVEST_STOCK+"' INVEST_ORG_CODE='"+data[i].INVEST_ORG_CODE+"' INVEST_ADDR='"+data[i].INVEST_ADDR+"' INVEST_PHONE='"+data[i].INVEST_PHONE+"' INVEST_ID='"+data[i].ID+"' onclick='updateLegal(this)'>修改</a></td>";
                    		bsdte=bsdte+"</tr>";
						}
						$("#legalBody").html(bsdte);
						$('#dialogLegal').dialog('close');
				}
        	});
		}
		
		function saveUpLoad(){
    		var f=$("#fileid").val();
    		var FIL_MEMO=$("#FIL_MEMO").val();
    		if(f==null||f==""){
    			alert("请选择要上传的文件");
    			return false;
    		}else if(FIL_MEMO==""){
    			alert("文件描述不能为空");
    			return false;
    		}else{
			    var supplier_name = $("#SUPPLIERS_NAME").val();
    			var ID=$("#SUP_ID").val();
        		jQuery.ajaxFileUpload({
                	    url:"Suppliers!uploadFile.action?FIL_MEMO="+FIL_MEMO+"&SUP_ID="+ID+"&SUP_NAME="+supplier_name,
                	    secureuri:false,
                	    fileElementId:"fileid",	 
                	    dataType: "json",
						success: function (data,status)  //服务器成功响应处理函数
                        {
						     var data = JSON.parse(data);
        					 var bsdte="";
    						 for(var i=0;i<data.length;i++){
    							bsdte=bsdte+"<tr>";
                    			bsdte=bsdte+"<td align='center' title='"+data[i].FIL_NAME+"'>"+data[i].FIL_NAME+"</td>";
                    			bsdte=bsdte+"<td align='center' title='"+data[i].FIL_MEMO+"'>"+data[i].FIL_MEMO+"</td>";
                                bsdte=bsdte+"<td align='center'><a href='Suppliers!downLoadSupFile.action?FIL_ID="+data[i].FIL_ID+"'>下载</a>   ";
            					bsdte=bsdte+"<a href='javascript:void(0);' onclick='delFile("+data[i].FIL_ID+",this)'>删除</a></td></tr>";
    						 }
    						 $("#tblfsg").html(bsdte);	 
 
                        },
        
               	});	
        		 $("#dialoguploadfile1").dialog('close');
        	}
		}
		
		//联系人删除
        function deleteLinkMan(obj,link_id){
        	if(confirm("是否确定删除")){
            	jQuery.ajax({
            		type: "POST",
            		url: "Suppliers!delLinkMan.action",
            		data: "LINK_ID="+link_id,
            		dataType: "json",
            		success: function(data){
    					if(data.flag==true){
    						jQuery.messager.alert("提示",data.msg);
    						var tab=obj.parentNode.parentNode.parentNode;
    						var tr=obj.parentNode.parentNode;
    						tab.removeChild(tr);  
    					}else{
    					   jQuery.messager.alert("提示",data.msg);
    					}
            		}
            	});
    		}
        }
		
		//删除投资人个人
        function deleteNatural(obj,invest_id){
        	if(confirm("是否确定删除")){
            	jQuery.ajax({
            		type: "POST",
            		url: "Suppliers!delInvestor.action",
            		data: "ID="+invest_id,
            		dataType: "json",
            		success: function(data){
    					if(data.flag==true){
    						jQuery.messager.alert("提示",data.msg);
    						var tab=obj.parentNode.parentNode.parentNode;
    						var tr=obj.parentNode.parentNode;
    						tab.removeChild(tr);  
    					}else{
    					   jQuery.messager.alert("提示",data.msg);
    					}
            		}
            	});
    		}
        }
		
		//删除投资人法人
        function deleteLegal(obj,invest_id){
        	if(confirm("是否确定删除")){
            	jQuery.ajax({
            		type: "POST",
            		url: "Suppliers!delInvestor.action",
            		data: "ID="+invest_id,
            		dataType: "json",
            		success: function(data){
    					if(data.flag==true){
    						jQuery.messager.alert("提示",data.msg);
    						var tab=obj.parentNode.parentNode.parentNode;
    						var tr=obj.parentNode.parentNode;
    						tab.removeChild(tr);  
    					}else{
    					   jQuery.messager.alert("提示",data.msg);
    					}
            		}
            	});
    		}
        }
		
		//删除附件
    	function delFile(fil_id,obj){
    		if(confirm("是否确定删除")){
            	jQuery.ajax({
            		type: "POST",
            		url: "Suppliers!deleteSupFile.action",
            		data: "FIL_ID="+fil_id,
            		dataType: "json",
            		success: function(res){
						if(res.flag==true){
							jQuery.messager.alert("提示",res.msg);
							var tab=obj.parentNode.parentNode.parentNode;
							var tr=obj.parentNode.parentNode;
							tab.removeChild(tr);  
						}else{
						    jQuery.messager.alert("提示",res.msg);
						}
            		}
            	});
    		}
    	}
    	
    
    //经营产品对应厂商
    function findCompany(){
    	jQuery.ajax({
    		url : '$!_basePath/base/suppliers/Suppliers!findCompany.action',
    		type : 'post',
    		dataType : 'json',
    		success : function(data){
    			$('#trCompany').html('');
    			var flag;
    			var newscode;
    			$('.trCompany').remove();
    			var html = '<tr >'
    				+'<td>'
    				+'	<input type="checkbox" onclick="selectAll(this);">'
    				+'</td>'
    				+'<td>全选</td>'
    				+'</tr>';
    			$('#tableCompany tr:last').after(html);
    			for(var i=0;i<data.companys.length;i++){
    				flag = data.companys[i].FLAG;
    				newscode = data.companys[i].NEWSCODE;
    				if(!data.companys[i].FLAG){
    					flag = "";
    				}
    				if(!data.companys[i].NEWSCODE){
    					newscode = "";
    				}
    				
    				html = '<tr class="trCompany">'
    				+'<td><input type="checkbox" name="companyID" class="companys"';
    				
    				var cid = $('#COMPANY_ID').val().split(',');
    				for(var y=0;y<cid.length;y++){
    					if(cid[y]==data.companys[i].COMPANY_ID){
    						console.debug($('#COMPANY_ID').val()==data.companys[i].COMPANY_ID);
    						html += 'checked="checked"';
    					}
    				}
    				
##    				if($('#COMPANY_ID').val()==data.companys[i].COMPANY_ID){
##    					console.debug($('#COMPANY_ID').val()==data.companys[i].COMPANY_ID);
##    					html += 'checked="checked"';
##    				}
    				html+='COMPANY_NAME="'+data.companys[i].NAME+'" FLAG="'+flag+'" NEWSCODE="'+newscode+'"  value="'+data.companys[i].COMPANY_ID+'"/></td>'
    				+'<td>'+data.companys[i].NAME+'</td>'
    				+'</tr>';
    				$('#tableCompany tr:last').after(html);
    			}
    		},
    		beforeSend: function(){
##    			$('#trCompany').html('正在加载中...');
    		}
    	})
    }
    
    function selectAll(check){
    	if($(check).attr('checked')){
    		$('.companys').attr('checked',true);
    	}else{
    		$('.companys').attr('checked',false);
    	}
    }
    
    function defineCompany(t){
    	var chk_value = [];
    	var chk_name = [];
    	$('input[name="companyID"]:checked').each(function(){
    		chk_value.push($(this).val());
    		chk_name.push($(this).attr('COMPANY_NAME'));
    	})
##    	alert(chk_value==0?"您还没有选择任何内容":chk_value.join(","));
    	
    	$('#COMPANY_ID').val(chk_value.join(","));
    	$('#COMPANY_NAME').val(chk_name.join(","));
		$("#dialogCompany").dialog("close");
	}
	
	function findGroup(){
		jQuery.ajax({
			url: '$!_basePath/base/suppliers/Suppliers!findGroup.action',
			type: 'post',
			dataType:'json',
			success: function(data){
				
			}
		})
	}
	
	function hideGroup(){
    	$('#PARENT_ID').val('');
    	$('#PARENT_SHORTNAME').attr('disabled','disabled');
    	$('#PARENT_SHORTNAME').val('');
    	$('#COMPANY_NAME').removeAttr('data-options');
    	$('#companyRed').html('');
    	
    	$('#COMPANY_ID').val('');
    	$('#COMPANY_NAME').val('');
    	$('#COMPANY_NAME').attr('disabled','disabled');
    }
    function showGroup(){
    	$('#companyRed').html('*');
    	$('#COMPANY_ID').val('$!supplier.COMPANY_ID');
    	$('#COMPANY_NAME').val('$!supplier.COMPANY_NAME');
    	$('#COMPANY_NAME').removeAttr('disabled');
    	jQuery.ajax({
    		url: '$!_basePath/base/suppliers/Suppliers!checkGroup.action',
    		data: 'SUP_ID=$!supplier.SUP_ID',
    		type: 'post',
    		dataType: 'json',
    		success: function(data){
    			if(data.count<1){
			    	$('#PARENT_SHORTNAME').removeAttr('disabled');
			    	$('.defineParent').removeAttr('checked');
    			}else{
    				alert('请取消此集团下的经销商后再试！');
    				$('#true').attr('checked','checked');
    				$('#false').removeAttr('checked');
    				$('#COMPANY_NAME').attr('disabled','disablid');
    			}
    		}
    	})
    }
	$("#choose_fgs").click(function(){
		if($(this).is(":checked")){
			$("input[name='FGS_ID']").attr("checked", true);
		}else{
			$("input[name='FGS_ID']").attr("checked", false);
		}
	});
    </script>
    </head>
    <body style="margin:0">	
    <!-- 厂商信息-->
	<div id="dialogCompany" class="easyui-dialog" style="width:400px;height:380px;padding:10px" closed="true" buttons="#dialogCompany-buttons"  >
		<table id="tableCompany">
			<tr id="trCompany"><tr>

        </table>
    </div>
    <div id="dialogCompany-buttons">
        <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-save" onclick="defineCompany()">确定</a>
    </div>
    <!--所属集团-->
    <div id="dialogParent" class="easyui-dialog" style="width:400px;height:380px;padding:10px" closed="true"  >
		<table >
			#foreach($!item in $!group)
				<tr>
                <td><input #if($!supplier.PARENT_ID==$!item.SUP_ID) checked #end  type="radio" id="parentID" name="parentID" SHORTNAME="$!item.SUP_SHORTNAME" class="defineParent" value="$!item.SUP_ID"/></td>
                <td>$!item.SUP_SHORTNAME</td>
				</tr>
			#end
        </table>
    </div>
    
	<form id="frmSearch" name="frmSearch" action ="" method="post"> 
		<input type="hidden" name="SUPPLIERS_NAME" id="SUPPLIERS_NAME" value="$!supplier.SUP_NAME"/>
		<input type="hidden" name="SUP_ID" id="SUP_ID" value="$!supplier.SUP_ID"/>
		<input type="hidden" name="SP_ID" id="SP_ID" value="$!sp_id.SP_ID"/>
        <table class="table_01" cellpadding="0" cellspacing="0" >
          <tr align="left">
            <td width="2%" rowspan="45" align="center"  bgcolor="#fbfbfb" style="border-left:1;">
		 代<br/>理<br/>商<br/>基<br/>本<br/>情<br/>况
        	</td>
            <td class="text_right">经销商编号：</td>
            <td >
            	<input type="text" name="SCODE" id="SCODE" value="$!supplier.SCODE" class="easyui-validatebox" data-options="required:true" onchange="checkSupName(this,'$!supplier.SUP_ID')"><font color="red">*</font>
##            	<input type="text" id="cc" name="cc">
##            	<input type="text" id="dd" name="dd">
##            	<input type="text" id="ee" name="ee">
            </td>
            <td class="text_right">联系方式：</td>
            <td ><input type="text" name="BILL_PHONE"  id="BILL_PHONE" value="$!supplier.BILL_PHONE" ></td>
			
##        	<td class="text_right">经销商标识：</td>
##            <td ><input type="text" name="SUP_FLAG" id="SUP_FLAG" value="$!supplier.SUP_FLAG" class="easyui-validatebox" data-options="required:true"><font color="red">*</font></td>
            </tr>
            <tr>
            <td class="text_right">经销商简称：</td>
            <td ><input type="text" name="SUP_SHORTNAME" id="SUP_SHORTNAME"  value="$!supplier.SUP_SHORTNAME"  class="easyui-validatebox" data-options="required:true" onchange="checkSupName(this,'$!supplier.SUP_ID')"><font color="red">*</font></td>
        	<td  class="text_right">经销商全称：</td>
            <td ><input type="text" name="SUP_NAME" id="SUP_NAME" value="$!supplier.SUP_NAME"  class="easyui-validatebox" data-options="required:true" onchange="checkSupName(this,'$!supplier.SUP_ID')"><font color="red">*</font></td>
            </tr>
            
            <tr>
            	<td class="text_right">集团：</td>
            	<td >
	            	<input type="radio" name="SUP_TYPE" id="true" value="4" #if($!supplier.SUP_TYPE==4)checked #end  onclick="hideGroup()">是&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
	            	<input type="radio" name="SUP_TYPE" id="false" value="1" #if($!supplier.SUP_TYPE!=4)checked #end  onclick="showGroup()">否
            	</td>
            	<td class="text_right">所属集团：</td>
            	<td>
            		<input type="hidden" name="PARENT_ID" id="PARENT_ID" value="$!supplier.PARENT_ID"/>
            		<input type="text" name="PARENT_SHORTNAME"  id="PARENT_SHORTNAME" #if($!supplier.SUP_TYPE==4)disabled #end 
	            		value="#foreach($!item in $!group)#if($!supplier.PARENT_ID==$!item.SUP_ID)$!item.SUP_SHORTNAME#end#end"
						readonly onclick="openDialog('dialogParent','集团')" >
            	</td>
            </tr>
            
			<tr>
            <td class="text_right">经营产品对应厂商：</td>
            <td >
            	<input type="hidden" name="COMPANY_ID" id="COMPANY_ID" value="$!supplier.COMPANY_ID"/>
            	<input type="text" name="COMPANY_NAME" id="COMPANY_NAME" value="$!supplier.COMPANY_NAME" readonly onclick="findCompany();openDialog('dialogCompany','厂商')"  class="easyui-validatebox" #if($!supplier.SUP_TYPE==4)disabled #end #if($!supplier.SUP_TYPE!=4)data-options="required:true" #end >
            	#if($!supplier.SUP_TYPE!=4) <font id="companyRed" color="red">*</font> #end
            </td>
        	<td class="text_right">营业执照号：</td>
            <td ><input type="text" name="TAX_CODE" id="TAX_CODE" value="$!supplier.TAX_CODE" class="easyui-validatebox" data-options="required:true"><font color="red">*</font></td>
            </tr>
			<tr>
            <td class="text_right">组织机构代码：</td>
            <td><input type="text" name="ORAGNIZATION_CODE" id="ORAGNIZATION_CODE"  value="$!supplier.ORAGNIZATION_CODE"  class="easyui-validatebox" data-options="required:true"><font color="red">*</font></td>
##        	<td class="text_right">信用等级：</td>
##            <td><input type="text" name="CREDIT_GRADE" id="CREDIT_GRADE" value="$!supplier.CREDIT_GRADE"></td>
				<td class="text_right">所属行业：</td>  
            	<td ><input type="text"  name="PRO_INDUSTRY" value="$!supplier.PRO_INDUSTRY" id="PRO_INDUSTRY"  />
				</td>
            </tr>
            <tr>
        	<td class="text_right">经销商传真：</td>
            <td><input type="text" name="SUP_FAX" id="SUPPLIERS_FAX" value="$!supplier.SUP_FAX"></td>
			<td class="text_right">经销商邮编：</td>
            <td><input type="text" name="SUP_ZIP" id="SUP_ZIP" value="$!supplier.SUP_ZIP"></td>	
            </tr>
          
            <tr>
            <td class="text_right">成立日期：</td>
            <td><input type="text" name="SETUP_DATE" id="SETUP_DATE" value="$!supplier.SETUP_DATE"  class="easyui-datebox"></td>
			<td class="text_right">有效期：</td>
            <td><input type="text" name="PERIOD_VALIDITY" id="PERIOD_VALIDITY" value="$!supplier.PERIOD_VALIDITY" date="$!supplier.PERIOD_VALIDITY"   class="easyui-datebox"></td>
            </tr>
          
            <tr>
			<td class="text_right">注册资本：</td>
            <td><input type="text" name="REGISTE_CAPITAL" id="REGISTE_CAPITAL"  value="$!supplier.REGISTE_CAPITAL" size="15">(万元)</td>
            <td class="text_right">实收资本：</td>
            <td><input type="text" name="PAICLUP_CAPITAL" id="PAICLUP_CAPITAL"  value="$!supplier.PAICLUP_CAPITAL" size="15">(万元)</td>
            </tr>
          
##            <tr>
##			<td class="text_right">是否回购：</td>
##			<td ><select name="IS_REPO" id="IS_REPO">
##					<option #if($!supplier.IS_REPO==1) selected  #end value="1">是</option>
##					<option #if($!supplier.IS_REPO==0) selected  #end value="0">否</option>
##				</select>
##			</td>
			
##		  </tr>
          <tr>
            <td class="text_right">经营范围：</td>
            <td><input type="text" name="BUSINESS_RANGE" id="BUSINESS_RANGE" value="$!supplier.BUSINESS_RANGE" ></td>
            <td class="text_right">经销商网址：</td>
            <td><input type="text" name="SUP_WEBSITE" id="SUP_WEBSITE"  value="$!supplier.SUP_WEBSITE" ></td>			
         </tr>
          
         <tr>
			<td class="text_right">区域：</td>
			<td>
			   <select name="AREA_ID" id="AREA_ID" onchange="selectArea(this)">
				<option value="">-请选择-</option>
					#foreach($!area in $!allArea)
						<option value="$!area.ID" #if($!area.ID==$!supplier.AREA_ID) selected  #end>$!area.NAME
                        </option>
					#end
               </select>
			</td>
			<td class="text_right">省/直辖市：</td>
			<td >
				<select name="PROV_ID" class="eqProv" id="PROV_ID" onchange="selectProv(this)">
					<option value="">-请选择-</option>
					#foreach($!prov in $!areaProvs)
						<option value="$!prov.ID" #if($!prov.ID==$!supplier.PROV_ID) selected  #end>$!prov.NAME
                        </option>
					#end
                </select>
			</td>
          </tr>
		  
		  <tr>
            <td class="text_right">城市：</td>
			<td>
				<select name="CITY_ID" class="cityMess"  id="CITY_ID">
					<option value="" selected>-请选择-</option>
					#foreach($!city in $!provCity)
						<option value="$!city.ID" #if($!city.ID==$!supplier.CITY_ID) selected  #end> $!city.NAME
                        </option>
					#end
                </select>
			</td>
            <td  class="text_right">注册地址：</td>
            <td ><input type="text" name="BILL_ADDRESS" id="BILL_ADDRESS" value="$!supplier.BILL_ADDRESS"  class="easyui-validatebox" data-options="required:true"><font color="red">*</font></td>
         </tr> 
		 <tr>
            <td  class="text_right">开户银行：</td>
            <td ><input type="text" name="OPEN_BANK" id="OPEN_BANK" value="$!supplier.OPEN_BANK"  class="easyui-validatebox" data-options="required:true"><font color="red">*</font></td>
            <td  class="text_right">开户账号：</td>
            <td ><input type="text" name="OPEN_BANK_NUMBER" id="OPEN_BANK_NUMBER"  value="$!supplier.OPEN_BANK_NUMBER"  class="easyui-validatebox" data-options="required:true"><font color="red">*</font></td>			
         </tr>
		 
         <tr>
			<td  class="text_right">业务协定书签订日：</td>
            <td ><input type="text" name="SIGN_DATE" id="SIGN_DATE" value="$!supplier.SIGN_DATE" class="easyui-datebox"></td>
			<td class="text_right">档案协议编：</td>
			<td><input type="text" name="FILE_NUMBER" value="$!supplier.FILE_NUMBER"/> </td>	 
		 </tr>
		 <tr>
			<td  class="text_right">返佣比率：</td>
            <td><input type="text" name="COMMISSION_RATIO" value="$!supplier.COMMISSION_RATIO" >%</td>
			<td class="text_right">返佣金额：</td>
			<td><input type="text" name="COMMISSION_AMOUNT" value="$!supplier.COMMISSION_AMOUNT"/> </td>	 
		 </tr>
		 <tr>
		 	<td  class="text_right">负责人：</td>
            <td>
				<select id="AREA_MANAGER" name="AREA_MANAGER" onchange="setAreaManagerId()">
					<option value="">-请选择-</option>
					#foreach($item in $!AREA_MANAGER)
						<option value="$!item.NAME" _id="$!item.ID" #if($!supplier.AREA_MANAGER_ID==$!item.ID)selected #end>$!item.NAME</option>
					#end
				</select>
				<input type="hidden" id="AREA_MANAGER_ID" name="AREA_MANAGER_ID" value="$!supplier.AREA_MANAGER_ID">
			</td>
			<td align="right" bgcolor="#fbfbfb">采购类型：</td>
    		<td><select class="warmlegal"  name="WHETHER_SALES_SI" id="WHETHER_SALES_SI">
					<option value="">--请选择--</optinn>
    				#foreach($item in $!type.WHETHER_SALES_SI)
    				<option value="$!item.CODE" #if($!item.CODE == $!supplier.WHETHER_SALES_SI)selected#end>$!item.FLAG</option>
    				#end
    			</select>
    			<font color="red">*</font>
    		</td>
		 </tr>
		 
		 <tr>
			   <td class="text_right">所属机构：</td>
			   <td colspan="3"><input type="text"  id="SSJGNM" name="SSJGNM"  value="$!supplier.SSJGNM" style="width:800px" class="SSFGS warmlegal"/>
			   <input type="hidden" name="SSJG" id="SSJG" value="$!supplier.SSJG"/>
			  <font color="red">*</font></td>
		 </tr>
		 
         <tr>
           <td colspan ="4" align="left" class="table_th"> 纳税人资质（开票用）</td>
		 </tr>
		 <tr>
			<td  class="text_right">纳税资质：</td>
            <td >
				<select id="TAX_QUAL" name="TAX_QUAL">
					#foreach($item in $!taxQual)
					  <option value="$!item.CODE" #if($!item.CODE==$!supplier.TAX_QUAL)selected #end>$!item.FLAG</option>
					#end 
                </select>
				<font color="red">*</font>
            </td>
			<td class="text_right">纳税人识别号：</td>
			<td><input type="text" name="TAX_IDEN_NUM" value="$!supplier.TAX_IDEN_NUM"  class="easyui-validatebox" data-options="required:true"/><font color="red">*</font>
		  </td>	 
		</tr>
		<tr>
           <td colspan ="4" align="left"  class="table_th"> 经销商法人信息 </td>
		</tr>
		<tr>
           <td  class="text_right">法人姓名：</td>
           <td ><input type="text" name="SUP_LEGAL_NAME" id="SUP_LEGAL_NAME" value="$!supplier.SUP_LEGAL_NAME"  class="easyui-validatebox" data-options="required:true"><font color="red">*</font></td>
           <td class="text_right">身份证号：</td>
           <td><input type="text" name="SUP_LEGAL_IDCARD" value="$!supplier.SUP_LEGAL_IDCARD"  class="easyui-validatebox" />
           </td>	 
        </tr>
		 <tr>
			<td  class="text_right">办公电话：</td>
            <td ><input type="text" name="SUP_LEGAL_PHONE" id="SUP_LEGAL_PHONE" value="$!supplier.SUP_LEGAL_PHONE" ></td>
			<td class="text_right">手机号码：</td>
			<td><input type="text" name="SUP_LEGAL_MOBIL" value="$!supplier.SUP_LEGAL_MOBIL"/>
		  </td>	 
		 </tr>
		 <tr>
			<td  class="text_right">EMAIL：</td>
            <td colspan="3"><input type="text" name="SUB_LEGAL_EMAIL" id="SUB_LEGAL_EMAIL" value="$!supplier.SUB_LEGAL_EMAIL" ></td>
		</tr>
		<tr>
			<td class="text_right">常住地址：</td>
			<td colspan="3">
				<select name="SUB_LEGAL_PROV" id="SUB_LEGAL_PROV" onchange="getChildArea2(this.value,'SUB_LEGAL_CITY','SUB_LEGAL_AREA')">
					<option value="">--请选择--</option>
					#foreach($!item in $!getProvince)
						<option value="$!item.ID" #if($!item.ID==$!supplier.SUB_LEGAL_PROV) selected  #end>$!item.NAME</option>
					#end
				</select>
				<select name="SUB_LEGAL_CITY" id="SUB_LEGAL_CITY" onchange="getChildArea(this.value,'SUB_LEGAL_AREA')">
					<option value="">--请选择--</option>
					#foreach($!item in $!subCity)
						<option value="$!item.ID" #if($!item.ID==$!supplier.SUB_LEGAL_CITY) selected  #end>$!item.NAME</option>
					#end
				</select>
				<select name="SUB_LEGAL_AREA" id="SUB_LEGAL_AREA">
					<option value="">--请选择--</option>
					#foreach($!item in $!subArea)
						<option value="$!item.ID" #if($!item.ID==$!supplier.SUB_LEGAL_AREA) selected  #end>$!item.NAME</option>
					#end
				</select>
				<input type="text" name="SUB_LEGAL_ADDRESS" value="$!supplier.SUB_LEGAL_ADDRESS" style="width:300px;"/>
			</td>
		</tr>
		<tr>
            <td align="right" bgcolor="#fbfbfb">人物类型：</td>
            <td><select class="warmlegal" name="TYPE" id="TYPE" disabled >
					#foreach($item in $!type.list)
					<option value="$!item.CODE" #if($!item.CODE == 'LP')selected#end>$!item.FLAG</option>
					#end
				</select><font color="red">*</font>
    		</td>
    		<td align="right" bgcolor="#fbfbfb">放款方式：</td>
    		<td><select class="easyui-combobox warmlegal" name="LENDING_TYPE" id="LENDING_TYPE" data-options="multiple:true,editable:false ">
    				#foreach($item in $!type.LENDING_TYPE)
    				<option value="$!item.CODE" #if($!item.CODE == $!supplier.LENDING_TYPE)selected#end>$!item.FLAG</option>
    				#end
    			</select><font color="red">*</font>
    			
    		</td>
        </tr>
        <tr>
    	  <td align="right" bgcolor="#fbfbfb">企业性质：</td>
		  <td><select class="warmlegal" name="BUSINESS_TYPE" id="BUSINESS_TYPE"  data-options="required:true">
					<option value="">--请选择--</option>
					#foreach($item in $!type.com_typeL)
					<option value="$!item.CODE" #if($!item.CODE == $!supplierInfo.BUSINESS_TYPE)selected#end>$!item.FLAG</option>
					#end
			</select></td>
          <td align="right" bgcolor="#fbfbfb">是否对外担保：</td>
          <td colspan=""><select name="IS_GUARANTEE" id="IS_GUARANTEE">
						<option value="0" #if($!supplierInfo.IS_GUARANTEE == '0') selected="selected" #end>无</option>
    					<option value="1" #if($!supplierInfo.IS_GUARANTEE == '1') selected="selected" #end>有</option>
				</select></td>
		</tr>
        <tr>
          <td align="right" bgcolor="#fbfbfb">注册时间：</td>
          <td><input type="text" class="easyui-datebox" name="REGISTE_DATE" value="$!supplierInfo.REGISTE_DATE" tyle="width:165px"/></td> 
          <td align="right" bgcolor="#fbfbfb">注册电话(非手机号)：</td>
          <td><input type="text" name="REGISTE_PHONE"  id="REGISTE_PHONE" size="25" value="$!supplierInfo.REGISTE_PHONE" class="easyui-validatebox" onchange="isPhoneNo('REGISTE_PHONE');"></td>
        </tr>
		<tr>
			<td align="right" bgcolor="#fbfbfb">员工人数：</td>
	        <td><input type="text" name="NUMBER_PER" size="25" id="NUMBER_PER" value="$!supplierInfo.NUMBER_PER" class="validate[custom[onlyNumber]]" onchange="zpyIntNumber('NUMBER_PER');"></td>
			<td align="right" bgcolor="#fbfbfb">纳税情况：</td>
          	<td><select class="" name="RATEPAYING" id="RATEPAYING" >
						<option value="">--请选择--</option>
						#foreach($item in $!type.situation)
    					<option value="$!item.CODE" #if($!item.CODE == $!supplierInfo.RATEPAYING)selected#end >$!item.FLAG</option>
						#end
				</select></td>
        </tr>
		<tr>
		  <td align="right" bgcolor="#fbfbfb">主营业务：</td>
          <td><input type="text" name="MAIN_BUSINESS" size="25" value="$!supplierInfo.MAIN_BUSINESS"></td>
          <td align="right" bgcolor="#fbfbfb">企业规模：</td>
          <td><select class="warmlegal" name="SCALE_ENTERPRISE" id="SCALE_ENTERPRISE"  >
					<option value="">--请选择--</optinn>
					#foreach($item in $!type.SCALE_ENTERPRISE_List)
					<option value="$!item.CODE" #if($!item.CODE == $!supplierInfo.SCALE_ENTERPRISE)selected#end>$!item.FLAG</option>
					#end
			  </select>
		  </td>
        </tr>
        <tr>
          <td align="right" bgcolor="#fbfbfb">公司办公地址：</td>
          <td colspan="3">
          		<select name="WORK_PROV" id="WORK_PROV" onchange="getChildArea2(this.value,'WORK_CITY','WORK_AREA')">
					<option value="">--请选择--</option>
					#foreach($!item in $!getProvince)
						<option value="$!item.ID" #if($!item.ID == $!supplierInfo.WORK_PROV)selected#end>$!item.NAME</option>
					#end
				</select>
				<select name="WORK_CITY" id="WORK_CITY" onchange="getChildArea(this.value,'WORK_AREA')">
					<option value="">--请选择--</option>
					#foreach($!item in $!workCity)
						<option value="$!item.ID" #if($!item.ID == $!supplierInfo.WORK_CITY)selected#end>$!item.NAME</option>
					#end
				</select>
				<select name="WORK_AREA" id="WORK_AREA">
					<option value="">--请选择--</option>
					#foreach($!item in $!workArea)
						<option value="$!item.ID" #if($!item.ID == $!supplierInfo.WORK_AREA)selected#end>$!item.NAME</option>
					#end
				</select>
				<input type="text" name="WORK_ADDRESS" value="$!supplierInfo.WORK_ADDRESS" style="width:300px;">
				
          </td>
        </tr>
        <tr>
          <td align="right" bgcolor="#fbfbfb">备注：</td>
          <td colspan="5"><textarea  cols="86" rows="3" name="REMARK">$!supplierInfo.REMARK</textarea></td>
        </tr>
		
		
		<tr>
           <td colspan ="4" align="left" class="table_th"> 自有账户 </td>
		</tr>
		<tr>
			<td  class="text_right">放款单位：</td>
            <td ><input type="text" name="LOANS_OWN_UNIT" id="LOANS_OWN_UNIT" value="$!supplier.LOANS_OWN_UNIT" ></td>
			<td class="text_right">放款所在地：</td>
			<td><input type="text" name="LOANS_OWN_ADDR" value="$!supplier.LOANS_OWN_ADDR"/>
		    </td>	 
		 </tr>
		 <tr>
			<td  class="text_right">放款银行：</td>
            <td >
            	<select name="LOANS_OWN_BANK" id="LOANS_OWN_BANK" >
            		<option value="">--请选择--</option>
            		#foreach($!item in $!bank)
            		<option value="$!item.FLAG" #if($!supplier.LOANS_OWN_BANK==$!item.FLAG) selected #end>$!item.FLAG</option>
            		#end
            	</select>
            </td>
			<td class="text_right">放款账号：</td>
			<td><input type="text" name="LOANS_OWN_ACCOUNT" value="$!supplier.LOANS_OWN_ACCOUNT"/>
		  </td>	 
		 </tr>
		 <tr>
		 	<td class="text_right">支付行号：</td>
		 	<td ><input type="text" name="LOANS_OWN_PAY" value="$!supplier.LOANS_OWN_PAY"></td>
         	<td class="text_right">分支行：</td>
         	<td ><input type="text" name="BRANCH_BANK" id="BRANCH_BANK"  value="$!supplier.BRANCH_BANK" ></td>			
         </tr>
         <tr>
         	<td class="text_right">分支行省：</td>
         	<td >
         		<select name="BRANCH_BANK_PROV" id="BRANCH_BANK_PROV" onchange="selectProv1(this)">
         			<option value="">--请选择--</option>
         			#foreach($!item in $!BRANCH_BANK_PROV)
         			<option value="$!item.ID" val="$!item.ID" #if($!item.ID==$!supplier.BRANCH_BANK_PROV) selected #end>$!item.NAME</option>
         			#end
         		</select>
         	</td>			
         	<td class="text_right">分支行市：</td>
         	<td >
         		<select name="BRANCH_BANK_CITY" id="BRANCH_BANK_CITY" class="cityMess">
         			<option value="">--请选择--</option>
         			#foreach($!item in $!BRANCH_BANK_CITY)
         			<option value="$!item.ID" #if($!item.ID==$!supplier.BRANCH_BANK_CITY) selected #end>$!item.NAME</option>
         			#end
         		</select>
         	</td>
         </tr>
		 <tr>
           <td colspan ="4" align="left" class="table_th"> 共管账户</td>
		</tr>
		<tr>
			<td  class="text_right">放款单位：</td>
            <td ><input type="text" name="LOANS_TOTAL_UNIT" id="LOANS_TOTAL_UNIT" value="$!supplier.LOANS_TOTAL_UNIT" ></td>
			<td class="text_right">放款所在地：</td>
			<td><input type="text" name="LOANS_TOTAL_ADDDR" value="$!supplier.LOANS_TOTAL_ADDDR"/>
		  </td>	 
		 </tr>
		 <tr>
			<td  class="text_right">放款银行：</td>
            <td ><input type="text" name="LOANS_TOTAL_BANK" id="LOANS_TOTAL_BANK" value="$!supplier.LOANS_TOTAL_BANK" ></td>
			<td class="text_right">放款账号：</td>
			<td><input type="text" name="LOANS_TOTAL_ACCOUNT" value="$!supplier.LOANS_TOTAL_ACCOUNT"/>
		  </td>	 
		 </tr>
		 <tr>
		 	<td class="text_right">支付行号：</td>
		 	<td colspan="3"><input type="text" name="LOANS_TOTAL_PAY" value="$!supplier.LOANS_TOTAL_PAY"></td>
		 </tr>
		 <tr>
           <td colspan ="4" align="left" class="table_th">厂商账户</td>
		 </tr>
		 <tr>
			<td  class="text_right">放款单位：</td>
            <td ><input type="text" name="LOANS_COMPANY_UNIT" id="LOANS_COMPANY_UNIT" value="$!supplier.LOANS_COMPANY_UNIT" ></td>
			<td class="text_right">放款所在地：</td>
			<td><input type="text" name="LOANS_COMPANY_ADDR" value="$!supplier.LOANS_COMPANY_ADDR"/>
		  </td>	 
		  </tr>
		 <tr>
			<td  class="text_right">放款银行：</td>
            <td ><input type="text" name="LOANS_COMPANY_BANK" id="LOANS_COMPANY_BANK" value="$!supplier.LOANS_COMPANY_BANK" ></td>
			<td class="text_right">放款账号：</td>
			<td><input type="text" name="LOANS_COMPANY_ACCOUNT" value="$!supplier.LOANS_COMPANY_ACCOUNT"/>
		  </td>	 
		 </tr>
		 <tr>
		 	<td class="text_right">支付行号：</td>
		 	<td colspan="3"><input type="text" name="LOANS_COMPANY_PAY" value="$!supplier.LOANS_COMPANY_PAY"></td>
		 </tr>
         <tr>
            <td colspan="5" align="center" style="height:50px">
                <a class="easyui-linkbutton" iconCls="icon-save" onclick="saveSupplier()">保存</a>
			</td>
		 </tr>
	</table>
   </form>
   
   
   
   #if($supplier.SUP_ID)
   <table class="table_01" cellpadding="3" cellspacing="0" >
    	<tr bgcolor="#fbfbfb" >
    		<td > 联系人姓名</td>
    		<td align="left" >身份证号</td>
    		<td align="left" >办公电话</td>
    		<td align="left" >手机号码</td>
    		<td align="left" >Email</td>
    		<td align="left" >常住地址</td>
    		<td  align="center"  >相关操作&nbsp;<a href="#" class="easyui-linkbutton" iconCls="icon-add" plain="true" class="easyui-linkbutton" iconCls="icon-add" plain="true" onclick="openDialog('dialogLinkMan','添加联系人')">添加</a></td>
    	</tr>
		<tbody id="linkBody">
       #foreach($!man in $!LinkMans)
        <tr>
    		<td align="left">$!man.LINK_NAME</td>
    		<td  align="left">$!man.LINK_IDCARD</td>
    		<td  align="left">$!man.LINK_PHONE</td>
    		<td  align="left">$!man.LINK_MOBILE</td>
    		<td  align="left">$!man.LINK_EMAIL</td>
    		<td  align="left">$!man.LINK_ADDR</td>
    		<td  align="center"  >
				<a href="javascript:void(0);" class="easyui-linkbutton" iconCls="icon-remove" plain="true" link_name="$!man.LINK_NAME" onclick="deleteLinkMan(this,'$!man.LINK_ID')">删除</a> &nbsp;&nbsp
			    <a href="javascript:void(0);" class="easyui-linkbutton" iconCls="icon-edit" plain="true" LINK_NAME="$!man.LINK_NAME" IDCARD="$!man.LINK_IDCARD" PHONE="$!man.LINK_PHONE" MOBILE="$!man.LINK_MOBILE" EMAIL="$!man.LINK_EMAIL" ADDRESS="$!man.LINK_ADDR" LINK_ID="$!man.LINK_ID" onclick="updateLinkMan(this)">修改</a>
			</td>
    	</tr>
       #end 
    </tbody>
  </table>
  <table class="table_01" cellpadding="0" cellspacing="0">
        <tbody >
            <tr>
                <td align="left" colspan="8" class="table_th">投资人（个人）
				</td>
			</tr>
    		<tr bgcolor="#fbfbfb" >
    			<td align="left">姓名</td>
    			<td align="left">性别</td>
    			<td align="left">出资金额</td>
    			<td align="left">股份</td>
    			<td align="left">职务</td>
				<td align="left">身份证号</td>
				<td align="left">电话</td>
    			<td  align="center"  >相关操作&nbsp;<a href="#" class="easyui-linkbutton" iconCls="icon-add" plain="true" onclick="openDialog('dialogNatural','添加投资人(个人)')">添加</a></td>
    		</tr>
			<tbody id="naturalBody">
    	   #foreach($!natural in $!Naturals)
    	    <tr>
    			<td align="left">$!natural.INVEST_NAME</td>
    			<td  align="left">$!natural.INVEST_SEX</td>
    			<td  align="left">$!natural.INVEST_MONEY</td>
    			<td  align="left">$!natural.INVEST_STOCK</td>
    			<td  align="left">$!natural.INVEST_DUTY</td>
    			<td  align="left">$!natural.INVEST_ID_CARD</td>
				<td  align="left">$!natural.INVEST_PHONE</td>
    			<td  align="center"  >
					<a href="javascript:void(0);" class="easyui-linkbutton" iconCls="icon-remove" plain="true" onclick="deleteNatural(this,'$!natural.ID')">删除</a>&nbsp;&nbsp;
			        <a href="javascript:void(0);" class="easyui-linkbutton" iconCls="icon-edit" plain="true" PERSON_NAME="$!natural.INVEST_NAME" INVEST_SEX="$!natural.INVEST_SEX" INVEST_MONEY="$!natural.INVEST_MONEY" INVEST_STOCK="$!natural.INVEST_STOCK" INVEST_DUTY="$!natural.INVEST_DUTY" INVEST_ID_CARD="$!natural.INVEST_ID_CARD" INVEST_PHONE="$!natural.INVEST_PHONE" INVEST_ID="$!natural.ID" onclick="updateNatural(this)">修改</a>
				</td>
    		</tr>
    	   #end 
	   </tbody>
    </table>
	
	<table class="table_01" cellpadding="0" cellspacing="0" >
		<tr>
            <td align="left" colspan="8" class="table_th">  投资人（法人） 
			</td>
		</tr>
		<tr bgcolor="#fbfbfb" > 
			<td align="left">公司名称</td>
			<td align="left">法人</td>
			<td align="left">出资金额</td>
			<td align="left">股份</td>
			<td align="left">组织机构代码</td>
			<td align="left">地址</td>
			<td align="left">电话</td>
			<td  align="center"  >相关操作&nbsp;<a href="#" class="easyui-linkbutton" iconCls="icon-add" plain="true" onclick="openDialog('dialogLegal','添加投资人(法人)')">添加</a></td>
		</tr>
		<tbody id="legalBody">
	   #foreach($!legal in $!Legals)
	    <tr>
			<td align="left">$!legal.INVEST_NAME</td>
			<td  align="left">$!legal.INVEST_LEGAL_NAME</td>
			<td  align="left">$!legal.INVEST_MONEY</td>
			<td  align="left">$!legal.INVEST_STOCK</td>
			<td  align="left">$!legal.INVEST_ORG_CODE</td>
			<td  align="left">$!legal.INVEST_ADDR</td>
			<td  align="left">$!legal.INVEST_PHONE</td>
			<td  align="center"  >
				<a href="javascript:void(0);" class="easyui-linkbutton" iconCls="icon-remove" plain="true" onclick="deleteLegal(this,'$!legal.ID')">删除</a>&nbsp;&nbsp;
			    <a href="javascript:void(0);" class="easyui-linkbutton" iconCls="icon-edit" plain="true" COMPANY_NAME="$!legal.INVEST_NAME" LEGAL_NAME="$!legal.INVEST_LEGAL_NAME" INVEST_MONEY="$!legal.INVEST_MONEY" INVEST_STOCK="$!legal.INVEST_STOCK" INVEST_ORG_CODE="$!legal.INVEST_ORG_CODE" INVEST_ADDR="$!legal.INVEST_ADDR" INVEST_PHONE="$!legal.INVEST_PHONE" INVEST_ID="$!legal.ID" onclick="updateLegal(this)">修改</a>
			</td>
		</tr>
	   #end 
	   </tbody>
    </table>
    <form method="post" action="" id="OPENBANK">
       <table id='subtab-dbgrid' class="table_01" cellpadding="0" cellspacing="0" >
			<tr align="left" bgcolor="#fbfbfb">
				<td colspan="5" ><strong>上传附件信息</strong></td>
			</tr>	
            <tr>
				<td align="center">文件名称</td>
				<td align="center">文件描述</td>
                <td width="18%" align="center">相关操作：<a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-up" plain="true" onclick="openDialog('dialoguploadfile1','附件上传')"></a></td>
			</tr>
			<tbody id="tblfsg">
    	    #foreach($!file in $!files)
    		<tr>
    			<td title="$!file.FIL_NAME" align="center" >$!file.FIL_NAME</td>
    			<td title="$!file.FIL_MEMO" align="center">$!file.FIL_MEMO</td>
                <td align="center">
					<a href="Suppliers!downLoadSupFile.action?FIL_ID=$!file.FIL_ID" class="easyui-linkbutton" iconCls="icon-down" plain="true">下载</a>
                    <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-remove" plain="true" onclick="delFile($!file.FIL_ID,this)">删除</a>
				</td>
    		</tr>
    	    #end 
		    </tbody>
       </table>
    </form>
	#end
	
  
    <div id ="dialogLinkMan" class="easyui-dialog" style="width:600px;height:250px;padding:10px 20px" closed="true" buttons="#dialogLinkMan-buttons" title="添加联系人" >
    	<form method="post" id="linkManForm">
                 <table class="table_01" cellpadding="0" cellspacing="0">
            	   <tr align="center">
                        <td  class="text_right" width="20%"> 联系人姓名</td>
            			<td colspan="2" align="left" width="30%">
							<input type="hidden" name="LINK_ID" ID="LINK_ID"/>
            				<input type="text" name="LINK_NAME" id="LINK_NAME"  align="left"/>
            			</td>
            			<td  class="text_right" width="20%">
            				 身份证号：
            			</td>
            			<td colspan="3" align="left" width="30%">
            				  <input type="text" name="LINK_IDCARD" id="LINK_IDCARD" />
            			</td>
            		</tr>
            		<tr align="center">
            			<td  class="text_right">办公电话：</td>
            			<td colspan="2" align="left">
            				<input type="text" name="LINK_PHONE" id="LINK_PHONE" />
            			</td>
            			<td  class="text_right">手机号码：</td>
            			<td colspan="3" align="left">
            				<input type="text" name="LINK_MOBILE" id="LINK_MOBILE" />
            			</td>
            		</tr>
            		<tr align="center" >
            			<td class="text_right">EMAIL：</td>
            			<td colspan="2" align="left">
            				<input type="text" name="LINK_EMAIL" id="LINK_EMAIL" />
            			</td>
            			<td  class="text_right">常住地址：</td>
            			<td colspan="3" align="left">
            				<input type="text" name="LINK_ADDR" id="LINK_ADDR"  />
            			</td>
            		</tr>
            	</table>		
    		</div>
    	</form>	
    </div>
    <div id="dialogLinkMan-buttons">
        <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-save" onclick="saveLinkMan()">保存</a>
        <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-cancel" onclick="javascript:closeDialog('dialogLinkMan')">关闭</a>
    </div>
    
    <div id ="dialogNatural" class="easyui-dialog" style="width:600px;height:280px;padding:10px 20px" closed="true" buttons="#dialogNatural-buttons" title="添加投资人（个人）" >
    	<form method="post" id="invesNaturalForm">
                 <table class="table_01" cellpadding="0" cellspacing="0">
            	   <tr align="center">
            			<td  class="text_right" width="20%"> 姓名：</td>
            			<td colspan="2" align="left" width="30%">
							<input type="hidden" name="ID"/>
							<input type="hidden" name="INVEST_TYPE" value="0"/>
            				<input type="text" name="INVEST_NAME" id="INVEST_NAME"  align="left"/>
            			</td>
            			<td  class="text_right" width="20%">
            				 性别：
            			</td>
            			<td colspan="3" align="left" width="30%">
							<select name="INVEST_SEX" id ="INVEST_SEX" style="width:100px">
								<option value="男">男</option>
								<option value="女">女</option>
                            </select>
            			</td>
            		</tr>
            		<tr align="center">
            			<td  class="text_right">出资金额：</td>
            			<td colspan="2" align="left">
            				<input type="text" name="INVEST_MONEY" id="INVEST_MONEY"  onkeyup="doubleValue(this)"/>
            			</td>
            			<td  class="text_right">股份：</td>
            			<td colspan="3" align="left">
            				<input type="text" name="INVEST_STOCK" id="INVEST_STOCK" onkeyup="doubleValue(this)"/>%
            			</td>
            		</tr>
            		<tr align="center" >
            			<td class="text_right">职务：</td>
            			<td colspan="2" align="left">
            				<input type="text" name="INVEST_DUTY" id="INVEST_DUTY" />
            			</td>
            			<td  class="text_right">电话：</td>
            			<td colspan="3" align="left">
            				<input type="text" name="INVEST_PHONE" id="INVEST_PHONE" />
            			</td>
            		</tr>
					<tr align="center">
            			<td  class="text_right" width="10%">
            				 身份证号：
            			</td>
            			<td colspan="6" align="left">
            				  <input type="text" name="INVEST_ID_CARD" id="INVEST_ID_CARD"   />
            			</td>
            		</tr>
            	</table>		
    	</form>	
    </div>
	<div id="dialogNatural-buttons">
       <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-save" onclick="saveNatural()">保存</a>
       <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-cancel" onclick="javascript:closeDialog('dialogNatural')">关闭</a>
    </div>
	
    <div id ="dialogLegal" class="easyui-dialog" style="width:600px;height:280px;padding:10px 20px" closed="true" buttons="#dialogLegal-buttons" title="添加投资人（法人）" >
    	<form   method="post" id="invesLegalForm">
             <table class="table_01" cellpadding="0" cellspacing="0" >
        	   <tr align="center">
        			<td  class="text_right" width="20%">公司名称：</td>
        			<td colspan="2" align="left" width="30%">
						<input type="hidden" name="INVEST_TYPE" value="1"/>
						<input type="hidden" name="ID" />
        				<input type="text" name="INVEST_NAME"  align="left"/>
        			</td>
        			<td  class="text_right" width="20%">
        				 法人：
        			</td>
        			<td colspan="3" align="left" width="30%">
        				  <input type="text" name="INVEST_LEGAL_NAME" id="INVEST_LEGAL_NAME" />
        			</td>
        		</tr>
        		<tr align="center">
        			<td  class="text_right">出资金额：</td>
        			<td colspan="2" align="left">
        				<input type="text" name="INVEST_MONEY" onkeyup="doubleValue(this)"/>
        			</td>
        			<td  class="text_right">股份：</td>
        			<td colspan="3" align="left">
        				<input type="text" name="INVEST_STOCK" onkeyup="doubleValue(this)"/>
        			</td>
        		</tr>
        		<tr align="center" >
        			<td class="text_right">组织机构代码证：</td>
        			<td colspan="2" align="left">
        				<input type="text" name="INVEST_ORG_CODE" id="INVEST_ORG_CODE" />
        			</td>
        			<td  class="text_right">地址：</td>
        			<td colspan="3" align="left">
        				<input type="text" name="INVEST_ADDR" />
        			</td>
        		</tr>
				<tr align="center" >
        			<td class="text_right">电话：</td>
        			<td colspan="6" align="left">
        				<input type="text" name="INVEST_PHONE"  class="validate[custom[telephone]]"/>
        			</td>
        			 
        		</tr>
        	</table>		
    	</form>	
    </div>

	<div id="dialogLegal-buttons">
       <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-save" onclick="saveLegal()">保存</a>
       <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-cancel" onclick="javascript:closeDialog('dialogLegal')">关闭</a>
    </div>

    <div id ="dialoguploadfile1" class="easyui-dialog" style="width:350px;height:280px;padding:10px 20px" closed="true" buttons="#dialoguploadfile1-buttons" title="附件上传" >
    	<form  enctype="multipart/form-data"  method="post" id="fileUploadFrom">
    			<table class="table_01" border="0" cellpadding="0" cellspacing="0" width="99%" id="#table1">
    			 <tr>
    				<td align="center">文件描述:</td>
    				<td ><textarea  id="FIL_MEMO"  name="FIL_MEMO" style="width:230px"></textarea></td>
       			 </tr>
    			 <tr>
    				<td align="center">上传文件:</td>
    				<td ><input type="file" id="fileid" name="fileid"/></td>
       			 </tr>
    		    </table>
    	</form>	
    </div>
    
    <div id="dialoguploadfile1-buttons">
        <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-save" onclick="saveUpLoad()">保存</a>
        <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-cancel" onclick="javascript:closeDialog('dialoguploadfile1')">关闭</a>
    </div>
	<div class="easyui-dialog" id="addCompany_FGS" title="所属机构" modal="true" buttons="#bank_" data-options="resizable:true" closed="true" style="width:350px; height:320px;">
		<table class="table_01" cellpadding="0" cellspacing="0">
			<tr >
				<td width="80"><input type="checkbox" id="choose_fgs" >全选/反选</td>
                <td>所属机构</td>
            </tr>
			#foreach($item in $!fgs)
			<tr >
				<td><input type="checkbox"  id ="FGS_ID" name="FGS_ID" value="$item.ID"  SSFGSValue="$item.NAME" SSFGSId="$item.ID" #if($item.SSFlag) checked #end/></td>
                <td>$item.NAME</td>
			#end
			</tr>
			<tr >
                <td align="center" colspan="2">
					<a  href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-save" id="doCompany_FGS">确认</a>
					<a  href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-cancel" onclick="closeDailog('addCompany_FGS');">关闭</a>
				</td>
            </tr>
		</table>
</div>
  </body>
</html>
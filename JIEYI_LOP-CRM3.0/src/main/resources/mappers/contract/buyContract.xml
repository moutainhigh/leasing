<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN"
"http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">

<mapper namespace="buyContract">

	<select id="getBuyContractNextval" resultType="Long">
		SELECT SEQ_FIL_BUY_CONTRACT.NEXTVAL FROM DUAL
	</select>

	<!-- 通过主键ID查询买卖合同及支付表信息 -->
	<select id="getBuyContractAndFilRentPlanHeadById" parameterType="Long"
		resultType="Map">
		SELECT T1.ID,
		T1.LEASE_ORDER_CODE,
		T1.LEASE_CODE,
		T1.LESSOR_NAME,
		T1.LESSEE_NAME,
		T1.PAYLIST_CODE,
		T1.SIGN_ADDR,
		T1.IDENTIFY_DATE,
		TO_CHAR(T1.SIGN_DATE,'YYYY-MM-DD') SIGN_DATE,
		T1.MESSAGE_CODE,
		T1.CONTRACT_ID,
		T1.PRODUCT_CODE,
		T1.TOTAL,
		T1.UTOTAL,
		T1.BANK_LOAN_CONTRACT,
		T1.NON_BANK_LOAN_CONTRACT,
		T1.DOWN_PAYMENT,
		T1.DATE_TO_PULL,
		T1.DESCRIPTION_OF_GOODS,
		T1.OTHER,
		T1.OTHER_REMARK,
		T1.CONFIGURATION_NOTE_TOWE_CRA,
		T1.TOWER_CRAN_REMA,
		T1.CONCRETE_FABRIC_MACH_REM,
		T1.REMARKS_BANK_LOAN,
		T1.INSPECTION,
		T1.SELLER_COMMITMENT_UNLO_CHA,
		T1.RECEIVING_UNIT,
		T1.CARGO_COME_ADDR,
		T1.CONTACT,
		T1.CONTACT_PHONE,
		T1.CONTACT_MOBILE,
		T1.BANK_LOAN,
		TO_CHAR(T1.FIRST_PAYMENT) FIRST_PAYMENT,
		T1.FIRST_PAYMENT_DATE,
		TO_CHAR(T1.THE_BALANCE) THE_BALANCE,
		T1.BANK_MORTGAGE_LOAN_MON,
		T1.NON_BANK_LOAN,
		T1.PAYMENT_TOWER_CRAN,
		TO_CHAR(T1.FIRST_PAYMENT2) FIRST_PAYMENT2,
		T1.DAYS,
		TO_CHAR(T1.PAY_MONEY) PAY_MONEY,
		T1.DAYS2,
		T1.MI,
		TO_CHAR(T1.PAY_MONEY2) PAY_MONEY2,
		T1.DAYS3,
		T1.DAYS4,
		T1.OTHER_PAYMENT_AGRE,
		T1.OTHER_PAYMENT_AGRE_TOW,
		T1.SECURITY_WAY,
		T1.SALES_INVOICES_WAY,
		T1.SALES_TAX,
		T1.TWO_INVOICES_PROV_MAN,
		T1.SELLER_UNIT_NAME,
		T1.SELLER_UNIT_ADDR,
		T1.SELLER_LEGAL_REPR,
		T1.SELLER_AGENT,
		T1.SELLER_PHONE,
		T1.SELLER_FAX,
		T1.SELLER_BANK_ACCO,
		T1.SELLER_ACCOUNT,
		T1.SELLER_CODE,
		T1.BUYER_UNIT_NAME,
		T1.BUYER_UNIT_ADDR,
		T1.BUYER_LEGAL_REPR,
		T1.BUYER_AGENT,
		T1.BUYER_PHONE,
		T1.BUYER_FAX,
		T1.BUYER_BANK_ACCO,
		T1.BUYER_ACCOUNT,
		T1.BUYER_UNIT_TAX,
		T1.BUYER_CODE,
		T1.BUYER_ID,
		T1.BUYER_HOME_ADDR,
		T1.GUARANTOR_SIGNED,
		T1.GUARANTOR_SIGNED_SEAL,
		TO_CHAR(T1.GUARANTOR_SIGNED_SEAL_DAT,'YYYY-MM-DD') GUARANTOR_SIGNED_SEAL_DAT,
		T1.FORENSIC_AUTHORITIES_SEAL,
		TO_CHAR(T1.FORENSIC_AUTHORITIES_SEAL_DAT,'YYYY-MM-DD') FORENSIC_AUTHORITIES_SEAL_DAT,
		T1.CREATE_TIME,
		T1.TYPE,
		T1.REMARK,
		T1.MODIFY_DATE,
		T1.SUBCOMPANY ,
		T2.PLATFORM_TYPE ,
		T2.LEASE_TOPRIC ,
		T1.SELLER_PAY_BANK_ADDRESS
		FROM FIL_BUY_CONTRACT T1 , FIL_RENT_PLAN_HEAD T2 WHERE T1.PAY_ID = T2.ID
		AND T1.ID=#{ID} 
	</select>

	<!-- 通过主键ID查询买卖合同 -->
	<select id="getBuyContractById" parameterType="Long" resultType="Map">
		SELECT ID,
		LEASE_ORDER_CODE,
		LEASE_CODE,
		LESSOR_NAME,
		LESSEE_NAME,
		PAYLIST_CODE,
		SIGN_ADDR,
		IDENTIFY_DATE,
		to_char(SIGN_DATE,'YYYY-MM-DD') SIGN_DATE,
		MESSAGE_CODE,
		CONTRACT_ID,
		PRODUCT_CODE,
		TOTAL,
		UTOTAL,
		BANK_LOAN_CONTRACT,
		NON_BANK_LOAN_CONTRACT,
		DOWN_PAYMENT,
		DATE_TO_PULL,
		DESCRIPTION_OF_GOODS,
		OTHER,
		OTHER_REMARK,
		CONFIGURATION_NOTE_TOWE_CRA,
		TOWER_CRAN_REMA,
		CONCRETE_FABRIC_MACH_REM,
		REMARKS_BANK_LOAN,
		INSPECTION,
		SELLER_COMMITMENT_UNLO_CHA,
		RECEIVING_UNIT,
		CARGO_COME_ADDR,
		CONTACT,
		CONTACT_PHONE,
		CONTACT_MOBILE,
		BANK_LOAN,
		TO_CHAR(FIRST_PAYMENT) FIRST_PAYMENT,
		FIRST_PAYMENT_DATE,
		TO_CHAR(THE_BALANCE) THE_BALANCE,
		BANK_MORTGAGE_LOAN_MON,
		NON_BANK_LOAN,
		PAYMENT_TOWER_CRAN,
		TO_CHAR(FIRST_PAYMENT2) FIRST_PAYMENT2,
		DAYS,
		TO_CHAR(PAY_MONEY) PAY_MONEY,
		DAYS2,
		MI,
		TO_CHAR(PAY_MONEY2) PAY_MONEY2,
		DAYS3,
		DAYS4,
		OTHER_PAYMENT_AGRE,
		OTHER_PAYMENT_AGRE_TOW,
		SECURITY_WAY,
		SALES_INVOICES_WAY,
		SALES_TAX,
		TWO_INVOICES_PROV_MAN,
		SELLER_UNIT_NAME,
		SELLER_UNIT_ADDR,
		SELLER_LEGAL_REPR,
		SELLER_AGENT,
		SELLER_PHONE,
		SELLER_FAX,
		SELLER_BANK_ACCO,
		SELLER_ACCOUNT,
		SELLER_CODE,
		BUYER_UNIT_NAME,
		BUYER_UNIT_ADDR,
		BUYER_LEGAL_REPR,
		BUYER_AGENT,
		BUYER_PHONE,
		BUYER_FAX,
		BUYER_BANK_ACCO,
		BUYER_ACCOUNT,
		BUYER_UNIT_TAX,
		BUYER_CODE,
		BUYER_ID,
		BUYER_HOME_ADDR,
		GUARANTOR_SIGNED,
		GUARANTOR_SIGNED_SEAL,
		GUARANTOR_SIGNED_SEAL_DAT,
		to_char(FORENSIC_AUTHORITIES_SEAL,'YYYY-MM-DD') FORENSIC_AUTHORITIES_SEAL,
		to_char(FORENSIC_AUTHORITIES_SEAL_DAT,'YYYY-MM-DD')
		FORENSIC_AUTHORITIES_SEAL_DAT,
		CREATE_TIME,
		TYPE,
		REMARK,
		MODIFY_DATE,
		SUBCOMPANY
		FROM FIL_BUY_CONTRACT
		WHERE ID=#{ID}
	</select>

	<!-- 通过支付ID查询录入买卖合同相关信息 -->
	<select id="queryRentHead" parameterType="map" resultType="map">
		SELECT FCC.NAME,
		FRPH.ID,
		FRPH.PROJECT_ID,
		FRPH.LEASE_TOPRIC,
		FRPH.PAYLIST_CODE,
		FRPH.TOPRIC_SUBFIRENT,
		FRPH.YEAR_INTEREST,
		FRPH.YEAR_TYPE,
		FRPH.* ,
		FPH.FEES,
		FPH.POB_ID,
		FPH.PRO_CODE,
		FPH.PRO_NAME,
		FPH.CLIENT_ID,
		FPH.LEASE_CODE,
		TO_CHAR(FRPH.START_DATE, 'YYYY-MM-DD') START_DATE,
		FRPH.LEASE_TERM,
		FRPH.LEASE_PERIOD || TDD.FLAG LEASE_PERIOD
		FROM FIL_RENT_PLAN_HEAD FRPH,
		FIL_PROJECT_HEAD FPH,
		FIL_CUST_CLIENT FCC,
		(SELECT TSDD.FLAG, TSDD.CODE
		FROM T_SYS_DATA_DICTIONARY TSDD
		WHERE TSDD.TYPE = #{_TYPE}
		AND TSDD.STATUS = 0) TDD
		WHERE FRPH.PROJECT_ID = FPH.ID
		AND FPH.CLIENT_ID=FCC.ID
		AND FRPH.LEASE_PERIOD = TDD.CODE(+)
		AND FRPH.ID=#{ID}
	</select>

	<!-- 新增买卖合同 -->
	<insert id="insertBuyContract" parameterType="java.util.Map">
		INSERT INTO FIL_BUY_CONTRACT(
		ID
		<if test="LEASE_ORDER_CODE !=null and LEASE_ORDER_CODE !=''">,LEASE_ORDER_CODE</if>
		<if test="LEASE_CODE !=null and LEASE_CODE !=''">,LEASE_CODE</if>
		<if test="LESSOR_NAME !=null and LESSOR_NAME !=''">,LESSOR_NAME</if>
		<if test="LESSEE_NAME !=null and LESSEE_NAME !=''">,LESSEE_NAME</if>
		<if test="SIGN_ADDR !=null and SIGN_ADDR !=''">,SIGN_ADDR</if>
		<if test="IDENTIFY_DATE !=null and IDENTIFY_DATE !=''">,IDENTIFY_DATE</if>
		<if test="SIGN_DATE !=null and SIGN_DATE !=''">,SIGN_DATE</if>
		<if test="MESSAGE_CODE !=null and MESSAGE_CODE !=''">,MESSAGE_CODE</if>
		<if test="CONTRACT_ID !=null and CONTRACT_ID !=''">,CONTRACT_ID</if>
		<if test="PRODUCT_CODE !=null and PRODUCT_CODE !=''">,PRODUCT_CODE</if>
		<if test="TOTAL !=null and TOTAL !=''">,TOTAL</if>
		<if test="UTOTAL !=null and UTOTAL !=''">,UTOTAL</if>
		<if test="BANK_LOAN_CONTRACT !=null and BANK_LOAN_CONTRACT !=''">,BANK_LOAN_CONTRACT</if>
		<if test="NON_BANK_LOAN_CONTRACT !=null and NON_BANK_LOAN_CONTRACT !=''">,NON_BANK_LOAN_CONTRACT</if>
		<if test="DOWN_PAYMENT !=null and DOWN_PAYMENT !=''">,DOWN_PAYMENT</if>
		<if test="DATE_TO_PULL !=null and DATE_TO_PULL !=''">,DATE_TO_PULL</if>
		<if test="DESCRIPTION_OF_GOODS !=null and DESCRIPTION_OF_GOODS !=''">,DESCRIPTION_OF_GOODS</if>
		<if test="OTHER !=null and OTHER !=''">,OTHER</if>
		<if test="OTHER_REMARK !=null and OTHER_REMARK !=''">,OTHER_REMARK</if>
		<if
			test="CONFIGURATION_NOTE_TOWE_CRA !=null and CONFIGURATION_NOTE_TOWE_CRA !=''">,CONFIGURATION_NOTE_TOWE_CRA</if>
		<if test="TOWER_CRAN_REMA !=null and TOWER_CRAN_REMA !=''">,TOWER_CRAN_REMA</if>
		<if
			test="CONCRETE_FABRIC_MACH_REM !=null and CONCRETE_FABRIC_MACH_REM !=''">,CONCRETE_FABRIC_MACH_REM</if>
		<if test="REMARKS_BANK_LOAN !=null and REMARKS_BANK_LOAN !=''">,REMARKS_BANK_LOAN</if>
		<if test="INSPECTION !=null and INSPECTION !=''">,INSPECTION</if>
		<if
			test="SELLER_COMMITMENT_UNLO_CHA !=null and SELLER_COMMITMENT_UNLO_CHA !=''">,SELLER_COMMITMENT_UNLO_CHA</if>
		<if test="RECEIVING_UNIT !=null and RECEIVING_UNIT !=''">,RECEIVING_UNIT</if>
		<if test="CARGO_COME_ADDR !=null and CARGO_COME_ADDR !=''">,CARGO_COME_ADDR</if>
		<if test="CONTACT !=null and CONTACT !=''">,CONTACT</if>
		<if test="CONTACT_PHONE !=null and CONTACT_PHONE !=''">,CONTACT_PHONE</if>
		<if test="CONTACT_MOBILE !=null and CONTACT_MOBILE !=''">,CONTACT_MOBILE</if>
		<if test="BANK_LOAN !=null and BANK_LOAN !=''">,BANK_LOAN</if>
		<if test="FIRST_PAYMENT !=null and FIRST_PAYMENT !=''">,FIRST_PAYMENT</if>
		<if test="FIRST_PAYMENT_DATE !=null and FIRST_PAYMENT_DATE !=''">,FIRST_PAYMENT_DATE</if>
		<if test="THE_BALANCE !=null and THE_BALANCE !=''">,THE_BALANCE</if>
		<if test="BANK_MORTGAGE_LOAN_MON !=null and BANK_MORTGAGE_LOAN_MON !=''">,BANK_MORTGAGE_LOAN_MON</if>
		<if test="NON_BANK_LOAN !=null and NON_BANK_LOAN !=''">,NON_BANK_LOAN</if>
		<if test="PAYMENT_TOWER_CRAN !=null and PAYMENT_TOWER_CRAN !=''">,PAYMENT_TOWER_CRAN</if>
		<if test="FIRST_PAYMENT2 !=null and FIRST_PAYMENT2 !=''">,FIRST_PAYMENT2</if>
		<if test="DAYS !=null and DAYS !=''">,DAYS</if>
		<if test="PAY_MONEY !=null and PAY_MONEY !=''">,PAY_MONEY</if>
		<if test="DAYS2 !=null and DAYS2 !=''">,DAYS2</if>
		<if test="MI !=null and MI !=''">,MI</if>
		<if test="PAY_MONEY2 !=null and PAY_MONEY2 !=''">,PAY_MONEY2</if>
		<if test="DAYS3 !=null and DAYS3 !=''">,DAYS3</if>
		<if test="DAYS4 !=null and DAYS4 !=''">,DAYS4</if>
		<if test="OTHER_PAYMENT_AGRE !=null and OTHER_PAYMENT_AGRE !=''">,OTHER_PAYMENT_AGRE</if>
		<if test="OTHER_PAYMENT_AGRE_TOW !=null and OTHER_PAYMENT_AGRE_TOW !=''">,OTHER_PAYMENT_AGRE_TOW</if>
		<if test="SECURITY_WAY !=null and SECURITY_WAY !=''">,SECURITY_WAY</if>
		<if test="SALES_INVOICES_WAY !=null and SALES_INVOICES_WAY !=''">,SALES_INVOICES_WAY</if>
		<if test="SALES_TAX !=null and SALES_TAX !=''">,SALES_TAX</if>
		<if test="TWO_INVOICES_PROV_MAN !=null and TWO_INVOICES_PROV_MAN !=''">,TWO_INVOICES_PROV_MAN</if>
		<if test="SELLER_UNIT_NAME !=null and SELLER_UNIT_NAME !=''">,SELLER_UNIT_NAME</if>
		<if test="SELLER_UNIT_ADDR !=null and SELLER_UNIT_ADDR !=''">,SELLER_UNIT_ADDR</if>
		<if test="SELLER_LEGAL_REPR !=null and SELLER_LEGAL_REPR !=''">,SELLER_LEGAL_REPR</if>
		<if test="SELLER_AGENT !=null and SELLER_AGENT !=''">,SELLER_AGENT</if>
		<if test="SELLER_PHONE !=null and SELLER_PHONE !=''">,SELLER_PHONE</if>
		<if test="SELLER_FAX !=null and SELLER_FAX !=''">,SELLER_FAX</if>
		<if test="SELLER_BANK_ACCO !=null and SELLER_BANK_ACCO !=''">,SELLER_BANK_ACCO</if>
		<if test="SELLER_ACCOUNT !=null and SELLER_ACCOUNT !=''">,SELLER_ACCOUNT</if>
		<if test="SELLER_CODE !=null and SELLER_CODE !=''">,SELLER_CODE</if>
		<if test="BUYER_UNIT_NAME !=null and BUYER_UNIT_NAME !=''">,BUYER_UNIT_NAME</if>
		<if test="BUYER_UNIT_ADDR !=null and BUYER_UNIT_ADDR !=''">,BUYER_UNIT_ADDR</if>
		<if test="BUYER_LEGAL_REPR !=null and BUYER_LEGAL_REPR !=''">,BUYER_LEGAL_REPR</if>
		<if test="BUYER_AGENT !=null and BUYER_AGENT !=''">,BUYER_AGENT</if>
		<if test="BUYER_PHONE !=null and BUYER_PHONE !=''">,BUYER_PHONE</if>
		<if test="BUYER_FAX !=null and BUYER_FAX !=''">,BUYER_FAX</if>
		<if test="BUYER_BANK_ACCO !=null and BUYER_BANK_ACCO !=''">,BUYER_BANK_ACCO</if>
		<if test="BUYER_ACCOUNT !=null and BUYER_ACCOUNT !=''">,BUYER_ACCOUNT</if>
		<if test="BUYER_UNIT_TAX !=null and BUYER_UNIT_TAX !=''">,BUYER_UNIT_TAX</if>
		<if test="BUYER_CODE !=null and BUYER_CODE !=''">,BUYER_CODE</if>
		<if test="BUYER_ID !=null and BUYER_ID !=''">,BUYER_ID</if>
		<if test="BUYER_HOME_ADDR !=null and BUYER_HOME_ADDR !=''">,BUYER_HOME_ADDR</if>
		<if test="GUARANTOR_SIGNED !=null and GUARANTOR_SIGNED !=''">,GUARANTOR_SIGNED</if>
		<if test="GUARANTOR_SIGNED_SEAL !=null and GUARANTOR_SIGNED_SEAL !=''">,GUARANTOR_SIGNED_SEAL</if>
		<if
			test="GUARANTOR_SIGNED_SEAL_DAT !=null and GUARANTOR_SIGNED_SEAL_DAT !=''">,GUARANTOR_SIGNED_SEAL_DAT</if>
		<if
			test="FORENSIC_AUTHORITIES_SEAL !=null and FORENSIC_AUTHORITIES_SEAL !=''">,FORENSIC_AUTHORITIES_SEAL</if>
		<if
			test="FORENSIC_AUTHORITIES_SEAL_DAT !=null and FORENSIC_AUTHORITIES_SEAL_DAT !=''">,FORENSIC_AUTHORITIES_SEAL_DAT</if>
		<if test="SELLER_PAY_BANK_ADDRESS !=null and SELLER_PAY_BANK_ADDRESS !=''">,SELLER_PAY_BANK_ADDRESS</if>
		,CREATE_TIME
		<if test="TYPE !=null">,TYPE</if>
		<if test="REMARK !=null">,REMARK</if>
		<if test="MODIFY_DATE !=null">,MODIFY_DATE</if>
		<if test="SUBCOMPANY !=null">,SUBCOMPANY</if>
		<if test="PLATFORM !=null">,PLATFORM</if>
		<if test="PAY_ID !=null">,PAY_ID</if>
		<if test="PAYLIST_CODE !=null">,PAYLIST_CODE</if>
		<if test="FILE_URL !=null">,FILE_URL</if>
		<if test="STATUS !=null">,STATUS</if>
		<if test="PROJECT_ID !=null">,PROJECT_ID</if>
		<if test="SEND_DATE !=null">,SEND_DATE</if>
		)VALUES(
		#{ID}
		<if test="LEASE_ORDER_CODE !=null and LEASE_ORDER_CODE !=''">,#{LEASE_ORDER_CODE}</if>
		<if test="LEASE_CODE !=null and LEASE_CODE !=''">,#{LEASE_CODE}</if>
		<if test="LESSOR_NAME !=null and LESSOR_NAME !=''">,#{LESSOR_NAME}</if>
		<if test="LESSEE_NAME !=null and LESSEE_NAME !=''">,#{LESSEE_NAME}</if>
		<if test="SIGN_ADDR !=null and SIGN_ADDR !=''">,#{SIGN_ADDR}</if>
		<if test="IDENTIFY_DATE !=null and IDENTIFY_DATE !=''">,#{IDENTIFY_DATE}</if>
		<if test="SIGN_DATE !=null and SIGN_DATE !=''">,to_date(#{SIGN_DATE},'yyyy-mm-dd')</if>
		<if test="MESSAGE_CODE !=null and MESSAGE_CODE !=''">,#{MESSAGE_CODE}</if>
		<if test="CONTRACT_ID !=null and CONTRACT_ID !=''">,#{CONTRACT_ID}</if>
		<if test="PRODUCT_CODE !=null and PRODUCT_CODE !=''">,#{PRODUCT_CODE}</if>
		<if test="TOTAL !=null and TOTAL !=''">,#{TOTAL}</if>
		<if test="UTOTAL !=null and UTOTAL !=''">,#{UTOTAL}</if>
		<if test="BANK_LOAN_CONTRACT !=null and BANK_LOAN_CONTRACT !=''">,#{BANK_LOAN_CONTRACT}</if>
		<if test="NON_BANK_LOAN_CONTRACT !=null and NON_BANK_LOAN_CONTRACT !=''">,#{NON_BANK_LOAN_CONTRACT}</if>
		<if test="DOWN_PAYMENT !=null and DOWN_PAYMENT !=''">,#{DOWN_PAYMENT}</if>
		<if test="DATE_TO_PULL !=null and DATE_TO_PULL !=''">,#{DATE_TO_PULL}</if>
		<if test="DESCRIPTION_OF_GOODS !=null and DESCRIPTION_OF_GOODS !=''">,#{DESCRIPTION_OF_GOODS}</if>
		<if test="OTHER !=null and OTHER !=''">,#{OTHER}</if>
		<if test="OTHER_REMARK !=null and OTHER_REMARK !=''">,#{OTHER_REMARK}</if>
		<if
			test="CONFIGURATION_NOTE_TOWE_CRA !=null and CONFIGURATION_NOTE_TOWE_CRA !=''">,#{CONFIGURATION_NOTE_TOWE_CRA}</if>
		<if test="TOWER_CRAN_REMA !=null and TOWER_CRAN_REMA !=''">,#{TOWER_CRAN_REMA}</if>
		<if
			test="CONCRETE_FABRIC_MACH_REM !=null and CONCRETE_FABRIC_MACH_REM !=''">,#{CONCRETE_FABRIC_MACH_REM}</if>
		<if test="REMARKS_BANK_LOAN !=null and REMARKS_BANK_LOAN !=''">,#{REMARKS_BANK_LOAN}</if>
		<if test="INSPECTION !=null and INSPECTION !=''">,#{INSPECTION}</if>
		<if
			test="SELLER_COMMITMENT_UNLO_CHA !=null and SELLER_COMMITMENT_UNLO_CHA !=''">,#{SELLER_COMMITMENT_UNLO_CHA}</if>
		<if test="RECEIVING_UNIT !=null and RECEIVING_UNIT !=''">,#{RECEIVING_UNIT}</if>
		<if test="CARGO_COME_ADDR !=null and CARGO_COME_ADDR !=''">,#{CARGO_COME_ADDR}</if>
		<if test="CONTACT !=null and CONTACT !=''">,#{CONTACT}</if>
		<if test="CONTACT_PHONE !=null and CONTACT_PHONE !=''">,#{CONTACT_PHONE}</if>
		<if test="CONTACT_MOBILE !=null and CONTACT_MOBILE !=''">,#{CONTACT_MOBILE}</if>
		<if test="BANK_LOAN !=null and BANK_LOAN !=''">,#{BANK_LOAN}</if>
		<if test="FIRST_PAYMENT !=null and FIRST_PAYMENT !=''">,#{FIRST_PAYMENT}</if>
		<if test="FIRST_PAYMENT_DATE !=null and FIRST_PAYMENT_DATE !=''">,#{FIRST_PAYMENT_DATE}</if>
		<if test="THE_BALANCE !=null and THE_BALANCE !=''">,#{THE_BALANCE}</if>
		<if test="BANK_MORTGAGE_LOAN_MON !=null and BANK_MORTGAGE_LOAN_MON !=''">,#{BANK_MORTGAGE_LOAN_MON}</if>
		<if test="NON_BANK_LOAN !=null and NON_BANK_LOAN !=''">,#{NON_BANK_LOAN}</if>
		<if test="PAYMENT_TOWER_CRAN !=null and PAYMENT_TOWER_CRAN !=''">,#{PAYMENT_TOWER_CRAN}</if>
		<if test="FIRST_PAYMENT2 !=null and FIRST_PAYMENT2 !=''">,#{FIRST_PAYMENT2}</if>
		<if test="DAYS !=null and DAYS !=''">,#{DAYS}</if>
		<if test="PAY_MONEY !=null and PAY_MONEY !=''">,#{PAY_MONEY}</if>
		<if test="DAYS2 !=null and DAYS2 !=''">,#{DAYS2}</if>
		<if test="MI !=null and MI !=''">,#{MI}</if>
		<if test="PAY_MONEY2 !=null and PAY_MONEY2 !=''">,#{PAY_MONEY2}</if>
		<if test="DAYS3 !=null and DAYS3 !=''">,#{DAYS3}</if>
		<if test="DAYS4 !=null and DAYS4 !=''">,#{DAYS4}</if>
		<if test="OTHER_PAYMENT_AGRE !=null and OTHER_PAYMENT_AGRE !=''">,#{OTHER_PAYMENT_AGRE}</if>
		<if test="OTHER_PAYMENT_AGRE_TOW !=null and OTHER_PAYMENT_AGRE_TOW !=''">,#{OTHER_PAYMENT_AGRE_TOW}</if>
		<if test="SECURITY_WAY !=null and SECURITY_WAY !=''">,#{SECURITY_WAY}</if>
		<if test="SALES_INVOICES_WAY !=null and SALES_INVOICES_WAY !=''">,#{SALES_INVOICES_WAY}</if>
		<if test="SALES_TAX !=null and SALES_TAX !=''">,#{SALES_TAX}</if>
		<if test="TWO_INVOICES_PROV_MAN !=null and TWO_INVOICES_PROV_MAN !=''">,#{TWO_INVOICES_PROV_MAN}</if>
		<if test="SELLER_UNIT_NAME !=null and SELLER_UNIT_NAME !=''">,#{SELLER_UNIT_NAME}</if>
		<if test="SELLER_UNIT_ADDR !=null and SELLER_UNIT_ADDR !=''">,#{SELLER_UNIT_ADDR}</if>
		<if test="SELLER_LEGAL_REPR !=null and SELLER_LEGAL_REPR !=''">,#{SELLER_LEGAL_REPR}</if>
		<if test="SELLER_AGENT !=null and SELLER_AGENT !=''">,#{SELLER_AGENT}</if>
		<if test="SELLER_PHONE !=null and SELLER_PHONE !=''">,#{SELLER_PHONE}</if>
		<if test="SELLER_FAX !=null and SELLER_FAX !=''">,#{SELLER_FAX}</if>
		<if test="SELLER_BANK_ACCO !=null and SELLER_BANK_ACCO !=''">,#{SELLER_BANK_ACCO}</if>
		<if test="SELLER_ACCOUNT !=null and SELLER_ACCOUNT !=''">,#{SELLER_ACCOUNT}</if>
		<if test="SELLER_CODE !=null and SELLER_CODE !=''">,#{SELLER_CODE}</if>
		<if test="BUYER_UNIT_NAME !=null and BUYER_UNIT_NAME !=''">,#{BUYER_UNIT_NAME}</if>
		<if test="BUYER_UNIT_ADDR !=null and BUYER_UNIT_ADDR !=''">,#{BUYER_UNIT_ADDR}</if>
		<if test="BUYER_LEGAL_REPR !=null and BUYER_LEGAL_REPR !=''">,#{BUYER_LEGAL_REPR}</if>
		<if test="BUYER_AGENT !=null and BUYER_AGENT !=''">,#{BUYER_AGENT}</if>
		<if test="BUYER_PHONE !=null and BUYER_PHONE !=''">,#{BUYER_PHONE}</if>
		<if test="BUYER_FAX !=null and BUYER_FAX !=''">,#{BUYER_FAX}</if>
		<if test="BUYER_BANK_ACCO !=null and BUYER_BANK_ACCO !=''">,#{BUYER_BANK_ACCO}</if>
		<if test="BUYER_ACCOUNT !=null and BUYER_ACCOUNT !=''">,#{BUYER_ACCOUNT}</if>
		<if test="BUYER_UNIT_TAX !=null and BUYER_UNIT_TAX !=''">,#{BUYER_UNIT_TAX}</if>
		<if test="BUYER_CODE !=null and BUYER_CODE !=''">,#{BUYER_CODE}</if>
		<if test="BUYER_ID !=null and BUYER_ID !=''">,#{BUYER_ID}</if>
		<if test="BUYER_HOME_ADDR !=null and BUYER_HOME_ADDR !=''">,#{BUYER_HOME_ADDR}</if>
		<if test="GUARANTOR_SIGNED !=null and GUARANTOR_SIGNED !=''">,#{GUARANTOR_SIGNED}</if>
		<if test="GUARANTOR_SIGNED_SEAL !=null and GUARANTOR_SIGNED_SEAL !=''">,#{GUARANTOR_SIGNED_SEAL}</if>
		<if
			test="GUARANTOR_SIGNED_SEAL_DAT !=null and GUARANTOR_SIGNED_SEAL_DAT !=''">,to_date(#{GUARANTOR_SIGNED_SEAL_DAT},'yyyy-MM-dd')</if>
		<if
			test="FORENSIC_AUTHORITIES_SEAL !=null and FORENSIC_AUTHORITIES_SEAL !=''">,#{FORENSIC_AUTHORITIES_SEAL}</if>
		<if
			test="FORENSIC_AUTHORITIES_SEAL_DAT !=null and FORENSIC_AUTHORITIES_SEAL_DAT !=''">,to_date(#{FORENSIC_AUTHORITIES_SEAL_DAT},'yyyy-MM-dd')</if>
		<if test="SELLER_PAY_BANK_ADDRESS !=null and SELLER_PAY_BANK_ADDRESS !=''">,#{SELLER_PAY_BANK_ADDRESS}</if>
		,SYSDATE
		<if test="TYPE !=null">,#{TYPE}</if>
		<if test="REMARK !=null">,#{REMARK}</if>
		<if test="MODIFY_DATE !=null">,#{MODIFY_DATE}</if>
		<if test="SUBCOMPANY !=null">,#{SUBCOMPANY}</if>
		<if test="PLATFORM !=null">,#{PLATFORM}</if>
		<if test="PAY_ID !=null">,#{PAY_ID}</if>
		<if test="PAYLIST_CODE !=null">,#{PAYLIST_CODE}</if>
		<if test="FILE_URL !=null">,#{FILE_URL}</if>
		<if test="STATUS !=null">,#{STATUS}</if>
		<if test="PROJECT_ID !=null">,#{PROJECT_ID}</if>
		<if test="SEND_DATE !=null">,#{SEND_DATE}</if>
		)
	</insert>

	<!-- 查询全部买卖合同信息 (分页) -->
	<select id="getAllBuyContract" parameterType="java.util.Map"
		resultType="java.util.Map">
		SELECT * FROM (SELECT CC.*,ROWNUM ROWNO FROM (
		SELECT FBC.ID,
		FBC.LEASE_ORDER_CODE,
		FBC.LEASE_CODE,
		FBC.LESSOR_NAME,
		FBC.LESSEE_NAME,
		FBC.SIGN_ADDR,
		FBC.IDENTIFY_DATE,
		TO_CHAR(FBC.SIGN_DATE, 'YYYY-MM-DD') SIGN_DATE,
		FBC.MESSAGE_CODE,
		FBC.CONTRACT_ID,
		FBC.PRODUCT_CODE,
		FBC.TOTAL,
		FBC.UTOTAL,
		FBC.BANK_LOAN_CONTRACT,
		FBC.NON_BANK_LOAN_CONTRACT,
		FBC.DOWN_PAYMENT,
		FBC.DATE_TO_PULL,
		FBC.DESCRIPTION_OF_GOODS,
		FBC.OTHER,
		FBC.OTHER_REMARK,
		FBC.CONFIGURATION_NOTE_TOWE_CRA,
		FBC.TOWER_CRAN_REMA,
		FBC.CONCRETE_FABRIC_MACH_REM,
		FBC.REMARKS_BANK_LOAN,
		FBC.INSPECTION,
		FBC.SELLER_COMMITMENT_UNLO_CHA,
		FBC.RECEIVING_UNIT,
		FBC.CARGO_COME_ADDR,
		FBC.CONTACT,
		FBC.CONTACT_PHONE,
		FBC.CONTACT_MOBILE,
		FBC.BANK_LOAN,
		TO_CHAR(FBC.FIRST_PAYMENT) FIRST_PAYMENT,
		FBC.FIRST_PAYMENT_DATE,
		TO_CHAR(FBC.THE_BALANCE) THE_BALANCE,
		FBC.BANK_MORTGAGE_LOAN_MON,
		FBC.NON_BANK_LOAN,
		FBC.PAYMENT_TOWER_CRAN,
		TO_CHAR(FBC.FIRST_PAYMENT2) FIRST_PAYMENT2,
		FBC.DAYS,
		TO_CHAR(FBC.PAY_MONEY) PAY_MONEY,
		FBC.DAYS2,
		FBC.MI,
		TO_CHAR(FBC.PAY_MONEY2) PAY_MONEY2,
		FBC.DAYS3,
		FBC.DAYS4,
		FBC.OTHER_PAYMENT_AGRE,
		FBC.OTHER_PAYMENT_AGRE_TOW,
		FBC.SECURITY_WAY,
		FBC.SALES_INVOICES_WAY,
		FBC.SALES_TAX,
		FBC.TWO_INVOICES_PROV_MAN,
		FBC.SELLER_UNIT_NAME,
		FBC.SELLER_UNIT_ADDR,
		FBC.SELLER_LEGAL_REPR,
		FBC.SELLER_AGENT,
		FBC.SELLER_PHONE,
		FBC.SELLER_FAX,
		FBC.SELLER_BANK_ACCO,
		FBC.SELLER_ACCOUNT,
		FBC.SELLER_CODE,
		FBC.BUYER_UNIT_NAME,
		FBC.BUYER_UNIT_ADDR,
		FBC.BUYER_LEGAL_REPR,
		FBC.BUYER_AGENT,
		FBC.BUYER_PHONE,
		FBC.BUYER_FAX,
		FBC.BUYER_BANK_ACCO,
		FBC.BUYER_ACCOUNT,
		FBC.BUYER_UNIT_TAX,
		FBC.BUYER_CODE,
		FBC.BUYER_ID,
		FBC.BUYER_HOME_ADDR,
		FBC.GUARANTOR_SIGNED,
		FBC.GUARANTOR_SIGNED_SEAL,
		FBC.GUARANTOR_SIGNED_SEAL_DAT,
		FBC.FORENSIC_AUTHORITIES_SEAL,
		TO_CHAR(FBC.FORENSIC_AUTHORITIES_SEAL_DAT, 'YYYY-MM-DD') FORENSIC_AUTHORITIES_SEAL_DAT,
		FBC.CREATE_TIME,
		FBC.TYPE,
		FBC.REMARK,
		FBC.MODIFY_DATE,
		FBC.SUBCOMPANY,
		FBC.STATUS,
		FRPH.PLATFORM_TYPE,
		FRPH.COMPANY_NAME,
		FCC.NAME CUST_SIGN_NAME,
		FCC.ID CUST_SIGN_ID,
		TSS.SUP_NAME
		FROM FIL_BUY_CONTRACT FBC
		LEFT JOIN FIL_RENT_PLAN_HEAD FRPH ON FBC.PAY_ID = FRPH.ID
		LEFT JOIN FIL_PROJECT_HEAD FPH ON FPH.ID = FBC.PROJECT_ID
		LEFT JOIN T_SYS_SUPPLIERS TSS ON TSS.SUP_ID = FRPH.SUP_ID
		LEFT JOIN FIL_CUST_CLIENT FCC ON FPH.CLIENT_ID = FCC.ID
		<where>
			FBC.LEASE_ORDER_CODE is not null
			<!-- 出卖人  -->
			<if test="LESSOR_NAME!=null and LESSOR_NAME!='' ">AND
				FBC.LESSOR_NAME=#{LESSOR_NAME}</if>
			<!-- 出卖人电话 -->
			<if test="SELLER_PHONE!=null and SELLER_PHONE!=''">AND FBC.SELLER_PHONE=#{SELLER_PHONE}</if>
			<!-- 买受人 -->
			<if test="LESSEE_NAME!=null and LESSEE_NAME!='' ">AND FBC.LESSEE_NAME=#{LESSEE_NAME}</if>
			<!-- 承租人的姓名   取客户管理表 名字-->
			<if test="CUST_SIGN_NAME!=null and CUST_SIGN_NAME!='' ">AND FCC.NAME=#{CUST_SIGN_NAME}</if>
			<!-- 融资租赁合同号 -->
			<if test="LEASE_CODE!=null and LEASE_CODE!=''">AND FBC.LEASE_CODE=#{LEASE_CODE}</if>
			<!-- 买卖合同编号 -->
			<if test="PRODUCT_CODE!=null and PRODUCT_CODE!=''">AND FBC.PRODUCT_CODE=#{PRODUCT_CODE}</if>
			<!-- 行业类型 -->
			<if test="PLATFORM_TYPE!=null and PLATFORM_TYPE!=''">AND FRPH.PLATFORM_TYPE=#{PLATFORM_TYPE}</if>
			<!-- 厂商    是不是就是制造师-->
			<if test="COMPANY_NAME!=null and COMPANY_NAME!=''">AND FRPH.COMPANY_NAME=#{COMPANY_NAME}</if>
			<!-- 供应商  是不是就是供应商,是不是就是出卖人-->
			<if test="SUP_NAME!=null and SUP_NAME!=''">AND TSS.SUP_NAME=#{SUP_NAME}</if>
		</where>
		) CC ORDER BY CC.CREATE_TIME DESC) CCC WHERE CCC.ROWNO BETWEEN
		#{PAGE_BEGIN} AND #{PAGE_END}
	</select>

	<!-- 查询买卖合同总记录数(分页) -->
	<select id="getAllBuyContract_count" parameterType="java.util.Map"
		resultType="int">
		SELECT COUNT(1) from (
		SELECT FBC.ID,
		FBC.LEASE_ORDER_CODE,
		FBC.LEASE_CODE,
		FBC.LESSOR_NAME,
		FBC.LESSEE_NAME,
		FBC.SIGN_ADDR,
		FBC.IDENTIFY_DATE,
		TO_CHAR(FBC.SIGN_DATE, 'YYYY-MM-DD') SIGN_DATE,
		FBC.MESSAGE_CODE,
		FBC.CONTRACT_ID,
		FBC.PRODUCT_CODE,
		FBC.TOTAL,
		FBC.UTOTAL,
		FBC.BANK_LOAN_CONTRACT,
		FBC.NON_BANK_LOAN_CONTRACT,
		FBC.DOWN_PAYMENT,
		FBC.DATE_TO_PULL,
		FBC.DESCRIPTION_OF_GOODS,
		FBC.OTHER,
		FBC.OTHER_REMARK,
		FBC.CONFIGURATION_NOTE_TOWE_CRA,
		FBC.TOWER_CRAN_REMA,
		FBC.CONCRETE_FABRIC_MACH_REM,
		FBC.REMARKS_BANK_LOAN,
		FBC.INSPECTION,
		FBC.SELLER_COMMITMENT_UNLO_CHA,
		FBC.RECEIVING_UNIT,
		FBC.CARGO_COME_ADDR,
		FBC.CONTACT,
		FBC.CONTACT_PHONE,
		FBC.CONTACT_MOBILE,
		FBC.BANK_LOAN,
		TO_CHAR(FBC.FIRST_PAYMENT) FIRST_PAYMENT,
		FBC.FIRST_PAYMENT_DATE,
		TO_CHAR(FBC.THE_BALANCE) THE_BALANCE,
		FBC.BANK_MORTGAGE_LOAN_MON,
		FBC.NON_BANK_LOAN,
		FBC.PAYMENT_TOWER_CRAN,
		TO_CHAR(FBC.FIRST_PAYMENT2) FIRST_PAYMENT2,
		FBC.DAYS,
		TO_CHAR(FBC.PAY_MONEY) PAY_MONEY,
		FBC.DAYS2,
		FBC.MI,
		TO_CHAR(FBC.PAY_MONEY2) PAY_MONEY2,
		FBC.DAYS3,
		FBC.DAYS4,
		FBC.OTHER_PAYMENT_AGRE,
		FBC.OTHER_PAYMENT_AGRE_TOW,
		FBC.SECURITY_WAY,
		FBC.SALES_INVOICES_WAY,
		FBC.SALES_TAX,
		FBC.TWO_INVOICES_PROV_MAN,
		FBC.SELLER_UNIT_NAME,
		FBC.SELLER_UNIT_ADDR,
		FBC.SELLER_LEGAL_REPR,
		FBC.SELLER_AGENT,
		FBC.SELLER_PHONE,
		FBC.SELLER_FAX,
		FBC.SELLER_BANK_ACCO,
		FBC.SELLER_ACCOUNT,
		FBC.SELLER_CODE,
		FBC.BUYER_UNIT_NAME,
		FBC.BUYER_UNIT_ADDR,
		FBC.BUYER_LEGAL_REPR,
		FBC.BUYER_AGENT,
		FBC.BUYER_PHONE,
		FBC.BUYER_FAX,
		FBC.BUYER_BANK_ACCO,
		FBC.BUYER_ACCOUNT,
		FBC.BUYER_UNIT_TAX,
		FBC.BUYER_CODE,
		FBC.BUYER_ID,
		FBC.BUYER_HOME_ADDR,
		FBC.GUARANTOR_SIGNED,
		FBC.GUARANTOR_SIGNED_SEAL,
		FBC.GUARANTOR_SIGNED_SEAL_DAT,
		FBC.FORENSIC_AUTHORITIES_SEAL,
		TO_CHAR(FBC.FORENSIC_AUTHORITIES_SEAL_DAT, 'YYYY-MM-DD') FORENSIC_AUTHORITIES_SEAL_DAT,
		FBC.CREATE_TIME,
		FBC.TYPE,
		FBC.REMARK,
		FBC.MODIFY_DATE,
		FBC.SUBCOMPANY,
		FBC.STATUS,
		FRPH.PLATFORM_TYPE,
		FRPH.COMPANY_NAME,
		FCC.NAME CUST_SIGN_NAME,
		TSS.SUP_NAME
		FROM FIL_BUY_CONTRACT FBC
		LEFT JOIN FIL_RENT_PLAN_HEAD FRPH ON FBC.PAY_ID = FRPH.ID
		LEFT JOIN FIL_PROJECT_HEAD FPH ON FPH.ID = FBC.PROJECT_ID
		LEFT JOIN T_SYS_SUPPLIERS TSS ON TSS.SUP_ID = FRPH.SUP_ID
		LEFT JOIN FIL_CUST_CLIENT FCC ON FPH.CLIENT_ID = FCC.ID
		<where>
			FBC.LEASE_ORDER_CODE is not null
			<!-- 出卖人  -->
			<if test="LESSOR_NAME!=null and LESSOR_NAME!='' ">AND
				FBC.LESSOR_NAME=#{LESSOR_NAME}</if>
			<!-- 出卖人电话 -->
			<if test="SELLER_PHONE!=null and SELLER_PHONE!=''">AND FBC.SELLER_PHONE=#{SELLER_PHONE}</if>
			<!-- 买受人 -->
			<if test="LESSEE_NAME!=null and LESSEE_NAME!='' ">AND FBC.LESSEE_NAME=#{LESSEE_NAME}</if>
			<!-- 承租人的姓名   取项目主表中的承租人签字姓名-->
			<if test="CUST_SIGN_NAME!=null and CUST_SIGN_NAME!='' ">AND FCC.NAME=#{CUST_SIGN_NAME}</if>
			<!-- 融资租赁合同号 -->
			<if test="LEASE_CODE!=null and LEASE_CODE!=''">AND FBC.LEASE_CODE=#{LEASE_CODE}</if>
			<!-- 买卖合同编号 -->
			<if test="PRODUCT_CODE!=null and PRODUCT_CODE!=''">AND FBC.PRODUCT_CODE=#{PRODUCT_CODE}</if>
			<!-- 行业类型 -->
			<if test="PLATFORM_TYPE!=null and PLATFORM_TYPE!=''">AND FRPH.PLATFORM_TYPE=#{PLATFORM_TYPE}</if>
			<!-- 厂商    是不是就是制造师-->
			<if test="COMPANY_NAME!=null and COMPANY_NAME!=''">AND FRPH.COMPANY_NAME=#{COMPANY_NAME}</if>
			<!-- 供应商  是不是就是供应商,是不是就是出卖人-->
			<if test="SUP_NAME!=null and SUP_NAME!=''">AND TSS.SUP_NAME=#{SUP_NAME}</if>
		</where>
		)

	</select>


	<!-- 买卖合同修改 -->
	<update id="updateBuyContract" parameterType="java.util.Map">
		UPDATE FIL_BUY_CONTRACT SET
		MODIFY_DATE= SYSDATE
		<if test="LEASE_ORDER_CODE !=null and LEASE_ORDER_CODE !=''">,LEASE_ORDER_CODE=#{LEASE_ORDER_CODE}
		</if>
		<if test="LEASE_CODE !=null and LEASE_CODE !=''">,LEASE_CODE=#{LEASE_CODE}</if>
		<if test="LESSOR_NAME !=null and LESSOR_NAME !=''">,LESSOR_NAME=#{LESSOR_NAME}</if>
		<if test="LESSEE_NAME !=null and LESSEE_NAME !=''">,LESSEE_NAME=#{LESSEE_NAME}</if>
		<if test="SIGN_ADDR !=null and SIGN_ADDR !=''">,SIGN_ADDR=#{SIGN_ADDR}</if>
		<if test="IDENTIFY_DATE !=null and IDENTIFY_DATE !=''">IDENTIFY_DATE=TO_DATE(#{IDENTIFY_DATE},'yyyy-mm-dd')</if>
		<if test="SIGN_DATE !=null and SIGN_DATE !=''">,SIGN_DATE=TO_DATE(#{SIGN_DATE},'yyyy-mm-dd')</if>
		<if test="MESSAGE_CODE !=null and MESSAGE_CODE !=''">,MESSAGE_CODE=#{MESSAGE_CODE}</if>
		<if test="CONTRACT_ID !=null and CONTRACT_ID !=''">,CONTRACT_ID=#{CONTRACT_ID}</if>
		<if test="PRODUCT_CODE !=null and PRODUCT_CODE !=''">,PRODUCT_CODE=#{PRODUCT_CODE}</if>
		<if test="TOTAL !=null and TOTAL !=''">,TOTAL=#{TOTAL}</if>
		<if test="UTOTAL !=null and UTOTAL !=''">,UTOTAL=#{UTOTAL}</if>
		<if test="BANK_LOAN_CONTRACT !=null and BANK_LOAN_CONTRACT !=''">,BANK_LOAN_CONTRACT=#{BANK_LOAN_CONTRACT}</if>
		<if test="NON_BANK_LOAN_CONTRACT !=null and NON_BANK_LOAN_CONTRACT !=''">,NON_BANK_LOAN_CONTRACT=#{NON_BANK_LOAN_CONTRACT}</if>
		<if test="DOWN_PAYMENT !=null and DOWN_PAYMENT !=''">,DOWN_PAYMENT=#{DOWN_PAYMENT}</if>
		<if test="DATE_TO_PULL !=null and DATE_TO_PULL !=''">,DATE_TO_PULL=#{DATE_TO_PULL}</if>
		<if test="DESCRIPTION_OF_GOODS !=null and DESCRIPTION_OF_GOODS !=''">,DESCRIPTION_OF_GOODS=#{DESCRIPTION_OF_GOODS}</if>
		<if test="OTHER !=null and OTHER !=''">,OTHER=#{OTHER}</if>
		<if test="OTHER_REMARK !=null and OTHER_REMARK !=''">,OTHER_REMARK=#{OTHER_REMARK}</if>
		<if
			test="CONFIGURATION_NOTE_TOWE_CRA !=null and CONFIGURATION_NOTE_TOWE_CRA !=''">,CONFIGURATION_NOTE_TOWE_CRA=#{CONFIGURATION_NOTE_TOWE_CRA}</if>
		<if test="TOWER_CRAN_REMA !=null and TOWER_CRAN_REMA !=''">,TOWER_CRAN_REMA=#{TOWER_CRAN_REMA}</if>
		<if
			test="CONCRETE_FABRIC_MACH_REM !=null and CONCRETE_FABRIC_MACH_REM !=''">,CONCRETE_FABRIC_MACH_REM=#{CONCRETE_FABRIC_MACH_REM}</if>
		<if test="REMARKS_BANK_LOAN !=null and REMARKS_BANK_LOAN !=''">,REMARKS_BANK_LOAN=#{REMARKS_BANK_LOAN}</if>
		<if test="INSPECTION !=null and INSPECTION !=''">,INSPECTION=#{INSPECTION}</if>
		<if
			test="SELLER_COMMITMENT_UNLO_CHA !=null and SELLER_COMMITMENT_UNLO_CHA !=''">,SELLER_COMMITMENT_UNLO_CHA=#{SELLER_COMMITMENT_UNLO_CHA}</if>
		<if test="RECEIVING_UNIT !=null and RECEIVING_UNIT !=''">,RECEIVING_UNIT=#{RECEIVING_UNIT}</if>
		<if test="CARGO_COME_ADDR !=null and CARGO_COME_ADDR !=''">,CARGO_COME_ADDR=#{CARGO_COME_ADDR}</if>
		<if test="CONTACT !=null and CONTACT !=''">,CONTACT=#{CONTACT}</if>
		<if test="CONTACT_PHONE !=null and CONTACT_PHONE !=''">,CONTACT_PHONE=#{CONTACT_PHONE}</if>
		<if test="CONTACT_MOBILE !=null and CONTACT_MOBILE !=''">,CONTACT_MOBILE=#{CONTACT_MOBILE}</if>
		<if test="BANK_LOAN !=null and BANK_LOAN !=''">,BANK_LOAN=#{BANK_LOAN}</if>
		<if test="FIRST_PAYMENT !=null and FIRST_PAYMENT !=''">,FIRST_PAYMENT=#{FIRST_PAYMENT}</if>
		<if test="FIRST_PAYMENT_DATE !=null and FIRST_PAYMENT_DATE !=''">,FIRST_PAYMENT_DATE=#{FIRST_PAYMENT_DATE}</if>
		<if test="THE_BALANCE !=null and THE_BALANCE !=''">,THE_BALANCE=#{THE_BALANCE}</if>
		<if test="BANK_MORTGAGE_LOAN_MON !=null and BANK_MORTGAGE_LOAN_MON !=''">,BANK_MORTGAGE_LOAN_MON=#{BANK_MORTGAGE_LOAN_MON}</if>
		<if test="NON_BANK_LOAN !=null and NON_BANK_LOAN !=''">,NON_BANK_LOAN=#{NON_BANK_LOAN}</if>
		<if test="PAYMENT_TOWER_CRAN !=null and PAYMENT_TOWER_CRAN !=''">,PAYMENT_TOWER_CRAN=#{PAYMENT_TOWER_CRAN}</if>
		<if test="FIRST_PAYMENT2 !=null and FIRST_PAYMENT2 !=''">,FIRST_PAYMENT2=#{FIRST_PAYMENT2}</if>
		<if test="DAYS !=null and DAYS !=''">,DAYS=#{DAYS}</if>
		<if test="PAY_MONEY !=null and PAY_MONEY !=''">,PAY_MONEY=#{PAY_MONEY}</if>
		<if test="DAYS2 !=null and DAYS2 !=''">,DAYS2=#{DAYS2}</if>
		<if test="MI !=null and MI !=''">,MI=#{MI}</if>
		<if test="PAY_MONEY2 !=null and PAY_MONEY2 !=''">,PAY_MONEY2=#{PAY_MONEY2}</if>
		<if test="DAYS3 !=null and DAYS3 !=''">,DAYS3=#{DAYS3}</if>
		<if test="DAYS4 !=null and DAYS4 !=''">,DAYS4=#{DAYS4}</if>
		<if test="OTHER_PAYMENT_AGRE !=null and OTHER_PAYMENT_AGRE !=''">,OTHER_PAYMENT_AGRE=#{OTHER_PAYMENT_AGRE}</if>
		<if test="OTHER_PAYMENT_AGRE_TOW !=null and OTHER_PAYMENT_AGRE_TOW !=''">,OTHER_PAYMENT_AGRE_TOW=#{OTHER_PAYMENT_AGRE_TOW}</if>
		<if test="SECURITY_WAY !=null and SECURITY_WAY !=''">,SECURITY_WAY=#{SECURITY_WAY}</if>
		<if test="SALES_INVOICES_WAY !=null and SALES_INVOICES_WAY !=''">,SALES_INVOICES_WAY=#{SALES_INVOICES_WAY}</if>
		<if test="SALES_TAX !=null and SALES_TAX !=''">,SALES_TAX=#{SALES_TAX}</if>
		<if test="TWO_INVOICES_PROV_MAN !=null and TWO_INVOICES_PROV_MAN !=''">,TWO_INVOICES_PROV_MAN=#{TWO_INVOICES_PROV_MAN}</if>
		<if test="SELLER_UNIT_NAME !=null and SELLER_UNIT_NAME !=''">,SELLER_UNIT_NAME=#{SELLER_UNIT_NAME}</if>
		<if test="SELLER_UNIT_ADDR !=null and SELLER_UNIT_ADDR !=''">,SELLER_UNIT_ADDR=#{SELLER_UNIT_ADDR}</if>
		<if test="SELLER_LEGAL_REPR !=null and SELLER_LEGAL_REPR !=''">,SELLER_LEGAL_REPR=#{SELLER_LEGAL_REPR}</if>
		<if test="SELLER_AGENT !=null and SELLER_AGENT !=''">,SELLER_AGENT=#{SELLER_AGENT}</if>
		<if test="SELLER_PHONE !=null and SELLER_PHONE !=''">,SELLER_PHONE=#{SELLER_PHONE}</if>
		<if test="SELLER_FAX !=null and SELLER_FAX !=''">,SELLER_FAX=#{SELLER_FAX}</if>
		<if test="SELLER_BANK_ACCO !=null and SELLER_BANK_ACCO !=''">,SELLER_BANK_ACCO=#{SELLER_BANK_ACCO}</if>
		<if test="SELLER_ACCOUNT !=null and SELLER_ACCOUNT !=''">,SELLER_ACCOUNT=#{SELLER_ACCOUNT}</if>
		<if test="SELLER_CODE !=null and SELLER_CODE !=''">,SELLER_CODE=#{SELLER_CODE}</if>
		<if test="BUYER_UNIT_NAME !=null and BUYER_UNIT_NAME !=''">,BUYER_UNIT_NAME=#{BUYER_UNIT_NAME}</if>
		<if test="BUYER_UNIT_ADDR !=null and BUYER_UNIT_ADDR !=''">,BUYER_UNIT_ADDR=#{BUYER_UNIT_ADDR}</if>
		<if test="BUYER_LEGAL_REPR !=null and BUYER_LEGAL_REPR !=''">,BUYER_LEGAL_REPR=#{BUYER_LEGAL_REPR}</if>
		<if test="BUYER_AGENT !=null and BUYER_AGENT !=''">,BUYER_AGENT=#{BUYER_AGENT}</if>
		<if test="BUYER_PHONE !=null and BUYER_PHONE !=''">,BUYER_PHONE=#{BUYER_PHONE}</if>
		<if test="BUYER_FAX !=null and BUYER_FAX !=''">,BUYER_FAX=#{BUYER_FAX}</if>
		<if test="BUYER_BANK_ACCO !=null and BUYER_BANK_ACCO !=''">,BUYER_BANK_ACCO=#{BUYER_BANK_ACCO}</if>
		<if test="BUYER_ACCOUNT !=null and BUYER_ACCOUNT !=''">,BUYER_ACCOUNT=#{BUYER_ACCOUNT}</if>
		<if test="BUYER_UNIT_TAX !=null and BUYER_UNIT_TAX !=''">,BUYER_UNIT_TAX=#{BUYER_UNIT_TAX}</if>
		<if test="BUYER_CODE !=null and BUYER_CODE !=''">,BUYER_CODE=#{BUYER_CODE}</if>
		<if test="BUYER_ID !=null and BUYER_ID !=''">,BUYER_ID=#{BUYER_ID}</if>
		<if test="BUYER_HOME_ADDR !=null and BUYER_HOME_ADDR !=''">,BUYER_HOME_ADDR=#{BUYER_HOME_ADDR}</if>
		<if test="GUARANTOR_SIGNED !=null and GUARANTOR_SIGNED !=''">,GUARANTOR_SIGNED=#{GUARANTOR_SIGNED}</if>
		<if test="GUARANTOR_SIGNED_SEAL !=null and GUARANTOR_SIGNED_SEAL !=''">,GUARANTOR_SIGNED_SEAL=#{GUARANTOR_SIGNED_SEAL}</if>
		<if
			test="GUARANTOR_SIGNED_SEAL_DAT !=null and GUARANTOR_SIGNED_SEAL_DAT !=''">,GUARANTOR_SIGNED_SEAL_DAT=TO_DATE(#{GUARANTOR_SIGNED_SEAL_DAT},'yyyy-mm-dd')
		</if>
		<if
			test="FORENSIC_AUTHORITIES_SEAL !=null and FORENSIC_AUTHORITIES_SEAL !=''">,FORENSIC_AUTHORITIES_SEAL=#{FORENSIC_AUTHORITIES_SEAL}</if>
		<if
			test="FORENSIC_AUTHORITIES_SEAL_DAT !=null and FORENSIC_AUTHORITIES_SEAL_DAT !=''">,FORENSIC_AUTHORITIES_SEAL_DAT=TO_DATE(#{FORENSIC_AUTHORITIES_SEAL_DAT},'yyyy-mm-dd')
		</if>
		<if test="SELLER_PAY_BANK_ADDRESS !=null and SELLER_PAY_BANK_ADDRESS !=''">,SELLER_PAY_BANK_ADDRESS=#{SELLER_PAY_BANK_ADDRESS}</if>
		<if test="TYPE !=null">,TYPE=#{TYPE}</if>
		<if test="REMARK !=null">,REMARK=#{REMARK}</if>
		<if test="SUBCOMPANY !=null">,SUBCOMPANY=#{SUBCOMPANY}</if>
		<if test="PLATFORM !=null">,PLATFORM=#{PLATFORM}</if>
		<if test="PAY_ID !=null">,PAY_ID=#{PAY_ID}</if>
		<if test="PAYLIST_CODE !=null">,PAYLIST_CODE=#{PAYLIST_CODE}</if>
		<if test="FILE_URL !=null">,FILE_URL=#{FILE_URL}</if>
		<if test="STATUS !=null">,STATUS=#{STATUS}</if>
		<if test="PROJECT_ID !=null">,PROJECT_ID=#{PROJECT_ID}</if>
		<if test="SEND_DATE !=null">,SEND_DATE=TO_DATE(#{SEND_DATE},'yyyy-mm-dd')</if>
		WHERE ID=#{ID}
	</update>
	<select id="queryProjecdModel" parameterType="String"
		resultType="String">
		SELECT LEASE_MODEL FROM FIL_PROJECT_HEAD WHERE PARENT_ID = #{project_id}
		AND LEASE_MODEL ='back_leasing'
	</select>
	<select id="getLEASE_TOPRIC" parameterType="String" resultType="int">
		SELECT LEASE_TOPRIC FROM FIL_RENT_PLAN_HEAD_MAX_V WHERE PAYLIST_CODE
		=#{payListCode}
	</select>
	<select id="getFktj" parameterType="Map" resultType="Map">
		SELECT
		A.SQL, A.SQL_FIELD, A.NOTE
		FROM T_SYS_PAYMENT_TERM A
		WHERE A.ID = #{IDS}
	</select>
</mapper>
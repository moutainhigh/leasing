<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN"
"http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">
<mapper namespace="purchase">
	<select id="getAllSuitProject" parameterType="map" resultType="map">
		SELECT * FROM (SELECT T.*,ROWNUM ROWNO FROM (
		SELECT
		FPH.ID,FPH.CLIENT_ID,FPH.PRO_CODE,COMPANY_NAME,FCC.NAME CLIENTNAME,
		CASE WHEN FPH.STATUS=20 THEN '正常结清' WHEN FPH.STATUS=30 THEN '提前还租' END
		PROSTATUS,FPH.ENGINE_TYPE,FPH.AMOUNT,
		FPH.TYPE_NAME,to_char(FPH.PRO_END_DATE,'yyyy-mm-dd')
		END_DATE,FPH.PRODUCT_NAME,FPH.SUP_SHORTNAME SUPPLIER,FPH.SUP_ID
		FROM
		FIL_PROJECT_HEAD FPH
		LEFT JOIN FIL_CUST_CLIENT FCC ON FPH.CLIENT_ID =
		FCC.ID
		WHERE FPH.STATUS IN(20,30) AND NOT EXISTS
		(SELECT * FROM
		fil_project_end_purchase filp WHERE filp.Project_Id=fph.ID)
		AND NOT
		EXISTS
		(SELECT * FROM FI_R_BEGINNING FRB WHERE FRB.Project_Id = fph.id
		AND FRB.ITEM_FLAG=2 AND FRB.BEGINNING_FLAG!=1 AND FRB.BEGINNING_NAME
		IN('本金','利息')) AND NOT EXISTS
		(SELECT * FROM FI_OVERDUE FO WHERE
		FO.Project_Id = FPH.ID
		AND FO.PENALTY_RECE!=FO.PENALTY_PAID) AND NOT EXISTS
		(SELECT * FROM
		FIL_BUY_BACK FBB WHERE FBB.PROJECT_ID=FPH.ID and
		fbb.BUY_BACK_STATUS!=0)
		<if test="SUPPLIER !=null and SUPPLIER !=''">AND SUP_SHORTNAME LIKE '%${SUPPLIER}%'</if>
		<if test="COMPANY_NAME !=null and COMPANY_NAME !=''">AND COMPANY_NAME LIKE '%${COMPANY_NAME}%'</if>
		<if test="PRO_CODE !=null and PRO_CODE !=''">AND FPH.PRO_CODE LIKE '%${PRO_CODE}%'</if>
		<if test="CLIENTNAME !=null and CLIENTNAME !=''">AND FCC.NAME LIKE '%${CLIENTNAME}%'</if>
		<if test="END_DATE_START!=null and END_DATE_START!=''">AND
			FPH.PRO_END_DATE>=TO_DATE(#{END_DATE_START},'YYYY-MM-DD')</if>
		<if test="END_DATE_END!=null and END_DATE_END!=''">AND <![CDATA[FPH.PRO_END_DATE<=TO_DATE(#{END_DATE_END},'YYYY-MM-DD')]]></if>
		ORDER BY COMPANY_NAME,SUPPLIER
		) T )TT WHERE TT.ROWNO BETWEEN
		#{PAGE_BEGIN} AND #{PAGE_END}
	</select>

	<select id="getAllSuitProject_count" parameterType="map"
		resultType="int">
		SELECT COUNT(DD.ID) FROM (
		SELECT FPH.ID,PRO_CODE,COMPANY_NAME,FCC.NAME
		CLIENTNAME,
		CASE WHEN FPH.STATUS=20 THEN '正常结清' WHEN FPH.STATUS=30 THEN
		'提前还租' END
		PROSTATUS,FPH.ENGINE_TYPE,FPH.AMOUNT,
		FPH.TYPE_NAME,to_char(FPH.PRO_END_DATE,'yyyy-mm-dd')
		END_DATE,FPH.PRODUCT_NAME,FPH.SUP_SHORTNAME SUPPLIER,FPH.SUP_ID
		FROM
		FIL_PROJECT_HEAD FPH
		LEFT JOIN FIL_CUST_CLIENT FCC ON FPH.CLIENT_ID =
		FCC.ID
		WHERE FPH.STATUS IN(20,30) AND NOT EXISTS
		(SELECT * FROM
		fil_project_end_purchase filp WHERE filp.Project_Id=fph.ID)
		AND NOT
		EXISTS
		(SELECT * FROM FI_R_BEGINNING FRB WHERE FRB.Project_Id = fph.id
		AND FRB.ITEM_FLAG=2 AND FRB.BEGINNING_FLAG!=1 AND FRB.BEGINNING_NAME
		IN('本金','利息')) AND NOT EXISTS
		(SELECT * FROM FI_OVERDUE FO WHERE
		FO.Project_Id = FPH.ID
		AND FO.PENALTY_RECE!=FO.PENALTY_PAID) AND NOT EXISTS
		(SELECT * FROM
		FIL_BUY_BACK FBB WHERE FBB.PROJECT_ID=FPH.ID and
		fbb.BUY_BACK_STATUS!=0)
		<if test="SUPPLIER !=null and SUPPLIER !=''">AND SUP_SHORTNAME LIKE '%${SUPPLIER}%'</if>
		<if test="COMPANY_NAME !=null and COMPANY_NAME !=''">AND COMPANY_NAME LIKE '%${COMPANY_NAME}%'</if>
		<if test="PRO_CODE !=null and PRO_CODE !=''">AND FPH.PRO_CODE LIKE '%${PRO_CODE}%'</if>
		<if test="CLIENTNAME !=null and CLIENTNAME !=''">AND FCC.NAME LIKE '%${CLIENTNAME}%'</if>
		<if test="END_DATE_START!=null and END_DATE_START!=''">AND
			FPH.PRO_END_DATE>=TO_DATE(#{END_DATE_START},'YYYY-MM-DD')</if>
		<if test="END_DATE_END!=null and END_DATE_END!=''">AND <![CDATA[FPH.PRO_END_DATE<=TO_DATE(#{END_DATE_END},'YYYY-MM-DD')]]></if>
		) DD
	</select>

	<select id="getSearchAllSuitProject" parameterType="map"
		resultType="map">
		SELECT * FROM (SELECT T.*,ROWNUM ROWNO FROM (
		SELECT
		ID,PRO_CODE,COMPANY_NAME,CLIENTNAME,
		CASE WHEN NVL(END_STATUS,20)=30
		THEN '提前还租' ELSE '正常结清' END
		PROSTATUS,ENGINE_TYPE,AMOUNT,
		TYPE_NAME,to_char(END_DATE,'yyyy-mm-dd')
		END_DATE,PRODUCT_NAME,SUPPLIER,SUP_ID,FINANCE_TOPRIC,
		to_char(PURCHASE_APP_DATE,'yyyy-mm-dd') PURCHASE_APP_DATE,AREANAME
		FROM (
		SELECT FPH.ID,FPH.PRO_CODE,COMPANY_NAME,FCC.NAME
		CLIENTNAME,FPH.END_STATUS,FPH.ENGINE_TYPE,FPH.AMOUNT,TSA.NAME
		AREANAME,
		FPEP.PURCHASE_APP_DATE,FPH.TYPE_NAME,FPH.PRO_END_DATE
		END_DATE,FPH.PRODUCT_NAME,FPH.SUP_SHORTNAME
		SUPPLIER,FPH.SUP_ID,FPH.FINANCE_TOPRIC
		FROM FIL_PROJECT_HEAD FPH
		LEFT
		JOIN FIL_CUST_CLIENT FCC ON FPH.CLIENT_ID = FCC.ID
		LEFT JOIN
		T_SYS_SUPPLIERS TSS ON FPH.SUP_ID = TSS.SUP_ID
		LEFT JOIN T_SYS_AREA TSA
		ON TSS.AREA_ID = TSA.ID
		RIGHT JOIN FIL_PROJECT_END_PURCHASE FPEP ON
		FPH.PRO_CODE = FPEP.PRO_CODE
		WHERE FPH.STATUS >=20
		<if test="SUPPLIER !=null and SUPPLIER !=''">AND SUP_SHORTNAME LIKE '%${SUPPLIER}%'</if>
		<if test="COMPANY_NAME !=null and COMPANY_NAME !=''">AND COMPANY_NAME LIKE '%${COMPANY_NAME}%'</if>
		<if test="PRO_CODE !=null and PRO_CODE !=''">AND FPH.PRO_CODE LIKE '%${PRO_CODE}%'</if>
		<if test="CLIENTNAME !=null and CLIENTNAME !=''">AND FCC.NAME LIKE '%${CLIENTNAME}%'</if>
		<if test="END_DATE_START!=null and END_DATE_START!=''">AND
			FPH.PRO_END_DATE>=TO_DATE(#{END_DATE_START},'YYYY-MM-DD')</if>
		<if test="END_DATE_END!=null and END_DATE_END!=''">AND <![CDATA[FPH.PRO_END_DATE<=TO_DATE(#{END_DATE_END},'YYYY-MM-DD')]]></if>
		) D ORDER BY PURCHASE_APP_DATE DESC
		) T )TT WHERE TT.ROWNO BETWEEN
		#{PAGE_BEGIN} AND #{PAGE_END}
	</select>

	<select id="getSearchAllSuitProject_count" parameterType="map"
		resultType="int">
		SELECT COUNT(D.ID) FROM (
		SELECT ID,PRO_CODE,COMPANY_NAME,CLIENTNAME,
		CASE WHEN NVL(END_STATUS,20)=30 THEN '提前还租' ELSE '正常结清' END
		PROSTATUS,ENGINE_TYPE,AMOUNT,
		TYPE_NAME,to_char(END_DATE,'yyyy-mm-dd')
		END_DATE,PRODUCT_NAME,SUPPLIER,SUP_ID,FINANCE_TOPRIC,
		to_char(PURCHASE_APP_DATE,'yyyy-mm-dd') PURCHASE_APP_DATE,AREANAME
		FROM (
		SELECT FPH.ID,FPH.PRO_CODE,COMPANY_NAME,FCC.NAME
		CLIENTNAME,FPH.END_STATUS,FPH.ENGINE_TYPE,FPH.AMOUNT,TSA.NAME
		AREANAME,
		FPEP.PURCHASE_APP_DATE,FPH.TYPE_NAME,FPH.PRO_END_DATE
		END_DATE,FPH.PRODUCT_NAME,FPH.SUP_SHORTNAME
		SUPPLIER,FPH.SUP_ID,FPH.FINANCE_TOPRIC
		FROM FIL_PROJECT_HEAD FPH
		LEFT
		JOIN FIL_CUST_CLIENT FCC ON FPH.CLIENT_ID = FCC.ID
		LEFT JOIN
		T_SYS_SUPPLIERS TSS ON FPH.SUP_ID = TSS.SUP_ID
		LEFT JOIN T_SYS_AREA TSA
		ON TSS.AREA_ID = TSA.ID
		RIGHT JOIN FIL_PROJECT_END_PURCHASE FPEP ON
		FPH.PRO_CODE = FPEP.PRO_CODE
		WHERE FPH.STATUS >=20
		<if test="SUPPLIER !=null and SUPPLIER !=''">AND FPH.SUP_SHORTNAME LIKE '%${SUPPLIER}%'</if>
		<if test="COMPANY_NAME !=null and COMPANY_NAME !=''">AND COMPANY_NAME LIKE '%${COMPANY_NAME}%'</if>
		<if test="PRO_CODE !=null and PRO_CODE !=''">AND FPH.PRO_CODE LIKE '%${PRO_CODE}%'</if>
		<if test="CLIENTNAME !=null and CLIENTNAME !=''">AND FCC.NAME LIKE '%${CLIENTNAME}%'</if>
		<if test="END_DATE_START!=null and END_DATE_START!=''">AND
			FPH.PRO_END_DATE>=TO_DATE(#{END_DATE_START},'YYYY-MM-DD')</if>
		<if test="END_DATE_END!=null and END_DATE_END!=''">AND <![CDATA[FPH.PRO_END_DATE<=TO_DATE(#{END_DATE_END},'YYYY-MM-DD')]]></if>
		)) D
	</select>

	<select id="getAllSuitProjectExcel" parameterType="map"
		resultType="map">
		SELECT FPH.ID,FPH.CLIENT_ID,FPH.PRO_CODE,COMPANY_NAME,FCC.NAME
		CLIENTNAME,
		CASE WHEN FPH.STATUS=20 THEN '正常结清' WHEN FPH.STATUS=30 THEN
		'提前还租' END
		PROSTATUS,FPH.ENGINE_TYPE,FPH.AMOUNT,
		FPH.TYPE_NAME,to_char(FPH.PRO_END_DATE,'yyyy-mm-dd')
		END_DATE,FPH.PRODUCT_NAME,FPH.SUP_SHORTNAME SUPPLIER,FPH.SUP_ID
		FROM
		FIL_PROJECT_HEAD FPH
		LEFT JOIN FIL_CUST_CLIENT FCC ON FPH.CLIENT_ID =
		FCC.ID
		WHERE FPH.STATUS IN(20,30) AND NOT EXISTS
		(SELECT * FROM
		fil_project_end_purchase filp WHERE filp.Project_Id=fph.ID)
		AND NOT
		EXISTS
		(SELECT * FROM FI_R_BEGINNING FRB WHERE FRB.Project_Id = fph.id
		AND FRB.ITEM_FLAG=2 AND FRB.BEGINNING_FLAG!=1 AND FRB.BEGINNING_NAME
		IN('本金','利息')) AND NOT EXISTS
		(SELECT * FROM FI_OVERDUE FO WHERE
		FO.Project_Id = FPH.ID
		AND FO.PENALTY_RECE!=FO.PENALTY_PAID) AND NOT EXISTS
		(SELECT * FROM
		FIL_BUY_BACK FBB WHERE FBB.PROJECT_ID=FPH.ID and
		fbb.BUY_BACK_STATUS!=0)
		<if test="SUPPLIER !=null and SUPPLIER !=''">AND SUP_SHORTNAME LIKE '%${SUPPLIER}%'</if>
		<if test="COMPANY_NAME !=null and COMPANY_NAME !=''">AND COMPANY_NAME LIKE '%${COMPANY_NAME}%'</if>
		<if test="PRO_CODE !=null and PRO_CODE !=''">AND FPH.PRO_CODE LIKE '%${PRO_CODE}%'</if>
		<if test="CLIENTNAME !=null and CLIENTNAME !=''">AND FCC.NAME LIKE '%${CLIENTNAME}%'</if>
		<if test="END_DATE_START!=null and END_DATE_START!=''">AND
			FPH.PRO_END_DATE>=TO_DATE(#{END_DATE_START},'YYYY-MM-DD')</if>
		<if test="END_DATE_END!=null and END_DATE_END!=''">AND <![CDATA[FPH.PRO_END_DATE<=TO_DATE(#{END_DATE_END},'YYYY-MM-DD')]]></if>
		ORDER BY COMPANY_NAME,SUPPLIER
	</select>

	<select id="getSearchAllSuitProjectExcel" parameterType="map"
		resultType="map">
		SELECT FPH.ID,FPH.CLIENT_ID,FPH.PRO_CODE,COMPANY_NAME,FCC.NAME
		CLIENTNAME,
		CASE WHEN FPH.STATUS=20 THEN '正常结清' WHEN FPH.STATUS=30 THEN
		'提前还租' END
		PROSTATUS,FPH.ENGINE_TYPE,FPH.AMOUNT,
		FPH.TYPE_NAME,to_char(FPH.PRO_END_DATE,'yyyy-mm-dd')
		END_DATE,FPH.PRODUCT_NAME,FPH.SUP_SHORTNAME SUPPLIER,FPH.SUP_ID
		FROM
		FIL_PROJECT_HEAD FPH
		LEFT JOIN FIL_CUST_CLIENT FCC ON FPH.CLIENT_ID =
		FCC.ID
		WHERE FPH.STATUS IN(20,30) AND NOT EXISTS
		(SELECT * FROM
		fil_project_end_purchase filp WHERE filp.Project_Id=fph.ID)
		AND NOT
		EXISTS
		(SELECT * FROM FI_R_BEGINNING FRB WHERE FRB.Project_Id = fph.id
		AND FRB.ITEM_FLAG=2 AND FRB.BEGINNING_FLAG!=1 AND FRB.BEGINNING_NAME
		IN('本金','利息')) AND NOT EXISTS
		(SELECT * FROM FI_OVERDUE FO WHERE
		FO.Project_Id = FPH.ID
		AND FO.PENALTY_RECE!=FO.PENALTY_PAID) AND NOT EXISTS
		(SELECT * FROM
		FIL_BUY_BACK FBB WHERE FBB.PROJECT_ID=FPH.ID and
		fbb.BUY_BACK_STATUS!=0)
		<if test="SUPPLIER !=null and SUPPLIER !=''">AND SUP_SHORTNAME LIKE '%${SUPPLIER}%'</if>
		<if test="COMPANY_NAME !=null and COMPANY_NAME !=''">AND COMPANY_NAME LIKE '%${COMPANY_NAME}%'</if>
		<if test="PRO_CODE !=null and PRO_CODE !=''">AND FPH.PRO_CODE LIKE '%${PRO_CODE}%'</if>
		<if test="CLIENTNAME !=null and CLIENTNAME !=''">AND FCC.NAME LIKE '%${CLIENTNAME}%'</if>
		<if test="END_DATE_START!=null and END_DATE_START!=''">AND
			FPH.PRO_END_DATE>=TO_DATE(#{END_DATE_START},'YYYY-MM-DD')</if>
		<if test="END_DATE_END!=null and END_DATE_END!=''">AND <![CDATA[FPH.PRO_END_DATE<=TO_DATE(#{END_DATE_END},'YYYY-MM-DD')]]></if>
		ORDER BY PURCHASE_APP_DATE DESC
	</select>

	<select id="queryProjectById" parameterType="java.util.Map"
		resultType="map">
		SELECT
		FPH.ID,FPH.PRO_NAME,FPH.CLIENT_ID,FPH.POB_ID,FPH.STATUS,FPH.JBPM_ID,FPH.CLERK_ID,
		FPH.CLERK_NAME,FPH.PLATFORM_TYPE,FPH.AREA_ID,FPH.ORD_ID,FPH.LEASE_TOPRIC,FPH.PRO_CODE,
		FPH.BANK_ID,TCO.BANK_NAME,TCO.BANK_ACCOUNT,FPH.DELIVER_ADDRESS,to_char(FPH.DELIVER_DATE,'yyyy-mm-dd')
		DELIVER_DATE
		,FPH.LEASE_TERM,FPH.LEASE_PERIOD,FPH.YEAR_INTEREST*100
		YEAR_INTEREST,FPH.FEES,TSDD.FLAG PLATFORM_NAME,
		FCL.TYPE
		CUST_TYPE,TSDD2.FLAG CUST_TYPE_NAME,FCL.ID CUST_ID,FCL.NAME CUST_NAME
		,FPH.AREA_NAME,SO.NAME
		ORG_NAME,FPH.REMARK,FPH.FINANCE_TOPRIC,FPH.FEES_PRICE,FPH.SUP_ID
		SUP_CODE
		FROM FIL_PROJECT_HEAD FPH
		LEFT JOIN FIL_CUST_CLIENT FCL ON
		FPH.CLIENT_ID=FCL.ID
		LEFT JOIN FIL_CUST_OPENINGBANK TCO ON
		TCO.ID=FPH.BANK_ID
		LEFT JOIN SECU_ORG SO ON SO.ID=FPH.ORD_ID
		LEFT JOIN
		T_SYS_DATA_DICTIONARY
		TSDD ON TO_CHAR(FPH.PLATFORM_TYPE)=TSDD.CODE AND
		TSDD.TYPE=#{tags1}
		LEFT JOIN T_SYS_DATA_DICTIONARY TSDD2 ON
		TO_CHAR(FCL.TYPE)=TSDD2.CODE
		AND TSDD2.TYPE=#{tags3}
		where FPH.PRO_CODE
		= #{PRO_CODE}
	</select>

	<select id="queryEqByProjectID" parameterType="java.util.Map"
		resultType="map">
		SELECT
		FPE.ID,TSC.COMPANY_CODE,TSC.COMPANY_NAME,TSS.SUP_NAME SUPPLIERS_NAME,
		TP.PRODUCT_NAME,TPC.CATENA_NAME,TPT.NAME
		SPEC_NAME,FPE.STAYBUY_PRICE,FPE.UNIT_PRICE,
		FPE.AMOUNT,TSDD.FLAG
		UNITTEST,FPE.TOTAL_PRICE
		TOTAL,FPE.PRODUCT_ID,FPE.CATENA_ID,FPE.SPEC_ID,
		FPE.WHOLE_ENGINE_CODE,to_char(FPE.CERTIFICATE_DATE,'YYYY_MM_DD')
		CERTIFICATE_DATE,FPE.ENGINE_TYPE,FPE.CAR_SYMBOL
		FROM
		FIL_PROJECT_EQUIPMENT FPE
		LEFT JOIN T_SYS_COMPANY TSC ON
		FPE.COMPANY_ID=TSC.COMPANY_ID
		LEFT JOIN T_SYS_SUPPLIERS TSS ON
		FPE.SUPPLIERS_ID=TSS.SUP_ID
		LEFT JOIN T_PRODUCT TP ON
		FPE.PRODUCT_ID=TP.PRODUCT_ID
		LEFT JOIN T_PRODUCT_CATENA TPC ON
		FPE.CATENA_ID=TPC.CATENA_ID
		LEFT JOIN T_PRODUCT_TYPE TPT ON
		FPE.SPEC_ID=TPT.ID
		LEFT JOIN T_SYS_DATA_DICTIONARY TSDD ON
		TSDD.TYPE=#{tags} AND
		FPE.UNIT=TSDD.CODE
		WHERE
		FPE.PROJECT_ID=#{PROJECT_ID} and FPE.STATUS=0
		GROUP BY
		FPE.ID,TSC.COMPANY_CODE,TSC.COMPANY_NAME,TSS.SUP_NAME,
		TP.PRODUCT_NAME,TPC.CATENA_NAME,TPT.NAME,FPE.STAYBUY_PRICE,FPE.UNIT_PRICE,
		FPE.AMOUNT,TSDD.FLAG,FPE.TOTAL_PRICE,FPE.PRODUCT_ID,FPE.CATENA_ID,FPE.SPEC_ID,FPE.STATUS,
		FPE.WHOLE_ENGINE_CODE,FPE.CERTIFICATE_DATE,FPE.ENGINE_TYPE,FPE.CAR_SYMBOL
	</select>

	<select id="queryGuaranByProjectID" parameterType="java.util.Map"
		resultType="map">
		select
		FPG.ID,FPG.GUARAN_TYPE,TSDD.FLAG,FPG.GUARAN_NAME,FPG.ORGANIZATION_CODE,FPG.GUARAN_PHONE
		from FIL_PROJECT_GUARAN FPG
		LEFT JOIN T_SYS_DATA_DICTIONARY TSDD ON
		TSDD.TYPE=#{tags} AND FPG.GUARAN_TYPE=TSDD.CODE
		WHERE
		FPG.PROJECT_ID=#{PROJECT_ID} and FPG.STATUS=0
	</select>

	<select id="querySechmeByProjectID" parameterType="java.util.Map"
		resultType="map">
		SELECT * FROM FIL_PROJECT_SCHEME FPS WHERE
		FPS.PROJECT_ID=#{PROJECT_ID} AND
		FPS.STATUS=0
	</select>

	<select id="querySechmeByAllDate" parameterType="java.util.Map"
		resultType="map">
		SELECT FPS.KEY_NAME_ZN FLAG,FPS.KEY_NAME_EN CODE FROM
		FIL_PROJECT_SCHEME FPS
		WHERE FPS.PROJECT_ID=#{PROJECT_ID} AND
		FPS.STATUS=0
	</select>

	<select id="queryIdByProjectId" parameterType="String"
		resultType="int">
		SELECT max(t.id) pay_id FROM fil_rent_plan_head_max_v t
		where t.PROJECT_ID = #{ProjectId}
	</select>

	<select id="selectFileData" parameterType="map" resultType="Map">
		SELECT FPH.PRO_CODE,
		FCC.NAME SUPPLIER_NAMES,
		FPS.VALUE_STR HG_LEAVE,
		TO_CHAR(SYSDATE, 'YYYY-MM-DD') ACCOUNT_DATE
		FROM FIL_PROJECT_HEAD FPH
		LEFT JOIN FIL_CUST_CLIENT FCC
		ON FPH.CLIENT_ID = FCC.ID
		LEFT JOIN FIL_PROJECT_SCHEME FPS
		ON FPH.ID = FPS.PROJECT_ID
		AND FPS.KEY_NAME_ZN = '留购价款'
		WHERE FPH.PRO_CODE = #{PRO_CODE}
	</select>

	<insert id="insertProjectPurchase" parameterType="map">
		INSERT INTO
		FIL_PROJECT_END_PURCHASE
		(
		ID,PRO_CODE,PURCHASE_APP_DATE,SUP_CODE,PROJECT_ID,REMARK,
		CREATOR,CREATE_DATE
		) VALUES
		(
		SEQ_FIL_PROJECT_END_PURCHASE.NEXTVAL
		,#{PRO_CODE}
		,SYSDATE
		,#{SUP_ID}
		,#{PROJECT_ID}
		,#{REMARK}
		,#{USERNAME}
		,SYSDATE
		)
	</insert>

	<update id="updateProjectStatus" parameterType="map">
		UPDATE
		FIL_PROJECT_HEAD SET STATUS=40,END_STATUS=40 WHERE ID=#{PROJECT_ID}
	</update>

</mapper>
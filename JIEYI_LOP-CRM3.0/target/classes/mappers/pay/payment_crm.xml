<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN"
"http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">
<mapper namespace="payment_crm">
	<select id="query_value_scheme" parameterType="java.util.Map"
		resultType="java.util.Map">
		SELECT VALUE_STR CODE FROM FIL_PROJECT_SCHEME WHERE
		PROJECT_ID=#{PROJECT_ID} and KEY_NAME_EN=#{KEY_NAME_EN}
	</select>

	<select id="query_base_map" parameterType="java.util.Map"
		resultType="java.util.Map">
		SELECT FPH.PRO_CODE PROJECT_CODE,FCC.NAME CUST_NAME,VESC.SUPPLIER_IDS
		SUPPER_ID,VESC.SUPPLIER_NAMES SUPPER_NAME,
		VESC.COMPANY_IDS COMP_ID,VESC.COMPANY_NAMES
		COMP_NAME,FPH.PLATFORM_TYPE,VESC.PRODUCT_NAMES,VESC.ENGINE_TYPES,
		VESC.WHOLE_ENGINE_CODES,VESC.EQUIPMENT_AMOUNTS,FPH.LEASE_TOPRIC,DELIVER_ADDRESS
		DELIVERY_ADDR,to_char(DELIVER_DATE,'yyyy-MM-dd') DELIVERY_DATE
		FROM FIL_PROJECT_HEAD FPH
		LEFT JOIN FIL_CUST_CLIENT FCC ON FCC.ID=FPH.CLIENT_ID
		LEFT JOIN V_EQUIPMENT_SUPS_COMS VESC ON VESC.PROJECT_ID=FPH.ID
		WHERE FPH.ID=#{PROJECT_ID}
	</select>

	<select id="query_supp_bank" parameterType="java.util.Map"
		resultType="java.util.Map">
		SELECT * FROM (
		SELECT
		FPH.ID,FSS.LOANS_OWN_UNIT,FSS.LOANS_OWN_ADDR,FSS.LOANS_OWN_BANK,FSS.LOANS_OWN_ACCOUNT,
		FSS.LOANS_TOTAL_UNIT,FSS.LOANS_TOTAL_ADDDR,FSS.LOANS_TOTAL_BANK,FSS.LOANS_TOTAL_ACCOUNT
		,FSS.LOANS_COMPANY_UNIT,FSS.LOANS_COMPANY_ADDR,FSS.LOANS_COMPANY_BANK,FSS.LOANS_COMPANY_ACCOUNT
		FROM FIL_PROJECT_HEAD FPH
		LEFT JOIN FIL_PROJECT_EQUIPMENT FPE ON FPE.PROJECT_ID=FPH.ID
		LEFT JOIN T_SYS_SUPPLIERS FSS ON FPE.SUPPLIERS_ID=FSS.SUP_ID
		WHERE FPH.ID=#{PROJECT_ID}
		GROUP BY
		FPH.ID,FSS.LOANS_OWN_UNIT,FSS.LOANS_OWN_ADDR,FSS.LOANS_OWN_BANK,FSS.LOANS_OWN_ACCOUNT,
		FSS.LOANS_TOTAL_UNIT,FSS.LOANS_TOTAL_ADDDR,FSS.LOANS_TOTAL_BANK,FSS.LOANS_TOTAL_ACCOUNT
		,FSS.LOANS_COMPANY_UNIT,FSS.LOANS_COMPANY_ADDR,FSS.LOANS_COMPANY_BANK,FSS.LOANS_COMPANY_ACCOUNT
		)WHERE ROWNUM=1
	</select>

	<select id="query_Total_SQ" parameterType="java.util.Map"
		resultType="java.util.Map">
		SELECT SUM(T.BEGINNING_MONEY) PRICE FROM FI_R_BEGINNING T
		WHERE T.PROJECT_ID = #{PROJECT_ID} AND T.ITEM_FLAG = 1
	</select>

	<select id="query_Total_ONE" parameterType="java.util.Map"
		resultType="java.util.Map">
		SELECT SUM(T.BEGINNING_MONEY)BEGINNING_MONEY FROM
		FI_R_BEGINNING T WHERE T.BEGINNING_NUM = 1 AND T.PROJECT_ID =
		#{PROJECT_ID}
	</select>

	<select id="query_Total_OTHER" parameterType="java.util.Map"
		resultType="java.util.Map">
		SELECT SUM(T.BEGINNING_MONEY) PRICE FROM FI_R_BEGINNING T
		WHERE T.PROJECT_ID = #{PROJECT_ID} AND T.ITEM_FLAG = 4
	</select>

	<select id="query_Total_DBBZ" parameterType="java.util.Map"
		resultType="java.util.Map">
		SELECT SUM(T.BEGINNING_MONEY) PRICE FROM FI_R_BEGINNING T
		WHERE T.PROJECT_ID = #{PROJECT_ID} AND T.ITEM_FLAG = 3
	</select>

	<select id="query_Total_CSBZ" parameterType="java.util.Map"
		resultType="java.util.Map">
		SELECT SUM(T.BEGINNING_MONEY) PRICE FROM FI_R_BEGINNING T
		WHERE T.PROJECT_ID = #{PROJECT_ID} AND T.ITEM_FLAG = 5
	</select>

	<select id="query_Total_DBFee" parameterType="java.util.Map"
		resultType="java.util.Map">
		select SUM(VALUE_STR) PRICE from fil_scheme_fee_v where
		key_name_en='GUARANTEE_MONEY' and project_id =#{PROJECT_ID}
	</select>

	<select id="query_Total_BZFee" parameterType="java.util.Map"
		resultType="java.util.Map">
		SELECT SUM(T.BEGINNING_MONEY) PRICE FROM FI_R_BEGINNING T
		WHERE T.PROJECT_ID =#{PROJECT_ID} AND T.BEGINNING_NAME ='保证金'
	</select>

	<select id="query_Total_SXF" parameterType="java.util.Map"
		resultType="java.util.Map">
		SELECT SUM(T.BEGINNING_MONEY) PRICE FROM FI_R_BEGINNING T
		WHERE T.PROJECT_ID =#{PROJECT_ID} AND T.BEGINNING_NAME ='手续费'
	</select>

	<select id="query_Total_BXF" parameterType="java.util.Map"
		resultType="java.util.Map">
		SELECT SUM(T.BEGINNING_MONEY) PRICE FROM FI_R_BEGINNING T
		WHERE T.PROJECT_ID =#{PROJECT_ID} AND T.BEGINNING_NAME ='保险费'
	</select>

	<select id="query_Total_LGJ" parameterType="java.util.Map"
		resultType="java.util.Map">
		SELECT SUM(T.BEGINNING_MONEY) PRICE FROM FI_R_BEGINNING T
		WHERE T.PROJECT_ID =#{PROJECT_ID} AND T.BEGINNING_NAME ='留购价款'
	</select>

	<select id="query_Total_QJZJ" parameterType="java.util.Map"
		resultType="java.util.Map">
		SELECT SUM(T.BEGINNING_MONEY) PRICE FROM FI_R_BEGINNING T
		WHERE T.PROJECT_ID =#{PROJECT_ID} AND T.BEGINNING_NAME ='起租租金'
	</select>


	<update id="updatePayMentDateINVOICE" parameterType="java.util.Map">
		UPDATE FI_FUND_PAYMENT_DETAIL PD
		SET (PD.INVOICE_NUM, PD.INVOICE_DATE) =
		(SELECT E.INVOICE_CODE, E.INVOICE_DATE
		FROM FI_FUND_PAYMENT_DETAIL D
		LEFT JOIN FIL_PROJECT_HEAD H
		ON H.PRO_CODE = D.PROJECT_CODE
		LEFT JOIN FI_INVOICE_EQUIPMENT E
		ON E.PROJECT_ID = H.ID
		WHERE D.ID = PD.ID)
		WHERE PD.PROJECT_CODE = #{PROJECT_CODE}
	</update>

	<update id="updatePMByComplement" parameterType="java.util.Map">
		UPDATE
		FI_FUND_PAYMENT_DETAIL SET COMPLEMENT_TYPE=1 WHERE
		PROJECT_CODE=#{PROJECT_CODE}
	</update>

	<update id="updatePMByDate" parameterType="java.util.Map">
		UPDATE FI_FUND_PAYMENT_DETAIL SET
		PAY_TYPE=#{PAY_TYPE}
		<if test="INVOICE_NUM != null and INVOICE_NUM != ''">,INVOICE_NUM=#{INVOICE_NUM}</if>
		<if test="INVOICE_DATE != null and INVOICE_DATE != ''">,INVOICE_DATE=TO_DATE(#{INVOICE_DATE},'YYYY-MM-DD')</if>
		<if test="GUARANTEE_NUM != null and GUARANTEE_NUM != ''">,GUARANTEE_NUM=#{GUARANTEE_NUM}</if>
		<if test="GUARANTEE_DATE != null and GUARANTEE_DATE != ''">,GUARANTEE_DATE=TO_DATE(#{GUARANTEE_DATE},'YYYY-MM-DD')
		</if>
		WHERE PROJECT_CODE=#{PROJECT_CODE} and PAY_TYPE=#{PAY_TYPE}
	</update>

	<update id="updatePMByStateDate" parameterType="java.util.Map">
		UPDATE FI_FUND_PAYMENT_DETAIL SET
		PROJECT_CODE=#{PROJECT_CODE}
		<if test="START_DATE != null and START_DATE != ''">,START_DATE=TO_DATE(#{START_DATE},'YYYY-MM-DD')</if>
		<if test="RESERVE_DATE != null and RESERVE_DATE != ''">,RESERVE_DATE=TO_DATE(#{RESERVE_DATE},'YYYY-MM-DD')</if>
		<if test="ACCEPTANCE_DATE != null and ACCEPTANCE_DATE != ''">,ACCEPTANCE_DATE=TO_DATE(#{ACCEPTANCE_DATE},'YYYY-MM-DD')
		</if>
		WHERE PROJECT_CODE=#{PROJECT_CODE} AND PAY_TYPE=#{PAY_TYPE}
	</update>

	<select id="query_Eq_PayMent_C" parameterType="java.util.Map"
		resultType="java.util.Map">
		select t.* from(
		select * from V_FI_FUND_PAYMENT_DETAIL where PLATFORM_TYPE in
		(${NotInvoice}) and PAY_TYPE=1
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PROJECT_CODE != null and PROJECT_CODE != ''">and PROJECT_CODE like '%'||#{PROJECT_CODE}||'%' </if>
		<if test="PRODUCT_NAME != null and PRODUCT_NAME != ''">and PRODUCT_NAMES like '%'||#{PRODUCT_NAME}||'%'</if>
		<if test="COMP_NAME != null and COMP_NAME != ''">and COMP_NAME like '%'||#{COMP_NAME}||'%'</if>
		<if test="CUST_NAME != null and CUST_NAME != ''">and CUST_NAME like '%'||#{CUST_NAME}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="INVOICE_DATE1 !=null and INVOICE_DATE1 !=''"> and to_date(INVOICE_DATE,'yyyy-mm-dd')
			>=to_date(#{INVOICE_DATE1},'yyyy-mm-dd')</if>
		<if test="INVOICE_DATE2 !=null and INVOICE_DATE2 !=''"> and to_date(INVOICE_DATE,'yyyy-mm-dd')
			&lt;=to_date(#{INVOICE_DATE2},'yyyy-mm-dd')</if>
		<if test="RESERVE_DATE1 !=null and RESERVE_DATE1 !=''"> and to_date(RESERVE_DATE,'yyyy-mm-dd')
			>=to_date(#{RESERVE_DATE1},'yyyy-mm-dd')</if>
		<if test="RESERVE_DATE2 !=null and RESERVE_DATE2 !=''"> and to_date(RESERVE_DATE,'yyyy-mm-dd')
			&lt;=to_date(#{RESERVE_DATE2},'yyyy-mm-dd')</if>
		union all
		select * from V_FI_FUND_PAYMENT_DETAIL where PLATFORM_TYPE not in
		(${NotInvoice}) and PAY_TYPE=1 and INVOICE_NUM is not null
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PROJECT_CODE != null and PROJECT_CODE != ''">and PROJECT_CODE like '%'||#{PROJECT_CODE}||'%'</if>
		<if test="PRODUCT_NAME != null and PRODUCT_NAME != ''">and PRODUCT_NAMES like '%'||#{PRODUCT_NAME}||'%'</if>
		<if test="COMP_NAME != null and COMP_NAME != ''">and COMP_NAME like '%'||#{COMP_NAME}||'%'</if>
		<if test="CUST_NAME != null and CUST_NAME != ''">and CUST_NAME like '%'||#{CUST_NAME}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="INVOICE_DATE1 !=null and INVOICE_DATE1 !=''"> and
			to_date(INVOICE_DATE,'yyyy-mm-dd')>=to_date(#{INVOICE_DATE1},'yyyy-mm-dd')
		</if>
		<if test="INVOICE_DATE2 !=null and INVOICE_DATE2 !=''"> and to_date(INVOICE_DATE,'yyyy-mm-dd')
			&lt;=to_date(#{INVOICE_DATE2},'yyyy-mm-dd')</if>
		<if test="RESERVE_DATE1 !=null and RESERVE_DATE1 !=''"> and to_date(RESERVE_DATE,'yyyy-mm-dd')
			>=to_date(#{RESERVE_DATE1},'yyyy-mm-dd')</if>
		<if test="RESERVE_DATE2 !=null and RESERVE_DATE2 !=''"> and to_date(RESERVE_DATE,'yyyy-mm-dd')
			&lt;=to_date(#{RESERVE_DATE2},'yyyy-mm-dd')</if>
		) t
		<where>
			<if test="SUP_ID != null and SUP_ID != ''">t.SUPPER_ID =#{SUP_ID}</if>
			<if test="COM_ID != null and COM_ID != ''">and T.COMP_ID IN (${COM_ID})</if>
		</where>
		order by t.SUPPER_ID,t.PROJECT_CODE
	</select>

	<select id="query_EqSupp_PayMent_C" parameterType="java.util.Map"
		resultType="java.util.Map">
		select t.SUPPER_ID,t.SUPPER_NAME,sum(t.PAY_MONEY) PAY_MONEY from (
		select * from V_FI_FUND_PAYMENT_DETAIL where PLATFORM_TYPE in
		(${NotInvoice}) and PAY_TYPE=1
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PROJECT_CODE != null and PROJECT_CODE != ''">and PROJECT_CODE like '%'||#{PROJECT_CODE}||'%'</if>
		<if test="PRODUCT_NAME != null and PRODUCT_NAME != ''">and PRODUCT_NAMES like '%'||#{PRODUCT_NAME}||'%'</if>
		<if test="COMP_NAME != null and COMP_NAME != ''">and COMP_NAME like '%'||#{COMP_NAME}||'%'</if>
		<if test="CUST_NAME != null and CUST_NAME != ''">and CUST_NAME like '%'||#{CUST_NAME}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="INVOICE_DATE1 !=null and INVOICE_DATE1 !=''"> and
			to_date(INVOICE_DATE,'yyyy-mm-dd')>=to_date(#{INVOICE_DATE1},'yyyy-mm-dd')
		</if>
		<if test="INVOICE_DATE2 !=null and INVOICE_DATE2 !=''"> and to_date(INVOICE_DATE,'yyyy-mm-dd')
			&lt;=to_date(#{INVOICE_DATE2},'yyyy-mm-dd')</if>
		<if test="RESERVE_DATE1 !=null and RESERVE_DATE1 !=''"> and to_date(RESERVE_DATE,'yyyy-mm-dd')
			>=to_date(#{RESERVE_DATE1},'yyyy-mm-dd')</if>
		<if test="RESERVE_DATE2 !=null and RESERVE_DATE2 !=''"> and to_date(RESERVE_DATE,'yyyy-mm-dd')
			&lt;=to_date(#{RESERVE_DATE2},'yyyy-mm-dd')</if>
		union all
		select * from V_FI_FUND_PAYMENT_DETAIL where PLATFORM_TYPE not in
		(${NotInvoice}) and PAY_TYPE=1 and INVOICE_NUM is not null
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PROJECT_CODE != null and PROJECT_CODE != ''">and PROJECT_CODE like '%'||#{PROJECT_CODE}||'%'</if>
		<if test="PRODUCT_NAME != null and PRODUCT_NAME != ''">and PRODUCT_NAMES like '%'||#{PRODUCT_NAME}||'%'</if>
		<if test="COMP_NAME != null and COMP_NAME != ''">and COMP_NAME like '%'||#{COMP_NAME}||'%'</if>
		<if test="CUST_NAME != null and CUST_NAME != ''">and CUST_NAME like '%'||#{CUST_NAME}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="INVOICE_DATE1 !=null and INVOICE_DATE1 !=''"> and
			to_date(INVOICE_DATE,'yyyy-mm-dd')>=to_date(#{INVOICE_DATE1},'yyyy-mm-dd')
		</if>
		<if test="INVOICE_DATE2 !=null and INVOICE_DATE2 !=''"> and to_date(INVOICE_DATE,'yyyy-mm-dd')
			&lt;=to_date(#{INVOICE_DATE2},'yyyy-mm-dd')</if>
		<if test="RESERVE_DATE1 !=null and RESERVE_DATE1 !=''"> and to_date(RESERVE_DATE,'yyyy-mm-dd')
			>=to_date(#{RESERVE_DATE1},'yyyy-mm-dd')</if>
		<if test="RESERVE_DATE2 !=null and RESERVE_DATE2 !=''"> and to_date(RESERVE_DATE,'yyyy-mm-dd')
			&lt;=to_date(#{RESERVE_DATE2},'yyyy-mm-dd')</if>
		) t
		<where>
			<if test="SUP_ID != null and SUP_ID != ''">t.SUPPER_ID =#{SUP_ID}</if>
			<if test="COM_ID != null and COM_ID != ''">and T.COMP_ID IN (${COM_ID})</if>
		</where>
		group by t.SUPPER_ID,t.SUPPER_NAME order by t.SUPPER_ID
	</select>

	<select id="query_OTHER_PayMent_C" parameterType="java.util.Map"
		resultType="java.util.Map">
		select t.* from(
		select * from V_FI_FUND_PAYMENT_DETAIL where PLATFORM_TYPE in
		(${NotInvoice}) and PAY_TYPE=4
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PROJECT_CODE != null and PROJECT_CODE != ''">and PROJECT_CODE like '%'||#{PROJECT_CODE}||'%'</if>
		<if test="PRODUCT_NAME != null and PRODUCT_NAME != ''">and PRODUCT_NAMES like '%'||#{PRODUCT_NAME}||'%'</if>
		<if test="COMP_NAME != null and COMP_NAME != ''">and COMP_NAME like '%'||#{COMP_NAME}||'%'</if>
		<if test="CUST_NAME != null and CUST_NAME != ''">and CUST_NAME like '%'||#{CUST_NAME}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="INVOICE_DATE1 !=null and INVOICE_DATE1 !=''"> and
			to_date(#{INVOICE_DATE},'yyyy-mm-dd')>=to_date(#{INVOICE_DATE1},'yyyy-mm-dd')
		</if>
		<if test="INVOICE_DATE2 !=null and INVOICE_DATE2 !=''"> and to_date(#{INVOICE_DATE},'yyyy-mm-dd')
			&lt;=to_date(#{INVOICE_DATE2},'yyyy-mm-dd')</if>
		<if test="RESERVE_DATE1 !=null and RESERVE_DATE1 !=''"> and
			to_date(#{RESERVE_DATE},'yyyy-mm-dd')>=to_date(#{RESERVE_DATE1},'yyyy-mm-dd')
		</if>
		<if test="RESERVE_DATE2 !=null and RESERVE_DATE2 !=''"> and to_date(#{RESERVE_DATE},'yyyy-mm-dd')
			&lt;=to_date(#{RESERVE_DATE2},'yyyy-mm-dd')</if>
		union all
		select * from V_FI_FUND_PAYMENT_DETAIL where PLATFORM_TYPE not in
		(${NotInvoice}) and PAY_TYPE=4 and INVOICE_NUM is not null
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PROJECT_CODE != null and PROJECT_CODE != ''">and PROJECT_CODE like '%'||#{PROJECT_CODE}||'%'</if>
		<if test="PRODUCT_NAME != null and PRODUCT_NAME != ''">and PRODUCT_NAMES like '%'||#{PRODUCT_NAME}||'%'</if>
		<if test="COMP_NAME != null and COMP_NAME != ''">and COMP_NAME like '%'||#{COMP_NAME}||'%'</if>
		<if test="CUST_NAME != null and CUST_NAME != ''">and CUST_NAME like '%'||#{CUST_NAME}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="INVOICE_DATE1 !=null and INVOICE_DATE1 !=''"> and
			to_date(#{INVOICE_DATE},'yyyy-mm-dd')>=to_date(#{INVOICE_DATE1},'yyyy-mm-dd')
		</if>
		<if test="INVOICE_DATE2 !=null and INVOICE_DATE2 !=''"> and to_date(#{INVOICE_DATE},'yyyy-mm-dd')
			&lt;=to_date(#{INVOICE_DATE2},'yyyy-mm-dd')</if>
		<if test="RESERVE_DATE1 !=null and RESERVE_DATE1 !=''"> and
			to_date(#{RESERVE_DATE},'yyyy-mm-dd')>=to_date(#{RESERVE_DATE1},'yyyy-mm-dd')
		</if>
		<if test="RESERVE_DATE2 !=null and RESERVE_DATE2 !=''"> and to_date(#{RESERVE_DATE},'yyyy-mm-dd')
			&lt;=to_date(#{RESERVE_DATE2},'yyyy-mm-dd')</if>
		) t
		<where>
			<if test="SUP_ID != null and SUP_ID != ''">t.SUPPER_ID =#{SUP_ID}</if>
			<if test="COM_ID != null and COM_ID != ''">and T.COMP_ID IN (${COM_ID})</if>
		</where>
		order by t.SUPPER_ID,t.PROJECT_CODE
	</select>

	<select id="query_OTHERSupp_PayMent_C" parameterType="java.util.Map"
		resultType="java.util.Map">
		select t.SUPPER_ID,t.SUPPER_NAME,sum(t.PAY_MONEY) PAY_MONEY from (
		select * from V_FI_FUND_PAYMENT_DETAIL where PLATFORM_TYPE in
		(${NotInvoice}) and PAY_TYPE=4
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PROJECT_CODE != null and PROJECT_CODE != ''">and PROJECT_CODE like '%'||#{PROJECT_CODE}||'%'</if>
		<if test="PRODUCT_NAME != null and PRODUCT_NAME != ''">and PRODUCT_NAMES like '%'||#{PRODUCT_NAME}||'%'</if>
		<if test="COMP_NAME != null and COMP_NAME != ''">and COMP_NAME like '%'||#{COMP_NAME}||'%'</if>
		<if test="CUST_NAME != null and CUST_NAME != ''">and CUST_NAME like '%'||#{CUST_NAME}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="INVOICE_DATE1 !=null and INVOICE_DATE1 !=''"> and
			to_date(#{INVOICE_DATE},'yyyy-mm-dd')>=to_date(#{INVOICE_DATE1},'yyyy-mm-dd')
		</if>
		<if test="INVOICE_DATE2 !=null and INVOICE_DATE2 !=''"> and to_date(#{INVOICE_DATE},'yyyy-mm-dd')
			&lt;=to_date(#{INVOICE_DATE2},'yyyy-mm-dd')</if>
		<if test="RESERVE_DATE1 !=null and RESERVE_DATE1 !=''"> and
			to_date(#{RESERVE_DATE},'yyyy-mm-dd')>=to_date(#{RESERVE_DATE1},'yyyy-mm-dd')
		</if>
		<if test="RESERVE_DATE2 !=null and RESERVE_DATE2 !=''"> and to_date(#{RESERVE_DATE},'yyyy-mm-dd')
			&lt;=to_date(#{RESERVE_DATE2},'yyyy-mm-dd')</if>
		union all
		select * from V_FI_FUND_PAYMENT_DETAIL where PLATFORM_TYPE not in
		(${NotInvoice}) and PAY_TYPE=4 and INVOICE_NUM is not null
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PROJECT_CODE != null and PROJECT_CODE != ''">and PROJECT_CODE like '%'||#{PROJECT_CODE}||'%'</if>
		<if test="PRODUCT_NAME != null and PRODUCT_NAME != ''">and PRODUCT_NAMES like '%'||#{PRODUCT_NAME}||'%'</if>
		<if test="COMP_NAME != null and COMP_NAME != ''">and COMP_NAME like '%'||#{COMP_NAME}||'%'</if>
		<if test="CUST_NAME != null and CUST_NAME != ''">and CUST_NAME like '%'||#{CUST_NAME}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="INVOICE_DATE1 !=null and INVOICE_DATE1 !=''"> and
			to_date(#{INVOICE_DATE},'yyyy-mm-dd')>=to_date(#{INVOICE_DATE1},'yyyy-mm-dd')
		</if>
		<if test="INVOICE_DATE2 !=null and INVOICE_DATE2 !=''"> and to_date(#{INVOICE_DATE},'yyyy-mm-dd')
			&lt;=to_date(#{INVOICE_DATE2},'yyyy-mm-dd')</if>
		<if test="RESERVE_DATE1 !=null and RESERVE_DATE1 !=''"> and
			to_date(#{RESERVE_DATE},'yyyy-mm-dd')>=to_date(#{RESERVE_DATE1},'yyyy-mm-dd')
		</if>
		<if test="RESERVE_DATE2 !=null and RESERVE_DATE2 !=''"> and to_date(#{RESERVE_DATE},'yyyy-mm-dd')
			&lt;=to_date(#{RESERVE_DATE2},'yyyy-mm-dd')</if>
		) t
		<where>
			<if test="SUP_ID != null and SUP_ID != ''">t.SUPPER_ID =#{SUP_ID}</if>
			<if test="COM_ID != null and COM_ID != ''">and T.COMP_ID IN (${COM_ID})</if>
		</where>
		group by t.SUPPER_ID,t.SUPPER_NAME order by t.SUPPER_ID
	</select>

	<select id="query_DB_PayMent_C" parameterType="java.util.Map"
		resultType="java.util.Map">
		select t.* from(
		select * from V_FI_FUND_PAYMENT_DETAIL where PLATFORM_TYPE in
		(${NotInvoice}) and PAY_TYPE=2
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PROJECT_CODE != null and PROJECT_CODE != ''">and PROJECT_CODE like '%'||#{PROJECT_CODE}||'%'</if>
		<if test="PRODUCT_NAME != null and PRODUCT_NAME != ''">and PRODUCT_NAMES like '%'||#{PRODUCT_NAME}||'%'</if>
		<if test="COMP_NAME != null and COMP_NAME != ''">and COMP_NAME like '%'||#{COMP_NAME}||'%'</if>
		<if test="CUST_NAME != null and CUST_NAME != ''">and CUST_NAME like '%'||#{CUST_NAME}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="INVOICE_DATE1 !=null and INVOICE_DATE1 !=''"> and
			to_date(#{INVOICE_DATE},'yyyy-mm-dd')>=to_date(#{INVOICE_DATE1},'yyyy-mm-dd')
		</if>
		<if test="INVOICE_DATE2 !=null and INVOICE_DATE2 !=''"> and to_date(#{INVOICE_DATE},'yyyy-mm-dd')
			&lt;=to_date(#{INVOICE_DATE2},'yyyy-mm-dd')</if>
		<if test="RESERVE_DATE1 !=null and RESERVE_DATE1 !=''"> and
			to_date(#{RESERVE_DATE},'yyyy-mm-dd')>=to_date(#{RESERVE_DATE1},'yyyy-mm-dd')
		</if>
		<if test="RESERVE_DATE2 !=null and RESERVE_DATE2 !=''"> and to_date(#{RESERVE_DATE},'yyyy-mm-dd')
			&lt;=to_date(#{RESERVE_DATE2},'yyyy-mm-dd')</if>
		union all
		select * from V_FI_FUND_PAYMENT_DETAIL where PLATFORM_TYPE not in
		(${NotInvoice}) and PAY_TYPE=2 and INVOICE_NUM is not null
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PROJECT_CODE != null and PROJECT_CODE != ''">and PROJECT_CODE like '%'||#{PROJECT_CODE}||'%'</if>
		<if test="PRODUCT_NAME != null and PRODUCT_NAME != ''">and PRODUCT_NAMES like '%'||#{PRODUCT_NAME}||'%'</if>
		<if test="COMP_NAME != null and COMP_NAME != ''">and COMP_NAME like '%'||#{COMP_NAME}||'%'</if>
		<if test="CUST_NAME != null and CUST_NAME != ''">and CUST_NAME like '%'||#{CUST_NAME}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="INVOICE_DATE1 !=null and INVOICE_DATE1 !=''"> and
			to_date(#{INVOICE_DATE},'yyyy-mm-dd')>=to_date(#{INVOICE_DATE1},'yyyy-mm-dd')
		</if>
		<if test="INVOICE_DATE2 !=null and INVOICE_DATE2 !=''"> and to_date(#{INVOICE_DATE},'yyyy-mm-dd')
			&lt;=to_date(#{INVOICE_DATE2},'yyyy-mm-dd')</if>
		<if test="RESERVE_DATE1 !=null and RESERVE_DATE1 !=''"> and
			to_date(#{RESERVE_DATE},'yyyy-mm-dd')>=to_date(#{RESERVE_DATE1},'yyyy-mm-dd')
		</if>
		<if test="RESERVE_DATE2 !=null and RESERVE_DATE2 !=''"> and to_date(#{RESERVE_DATE},'yyyy-mm-dd')
			&lt;=to_date(#{RESERVE_DATE2},'yyyy-mm-dd')</if>
		) t order by t.SUPPER_ID,t.PROJECT_CODE
	</select>

	<select id="query_DBSupp_PayMent_C" parameterType="java.util.Map"
		resultType="java.util.Map">
		select t.SUPPER_ID,t.SUPPER_NAME,sum(t.PAY_MONEY) PAY_MONEY from (
		select * from V_FI_FUND_PAYMENT_DETAIL where PLATFORM_TYPE in
		(${NotInvoice}) and PAY_TYPE=2
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PROJECT_CODE != null and PROJECT_CODE != ''">and PROJECT_CODE like '%'||#{PROJECT_CODE}||'%'</if>
		<if test="PRODUCT_NAME != null and PRODUCT_NAME != ''">and PRODUCT_NAMES like '%'||#{PRODUCT_NAME}||'%'</if>
		<if test="COMP_NAME != null and COMP_NAME != ''">and COMP_NAME like '%'||#{COMP_NAME}||'%'</if>
		<if test="CUST_NAME != null and CUST_NAME != ''">and CUST_NAME like '%'||#{CUST_NAME}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="INVOICE_DATE1 !=null and INVOICE_DATE1 !=''"> and
			to_date(#{INVOICE_DATE},'yyyy-mm-dd')>=to_date(#{INVOICE_DATE1},'yyyy-mm-dd')
		</if>
		<if test="INVOICE_DATE2 !=null and INVOICE_DATE2 !=''"> and to_date(#{INVOICE_DATE},'yyyy-mm-dd')
			&lt;=to_date(#{INVOICE_DATE2},'yyyy-mm-dd')</if>
		<if test="RESERVE_DATE1 !=null and RESERVE_DATE1 !=''"> and
			to_date(#{RESERVE_DATE},'yyyy-mm-dd')>=to_date(#{RESERVE_DATE1},'yyyy-mm-dd')
		</if>
		<if test="RESERVE_DATE2 !=null and RESERVE_DATE2 !=''"> and to_date(#{RESERVE_DATE},'yyyy-mm-dd')
			&lt;=to_date(#{RESERVE_DATE2},'yyyy-mm-dd')</if>
		union all
		select * from V_FI_FUND_PAYMENT_DETAIL where PLATFORM_TYPE not in
		(${NotInvoice}) and PAY_TYPE=2 and INVOICE_NUM is not null
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PROJECT_CODE != null and PROJECT_CODE != ''">and PROJECT_CODE like '%'||#{PROJECT_CODE}||'%'</if>
		<if test="PRODUCT_NAME != null and PRODUCT_NAME != ''">and PRODUCT_NAMES like '%'||#{PRODUCT_NAME}||'%'</if>
		<if test="COMP_NAME != null and COMP_NAME != ''">and COMP_NAME like '%'||#{COMP_NAME}||'%'</if>
		<if test="CUST_NAME != null and CUST_NAME != ''">and CUST_NAME like '%'||#{CUST_NAME}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="INVOICE_DATE1 !=null and INVOICE_DATE1 !=''"> and
			to_date(#{INVOICE_DATE},'yyyy-mm-dd')>=to_date(#{INVOICE_DATE1},'yyyy-mm-dd')
		</if>
		<if test="INVOICE_DATE2 !=null and INVOICE_DATE2 !=''"> and to_date(#{INVOICE_DATE},'yyyy-mm-dd')
			&lt;=to_date(#{INVOICE_DATE2},'yyyy-mm-dd')</if>
		<if test="RESERVE_DATE1 !=null and RESERVE_DATE1 !=''"> and
			to_date(#{RESERVE_DATE},'yyyy-mm-dd')>=to_date(#{RESERVE_DATE1},'yyyy-mm-dd')
		</if>
		<if test="RESERVE_DATE2 !=null and RESERVE_DATE2 !=''"> and to_date(#{RESERVE_DATE},'yyyy-mm-dd')
			&lt;=to_date(#{RESERVE_DATE2},'yyyy-mm-dd')</if>
		) t group by t.SUPPER_ID,t.SUPPER_NAME order by t.SUPPER_ID
	</select>

	<update id="updatePaymentDetailPayID" parameterType="java.util.Map">
		update FI_FUND_PAYMENT_DETAIL set PAYMENT_HEAD_ID=#{PAYMENT_HEAD_ID}
		<if test="RESERVE_DATE !=null and RESERVE_DATE !=''">,RESERVE_DATE=to_date(RESERVE_DATE=#{RESERVE_DATE},'yyyy-mm-dd')
		</if>
		where ID=#{payMent_ID}
	</update>

	<insert id="createPayMentHead" parameterType="java.util.Map">
		insert into fi_fund_payment_head(
		id
		, payment_code
		<if test="SUPPER_ID !=null and SUPPER_ID !=''">, SUPPER_ID</if>
		<if test="SUPPER_NAME !=null and SUPPER_NAME !=''">, SUPPER_NAME</if>
		<if test="COMP_ID !=null and COMP_ID !=''">, COMP_ID</if>
		<if test="COMP_NAME !=null and COMP_NAME !=''">, COMP_NAME</if>
		, ACCBILL_PRICE
		<if test="PAYMENT_MONEY !=null and PAYMENT_MONEY !=''">, BANKBILL_PRICE</if>
		<if test="PAYMENT_MONEY !=null and PAYMENT_MONEY !=''">, PAYMENT_MONEY</if>
		<if test="PAYMENT_MONEY !=null and PAYMENT_MONEY !=''">, LAST_MONEY</if>
		<if test="BEGGIN_DATE !=null and BEGGIN_DATE !=''">, BEGGIN_DATE</if>
		<if test="PROJECT_NUM !=null and PROJECT_NUM !=''">, PROJECT_NUM</if>
		<if test="PAYEE_NAME !=null and PAYEE_NAME !=''">, PAYEE_NAME</if>
		<if test="PAY_BANK_NAME !=null and PAY_BANK_NAME !=''">, PAY_BANK_NAME</if>
		<if test="PAY_BANK_ADDRESS !=null and PAY_BANK_ADDRESS !=''">, PAY_BANK_ADDRESS</if>
		<if test="PAY_BANK_ACCOUNT !=null and PAY_BANK_ACCOUNT !=''">, PAY_BANK_ACCOUNT</if>
		<if test="ORG_ID !=null and ORG_ID !=''">, ORG_ID</if>
		, status
		, create_id
		, create_date
		, type
		)
		values
		(
		#{PAYMENT_HEAD_ID}
		,#{PAYMENT_CODE}
		<if test="SUPPER_ID !=null and SUPPER_ID !=''">, #{SUPPER_ID}</if>
		<if test="SUPPER_NAME !=null and SUPPER_NAME !=''">, #{SUPPER_NAME}</if>
		<if test="COMP_ID !=null and COMP_ID !=''">, #{COMP_ID}</if>
		<if test="COMP_NAME !=null and COMP_NAME !=''">, #{COMP_NAME}</if>
		, 0
		<if test="PAYMENT_MONEY !=null and PAYMENT_MONEY !=''">, #{PAYMENT_MONEY}</if>
		<if test="PAYMENT_MONEY !=null and PAYMENT_MONEY !=''">, #{PAYMENT_MONEY}</if>
		<if test="PAYMENT_MONEY !=null and PAYMENT_MONEY !=''">, #{PAYMENT_MONEY}</if>
		<if test="BEGGIN_DATE !=null and BEGGIN_DATE !=''">, to_date(#{BEGGIN_DATE},'yyyy-MM-dd')</if>
		<if test="PROJECT_NUM !=null and PROJECT_NUM !=''">, #{PROJECT_NUM}</if>
		<if test="PAYEE_NAME !=null and PAYEE_NAME !=''">, #{PAYEE_NAME}</if>
		<if test="PAY_BANK_NAME !=null and PAY_BANK_NAME !=''">, #{PAY_BANK_NAME}</if>
		<if test="PAY_BANK_ADDRESS !=null and PAY_BANK_ADDRESS !=''">, #{PAY_BANK_ADDRESS}</if>
		<if test="PAY_BANK_ACCOUNT !=null and PAY_BANK_ACCOUNT !=''">, #{PAY_BANK_ACCOUNT}</if>
		<if test="ORG_ID !=null and ORG_ID !=''">, #{ORG_ID}</if>
		,1
		,#{USER_ID}
		,sysdate
		, #{TYPE}
		)
	</insert>

	<select id="queryPayMentDeatelByPayID" parameterType="java.util.Map"
		resultType="java.util.Map">
		select
		ffpd.SUPPER_ID,ffpd.SUPPER_NAME,ffpd.COMP_ID,ffpd.COMP_NAME,ffpd.PAYEE_NAME,ffpd.PAY_BANK_ACCOUNT,ffpd.PAY_BANK_ADDRESS,ffpd.PAY_BANK_NAME
		from FI_FUND_PAYMENT_DETAIL ffpd
		where ID=#{pay_ID}
	</select>

	<select id="pay_Head_Eq_Mg" parameterType="java.util.Map"
		resultType="java.util.Map">
		SELECT * FROM (
		SELECT CC.*,ROWNUM ROWNO FROM
		(
		select
		ID,PAYMENT_CODE,SUPPER_ID,SUPPER_NAME,COMP_ID,COMP_NAME,PAYMENT_MONEY,ACCBILL_PRICE
		,BANKBILL_PRICE,to_char(BEGGIN_DATE,'yyyy-MM-dd')
		BEGGIN_DATE,PROJECT_NUM,PAYEE_NAME,PAY_BANK_NAME,PAY_BANK_ADDRESS
		,PAY_BANK_ACCOUNT,STATUS,to_char(REALITY_DATE,'yyyy-MM-dd')
		REALITY_DATE,REALITY_BANK_NAME,CREATE_ID,CREATE_DATE,TYPE from
		fi_fund_payment_head t
		where type=1 and STATUS IN(1,7)
		<if test="ORG_LIST != null and ORG_LIST != ''">and ORG_ID in ${ORG_LIST}</if>
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PAYMENT_CODE != null and PAYMENT_CODE != ''">and PAYMENT_CODE like '%'||#{PAYMENT_CODE}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="BEGGIN_DATE1 !=null and BEGGIN_DATE1 !=''"> and BEGGIN_DATE>=to_date(#{BEGGIN_DATE1},'yyyy-mm-dd')
		</if>
		<if test="BEGGIN_DATE2 !=null and BEGGIN_DATE2 !=''"> and BEGGIN_DATE
			&lt;=to_date(#{BEGGIN_DATE2},'yyyy-mm-dd')</if>
		order by ID desc
		) CC where rownum &lt;=#{PAGE_END}
		) CCC
		WHERE CCC.ROWNO >= #{PAGE_BEGIN}
	</select>

	<select id="pay_Head_Eq_Mg_count" parameterType="java.util.Map"
		resultType="int">
		select count(ID) from fi_fund_payment_head where type=1 and STATUS
		IN(1,7)
		<if test="ORG_LIST != null and ORG_LIST != ''">and ORG_ID in ${ORG_LIST}</if>
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PAYMENT_CODE != null and PAYMENT_CODE != ''">and PAYMENT_CODE like '%'||#{PAYMENT_CODE}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="BEGGIN_DATE1 !=null and BEGGIN_DATE1 !=''"> and BEGGIN_DATE>=to_date(#{BEGGIN_DATE1},'yyyy-mm-dd')
		</if>
		<if test="BEGGIN_DATE2 !=null and BEGGIN_DATE2 !=''"> and BEGGIN_DATE
			&lt;=to_date(#{BEGGIN_DATE2},'yyyy-mm-dd')</if>
	</select>

	<select id="pay_Head_Other_Mg" parameterType="java.util.Map"
		resultType="java.util.Map">
		SELECT * FROM (
		SELECT CC.*,ROWNUM ROWNO FROM
		(
		select
		ID,PAYMENT_CODE,SUPPER_ID,SUPPER_NAME,COMP_ID,COMP_NAME,PAYMENT_MONEY,ACCBILL_PRICE
		,BANKBILL_PRICE,to_char(BEGGIN_DATE,'yyyy-MM-dd')
		BEGGIN_DATE,PROJECT_NUM,PAYEE_NAME,PAY_BANK_NAME,PAY_BANK_ADDRESS
		,PAY_BANK_ACCOUNT,STATUS,to_char(REALITY_DATE,'yyyy-MM-dd')
		REALITY_DATE,REALITY_BANK_NAME,CREATE_ID,CREATE_DATE,TYPE from
		fi_fund_payment_head t
		where type=4 and STATUS=1
		<if test="ORG_LIST != null and ORG_LIST != ''">and ORG_ID in ${ORG_LIST}</if>
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PAYMENT_CODE != null and PAYMENT_CODE != ''">and PAYMENT_CODE like '%'||#{PAYMENT_CODE}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="BEGGIN_DATE1 !=null and BEGGIN_DATE1 !=''"> and BEGGIN_DATE>=to_date(#{BEGGIN_DATE1},'yyyy-mm-dd')
		</if>
		<if test="BEGGIN_DATE2 !=null and BEGGIN_DATE2 !=''"> and BEGGIN_DATE
			&lt;=to_date(#{BEGGIN_DATE2},'yyyy-mm-dd')</if>
		order by ID desc
		) CC where rownum &lt;=#{PAGE_END}
		) CCC
		WHERE CCC.ROWNO >= #{PAGE_BEGIN}
	</select>

	<select id="pay_Head_Other_Mg_count" parameterType="java.util.Map"
		resultType="int">
		select count(ID) from fi_fund_payment_head where type=4 and STATUS=1
		<if test="ORG_LIST != null and ORG_LIST != ''">and ORG_ID in ${ORG_LIST}</if>
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PAYMENT_CODE != null and PAYMENT_CODE != ''">and PAYMENT_CODE like '%'||#{PAYMENT_CODE}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="BEGGIN_DATE1 !=null and BEGGIN_DATE1 !=''"> and BEGGIN_DATE>=to_date(#{BEGGIN_DATE1},'yyyy-mm-dd')
		</if>
		<if test="BEGGIN_DATE2 !=null and BEGGIN_DATE2 !=''"> and BEGGIN_DATE
			&lt;=to_date(#{BEGGIN_DATE2},'yyyy-mm-dd')</if>
	</select>

	<select id="pay_Head_DB_Mg" parameterType="java.util.Map"
		resultType="java.util.Map">
		SELECT * FROM (
		SELECT CC.*,ROWNUM ROWNO FROM
		(
		select
		ID,PAYMENT_CODE,SUPPER_ID,SUPPER_NAME,COMP_ID,COMP_NAME,PAYMENT_MONEY,ACCBILL_PRICE
		,BANKBILL_PRICE,to_char(BEGGIN_DATE,'yyyy-MM-dd')
		BEGGIN_DATE,PROJECT_NUM,PAYEE_NAME,PAY_BANK_NAME,PAY_BANK_ADDRESS
		,PAY_BANK_ACCOUNT,STATUS,to_char(REALITY_DATE,'yyyy-MM-dd')
		REALITY_DATE,REALITY_BANK_NAME,CREATE_ID,CREATE_DATE,TYPE from
		fi_fund_payment_head t
		where type=2 and STATUS=1
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PAYMENT_CODE != null and PAYMENT_CODE != ''">and PAYMENT_CODE like '%'||#{PAYMENT_CODE}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="BEGGIN_DATE1 !=null and BEGGIN_DATE1 !=''"> and BEGGIN_DATE>=to_date(#{BEGGIN_DATE1},'yyyy-mm-dd')
		</if>
		<if test="BEGGIN_DATE2 !=null and BEGGIN_DATE2 !=''"> and BEGGIN_DATE
			&lt;=to_date(#{BEGGIN_DATE2},'yyyy-mm-dd')</if>
		order by ID desc
		) CC where rownum &lt;=#{PAGE_END}
		) CCC
		WHERE CCC.ROWNO >= #{PAGE_BEGIN}
	</select>

	<select id="pay_Head_DB_count" parameterType="java.util.Map"
		resultType="int">
		select count(ID) from fi_fund_payment_head where type=2 and STATUS=1
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PAYMENT_CODE != null and PAYMENT_CODE != ''">and PAYMENT_CODE like '%'||#{PAYMENT_CODE}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="BEGGIN_DATE1 !=null and BEGGIN_DATE1 !=''"> and BEGGIN_DATE>=to_date(#{BEGGIN_DATE1},'yyyy-mm-dd')
		</if>
		<if test="BEGGIN_DATE2 !=null and BEGGIN_DATE2 !=''"> and BEGGIN_DATE
			&lt;=to_date(#{BEGGIN_DATE2},'yyyy-mm-dd')</if>
	</select>

	<update id="PayHead_Status" parameterType="java.util.Map">
		update fi_fund_payment_head set STATUS=#{STATUS}
		<if test="BANKBILL_PRICE != null and BANKBILL_PRICE != ''">, BANKBILL_PRICE=#{BANKBILL_PRICE}</if>
		<if test="ACCBILL_PRICE != null and ACCBILL_PRICE != ''">, ACCBILL_PRICE=#{ACCBILL_PRICE}</if>
		<if test="REALITY_DATE != null and REALITY_DATE != ''">, REALITY_DATE=to_date(#{REALITY_DATE},'yyyy-MM-dd')</if>
		<if test="REALITY_BANK_NAME != null and REALITY_BANK_NAME != ''">, REALITY_BANK_NAME=#{REALITY_BANK_NAME}</if>
		<if test="JBPM_ID != null and JBPM_ID != ''">, JBPM_ID=#{JBPM_ID}</if>
		where id=#{ID}
	</update>

	<update id="updatePayDetail_headID" parameterType="java.util.Map">
		update FI_FUND_PAYMENT_DETAIL set PAYMENT_HEAD_ID=null where
		PAYMENT_HEAD_ID=#{ID}
	</update>

	<update id="updatePayHead_headID" parameterType="java.util.Map">
		UPDATE FI_FUND_PAYMENT_HEAD T
		SET T.PAYMENT_MONEY =T.PAYMENT_MONEY - #{PAY_MONEY} ,
		T.LAST_MONEY = T.LAST_MONEY - #{PAY_MONEY} ,
		T.BANKBILL_PRICE = T.BANKBILL_PRICE - #{PAY_MONEY} ,
		T.PROJECT_NUM = T.PROJECT_NUM - 1 WHERE T.ID = #{ID} 
	</update>

	<update id="updatePayDetail_proCode" parameterType="java.util.Map">
		UPDATE FI_FUND_PAYMENT_DETAIL T SET T.PAYMENT_HEAD_ID = NULL WHERE
		T.PROJECT_CODE = #{PROJECT_CODE}
	</update>

	<update id="updatePaymentHeadById" parameterType="java.util.Map">
		UPDATE FI_FUND_PAYMENT_HEAD T SET T.STATUS = 7 , T.JBPM_ID = NULL ,PLAN_AMT
		= NULL,LIMIT_BOND = NULL WHERE T.ID = #{ID}
	</update>

	<delete id="delCreditAccountHeadById" parameterType="java.util.Map">
		DELETE FROM
		FI_CREDIT_CHANNEL_FUND_ACCOUNT WHERE FUND_ID = #{ID}
	</delete>
	<select id="queryProjectNumByHeadId" parameterType="java.util.Map"
		resultType="int">
		SELECT COUNT(0) FROM FI_FUND_PAYMENT_DETAIL T WHERE
		T.PAYMENT_HEAD_ID = #{ID}
	</select>

	<delete id="deletePayHead_ID" parameterType="java.util.Map">
		delete
		fi_fund_payment_head where ID=#{ID}
	</delete>

	<select id="pay_HeadBack_Eq_Mg" parameterType="java.util.Map"
		resultType="java.util.Map">
		SELECT * FROM (
		SELECT CC.*,ROWNUM ROWNO FROM
		(
		select
		ID,PAYMENT_CODE,SUPPER_ID,SUPPER_NAME,COMP_ID,COMP_NAME,round(PAYMENT_MONEY,2)
		PAYMENT_MONEY,ACCBILL_PRICE
		,BANKBILL_PRICE,to_char(BEGGIN_DATE,'yyyy-MM-dd')
		BEGGIN_DATE,PROJECT_NUM,PAYEE_NAME,PAY_BANK_NAME,PAY_BANK_ADDRESS
		,PAY_BANK_ACCOUNT,STATUS,to_char(REALITY_DATE,'yyyy-MM-dd')
		REALITY_DATE,REALITY_BANK_NAME,CREATE_ID,CREATE_DATE,TYPE
		,round(DEDUCTION_MONEY,2) DEDUCTION_MONEY,round(DEDUCTION_RATE,2)
		DEDUCTION_RATE,round(LAST_MONEY,2) LAST_MONEY
		from fi_fund_payment_head t
		where type=1 and STATUS=4
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PAYMENT_CODE != null and PAYMENT_CODE != ''">and PAYMENT_CODE like '%'||#{PAYMENT_CODE}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="BEGGIN_DATE1 !=null and BEGGIN_DATE1 !=''"> and BEGGIN_DATE>=to_date(#{BEGGIN_DATE1},'yyyy-mm-dd')
		</if>
		<if test="BEGGIN_DATE2 !=null and BEGGIN_DATE2 !=''"> and BEGGIN_DATE
			&lt;=to_date(#{BEGGIN_DATE2},'yyyy-mm-dd')</if>
		order by ID desc
		) CC where rownum &lt;=#{PAGE_END}
		) CCC
		WHERE CCC.ROWNO >= #{PAGE_BEGIN}
	</select>

	<select id="pay_HeadBack_Eq_Mg_count" parameterType="java.util.Map"
		resultType="int">
		select count(ID) from fi_fund_payment_head where type=1 and STATUS=4
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PAYMENT_CODE != null and PAYMENT_CODE != ''">and PAYMENT_CODE like '%'||#{PAYMENT_CODE}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="BEGGIN_DATE1 !=null and BEGGIN_DATE1 !=''"> and BEGGIN_DATE>=to_date(#{BEGGIN_DATE1},'yyyy-mm-dd')
		</if>
		<if test="BEGGIN_DATE2 !=null and BEGGIN_DATE2 !=''"> and BEGGIN_DATE
			&lt;=to_date(#{BEGGIN_DATE2},'yyyy-mm-dd')</if>
	</select>

	<select id="pay_HeadBack_Other_Mg" parameterType="java.util.Map"
		resultType="java.util.Map">
		SELECT * FROM (
		SELECT CC.*,ROWNUM ROWNO FROM
		(
		select
		ID,PAYMENT_CODE,SUPPER_ID,SUPPER_NAME,COMP_ID,COMP_NAME,PAYMENT_MONEY,ACCBILL_PRICE
		,BANKBILL_PRICE,to_char(BEGGIN_DATE,'yyyy-MM-dd')
		BEGGIN_DATE,PROJECT_NUM,PAYEE_NAME,PAY_BANK_NAME,PAY_BANK_ADDRESS
		,PAY_BANK_ACCOUNT,STATUS,to_char(REALITY_DATE,'yyyy-MM-dd')
		REALITY_DATE,REALITY_BANK_NAME,CREATE_ID,CREATE_DATE,TYPE from
		fi_fund_payment_head t
		where type=4 and STATUS=4
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PAYMENT_CODE != null and PAYMENT_CODE != ''">and PAYMENT_CODE like '%'||#{PAYMENT_CODE}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="BEGGIN_DATE1 !=null and BEGGIN_DATE1 !=''"> and BEGGIN_DATE>=to_date(#{BEGGIN_DATE1},'yyyy-mm-dd')
		</if>
		<if test="BEGGIN_DATE2 !=null and BEGGIN_DATE2 !=''"> and BEGGIN_DATE
			&lt;=to_date(#{BEGGIN_DATE2},'yyyy-mm-dd')</if>
		order by ID desc
		) CC where rownum &lt;=#{PAGE_END}
		) CCC
		WHERE CCC.ROWNO >= #{PAGE_BEGIN}
	</select>

	<select id="pay_HeadBack_Other_Mg_count" parameterType="java.util.Map"
		resultType="int">
		select count(ID) from fi_fund_payment_head where type=4 and STATUS=4
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PAYMENT_CODE != null and PAYMENT_CODE != ''">and PAYMENT_CODE like '%'||#{PAYMENT_CODE}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="BEGGIN_DATE1 !=null and BEGGIN_DATE1 !=''"> and BEGGIN_DATE>=to_date(#{BEGGIN_DATE1},'yyyy-mm-dd')
		</if>
		<if test="BEGGIN_DATE2 !=null and BEGGIN_DATE2 !=''"> and BEGGIN_DATE
			&lt;=to_date(#{BEGGIN_DATE2},'yyyy-mm-dd')</if>
	</select>

	<select id="pay_HeadBack_DB_Mg" parameterType="java.util.Map"
		resultType="java.util.Map">
		SELECT * FROM (
		SELECT CC.*,ROWNUM ROWNO FROM
		(
		select
		ID,PAYMENT_CODE,SUPPER_ID,SUPPER_NAME,COMP_ID,COMP_NAME,PAYMENT_MONEY,ACCBILL_PRICE
		,BANKBILL_PRICE,to_char(BEGGIN_DATE,'yyyy-MM-dd')
		BEGGIN_DATE,PROJECT_NUM,PAYEE_NAME,PAY_BANK_NAME,PAY_BANK_ADDRESS
		,PAY_BANK_ACCOUNT,STATUS,to_char(REALITY_DATE,'yyyy-MM-dd')
		REALITY_DATE,REALITY_BANK_NAME,CREATE_ID,CREATE_DATE,TYPE from
		fi_fund_payment_head t
		where type=2 and STATUS=4
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PAYMENT_CODE != null and PAYMENT_CODE != ''">and PAYMENT_CODE like '%'||#{PAYMENT_CODE}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="BEGGIN_DATE1 !=null and BEGGIN_DATE1 !=''"> and BEGGIN_DATE>=to_date(#{BEGGIN_DATE1},'yyyy-mm-dd')
		</if>
		<if test="BEGGIN_DATE2 !=null and BEGGIN_DATE2 !=''"> and BEGGIN_DATE
			&lt;=to_date(#{BEGGIN_DATE2},'yyyy-mm-dd')</if>
		order by ID desc
		) CC where rownum &lt;=#{PAGE_END}
		) CCC
		WHERE CCC.ROWNO >= #{PAGE_BEGIN}
	</select>

	<select id="pay_HeadBack_DB_count" parameterType="java.util.Map"
		resultType="int">
		select count(ID) from fi_fund_payment_head where type=2 and STATUS=4
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PAYMENT_CODE != null and PAYMENT_CODE != ''">and PAYMENT_CODE like '%'||#{PAYMENT_CODE}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="BEGGIN_DATE1 !=null and BEGGIN_DATE1 !=''"> and BEGGIN_DATE>=to_date(#{BEGGIN_DATE1},'yyyy-mm-dd')
		</if>
		<if test="BEGGIN_DATE2 !=null and BEGGIN_DATE2 !=''"> and BEGGIN_DATE
			&lt;=to_date(#{BEGGIN_DATE2},'yyyy-mm-dd')</if>
	</select>

	<select id="pay_Head_Query_Eq_Mg" parameterType="java.util.Map"
		resultType="java.util.Map">
		SELECT * FROM (
		SELECT CC.*,ROWNUM ROWNO FROM
		(
		select
		ffph.ID,ffph.PAYMENT_CODE,ffph.SUPPER_ID,ffph.SUPPER_NAME,ffph.COMP_ID,ffph.COMP_NAME,ffph.PAYMENT_MONEY,ffph.ACCBILL_PRICE
		,ffph.BANKBILL_PRICE,to_char(ffph.BEGGIN_DATE,'yyyy-MM-dd')
		BEGGIN_DATE,ffph.PROJECT_NUM,ffph.PAYEE_NAME,ffph.PAY_BANK_NAME,ffph.PAY_BANK_ADDRESS
		,ffph.PAY_BANK_ACCOUNT,ffph.STATUS,to_char(ffph.REALITY_DATE,'yyyy-MM-dd')
		REALITY_DATE,ffph.REALITY_BANK_NAME,ffph.CREATE_ID,ffph.CREATE_DATE,ffph.TYPE,tsdd.FLAG
		,round(DEDUCTION_MONEY,2) DEDUCTION_MONEY,round(DEDUCTION_RATE,2)
		DEDUCTION_RATE,round(LAST_MONEY,2) LAST_MONEY
		from fi_fund_payment_head ffph
		left join T_SYS_DATA_DICTIONARY tsdd on tsdd.type='放款状态' and
		to_char(ffph.STATUS)=tsdd.CODE
		left join t_sys_company tsc on ffph.COMP_ID=tsc.COMPANY_ID
		where ffph.type=1
		<if test="SUP_ID != null and SUP_ID != ''">and ffph.SUPPER_ID = #{SUP_ID}</if>
		<if test="COMP_ID != null and COMP_ID != ''">and tsc.BUSINESS_SECTOR IN (${COMP_ID})</if>
		<if test="COM_ID != null and COM_ID != ''">and FFPH.COMP_ID IN (${COM_ID})</if>
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and ffph.SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PAYMENT_CODE != null and PAYMENT_CODE != ''">and ffph.PAYMENT_CODE like '%'||#{PAYMENT_CODE}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and ffph.PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="BEGGIN_DATE1 !=null and BEGGIN_DATE1 !=''"> and
			ffph.BEGGIN_DATE>=to_date(#{BEGGIN_DATE1},'yyyy-mm-dd')</if>
		<if test="BEGGIN_DATE2 !=null and BEGGIN_DATE2 !=''"> and ffph.BEGGIN_DATE
			&lt;=to_date(#{BEGGIN_DATE2},'yyyy-mm-dd')</if>
		<if test="STATUS != null and STATUS != ''">and ffph.STATUS =#{STATUS}</if>
		order by ffph.ID desc
		) CC where rownum &lt;=#{PAGE_END}
		) CCC
		WHERE CCC.ROWNO >= #{PAGE_BEGIN}
	</select>

	<select id="pay_Head_Query_Eq_Mg_count" parameterType="java.util.Map"
		resultType="int">
		select count(ID) from fi_fund_payment_head ffph
		left join t_sys_company tsc on ffph.COMP_ID=tsc.COMPANY_ID
		where type=1
		<if test="SUP_ID != null and SUP_ID != ''">and SUPPER_ID = #{SUP_ID}</if>
		<if test="COMP_ID != null and COMP_ID != ''">and tsc.BUSINESS_SECTOR IN (${COMP_ID})</if>
		<if test="COM_ID != null and COM_ID != ''">and FFPH.COMP_ID IN (${COM_ID})</if>
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PAYMENT_CODE != null and PAYMENT_CODE != ''">and PAYMENT_CODE like '%'||#{PAYMENT_CODE}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="BEGGIN_DATE1 !=null and BEGGIN_DATE1 !=''"> and BEGGIN_DATE>=to_date(#{BEGGIN_DATE1},'yyyy-mm-dd')
		</if>
		<if test="BEGGIN_DATE2 !=null and BEGGIN_DATE2 !=''"> and BEGGIN_DATE
			&lt;=to_date(#{BEGGIN_DATE2},'yyyy-mm-dd')</if>
		<if test="STATUS != null and STATUS != ''">and ffph.STATUS =#{STATUS}</if>
	</select>

	<select id="pay_Head_Excle_Eq_Mg" parameterType="java.util.Map"
		resultType="java.util.Map">
		select
		ffph.ID,ffph.PAYMENT_CODE,ffph.SUPPER_ID,ffph.SUPPER_NAME,ffph.COMP_ID,ffph.COMP_NAME,ffph.PAYMENT_MONEY,ffph.ACCBILL_PRICE
		,ffph.BANKBILL_PRICE,to_char(ffph.BEGGIN_DATE,'yyyy-MM-dd')
		BEGGIN_DATE,ffph.PROJECT_NUM,ffph.PAYEE_NAME,ffph.PAY_BANK_NAME,ffph.PAY_BANK_ADDRESS
		,ffph.PAY_BANK_ACCOUNT,ffph.STATUS,to_char(ffph.REALITY_DATE,'yyyy-MM-dd')
		REALITY_DATE,ffph.REALITY_BANK_NAME,ffph.CREATE_ID,ffph.CREATE_DATE,ffph.TYPE,tsdd.FLAG
		,round(DEDUCTION_MONEY,2) DEDUCTION_MONEY,
		ROUND(100 - DEDUCTION_RATE, 2) PAYMENT_RATE,round(DEDUCTION_RATE,2)
		DEDUCTION_RATE,round(LAST_MONEY,2) LAST_MONEY
		from fi_fund_payment_head ffph
		left join T_SYS_DATA_DICTIONARY tsdd on tsdd.type='放款状态' and
		to_char(ffph.STATUS)=tsdd.CODE
		where ffph.type=1
		<if test="SUP_ID != null and SUP_ID != ''">and ffph.SUPPER_ID = #{SUP_ID}</if>
		<if test="COMP_ID != null and COMP_ID != ''">and ffph.COMP_ID IN (${COMP_ID})</if>
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and ffph.SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PAYMENT_CODE != null and PAYMENT_CODE != ''">and ffph.PAYMENT_CODE like '%'||#{PAYMENT_CODE}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and ffph.PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="BEGGIN_DATE1 !=null and BEGGIN_DATE1 !=''"> and
			ffph.BEGGIN_DATE>=to_date(#{BEGGIN_DATE1},'yyyy-mm-dd')</if>
		<if test="BEGGIN_DATE2 !=null and BEGGIN_DATE2 !=''"> and ffph.BEGGIN_DATE
			&lt;=to_date(#{BEGGIN_DATE2},'yyyy-mm-dd')</if>
		<if test="STATUS != null and STATUS != ''">and ffph.STATUS =#{STATUS}</if>
		order by FFPH.COMP_ID desc
	</select>

	<select id="pay_Head_Excle_Eq_Sum" parameterType="java.util.Map"
		resultType="java.util.Map">
		SELECT FFPH.COMP_NAME,
		ROUND(SUM(PAYMENT_MONEY), 2) PAYMENT_MONEY,
		ROUND(SUM(DEDUCTION_MONEY), 2) DEDUCTION_MONEY,
		ROUND(SUM(LAST_MONEY), 2) LAST_MONEY
		FROM FI_FUND_PAYMENT_HEAD FFPH
		LEFT JOIN T_SYS_DATA_DICTIONARY TSDD
		ON TSDD.TYPE = '放款状态'
		AND TO_CHAR(FFPH.STATUS) = TSDD.CODE
		WHERE FFPH.TYPE = 1
		<if test="SUP_ID != null and SUP_ID != ''">and ffph.SUPPER_ID = #{SUP_ID}</if>
		<if test="COMP_ID != null and COMP_ID != ''">and ffph.COMP_ID IN (${COMP_ID})</if>
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and ffph.SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PAYMENT_CODE != null and PAYMENT_CODE != ''">and ffph.PAYMENT_CODE like '%'||#{PAYMENT_CODE}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and ffph.PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="BEGGIN_DATE1 !=null and BEGGIN_DATE1 !=''"> and
			ffph.BEGGIN_DATE>=to_date(#{BEGGIN_DATE1},'yyyy-mm-dd')</if>
		<if test="BEGGIN_DATE2 !=null and BEGGIN_DATE2 !=''"> and ffph.BEGGIN_DATE
			&lt;=to_date(#{BEGGIN_DATE2},'yyyy-mm-dd')</if>
		<if test="STATUS != null and STATUS != ''">and ffph.STATUS =#{STATUS}</if>
		GROUP BY FFPH.COMP_NAME ORDER BY FFPH.COMP_ID DESC
	</select>


	<select id="pay_Head_Query_Other_Mg" parameterType="java.util.Map"
		resultType="java.util.Map">
		SELECT * FROM (
		SELECT CC.*,ROWNUM ROWNO FROM
		(
		select
		ffph.ID,ffph.PAYMENT_CODE,ffph.SUPPER_ID,ffph.SUPPER_NAME,ffph.COMP_ID,ffph.COMP_NAME,ffph.PAYMENT_MONEY,ffph.ACCBILL_PRICE
		,ffph.BANKBILL_PRICE,to_char(ffph.BEGGIN_DATE,'yyyy-MM-dd')
		BEGGIN_DATE,ffph.PROJECT_NUM,ffph.PAYEE_NAME,ffph.PAY_BANK_NAME,ffph.PAY_BANK_ADDRESS
		,ffph.PAY_BANK_ACCOUNT,ffph.STATUS,to_char(ffph.REALITY_DATE,'yyyy-MM-dd')
		REALITY_DATE,ffph.REALITY_BANK_NAME,ffph.CREATE_ID,ffph.CREATE_DATE,ffph.TYPE,tsdd.FLAG
		from fi_fund_payment_head ffph
		left join T_SYS_DATA_DICTIONARY tsdd on tsdd.type='放款状态' and
		to_char(ffph.STATUS)=tsdd.CODE
		where ffph.type=4
		<if test="SUP_ID != null and SUP_ID != ''">and ffph.SUPPER_ID = #{SUP_ID}</if>
		<if test="COM_ID != null and COM_ID != ''">and FFPH.COMP_ID IN (${COM_ID})</if>
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and ffph.SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PAYMENT_CODE != null and PAYMENT_CODE != ''">and ffph.PAYMENT_CODE like '%'||#{PAYMENT_CODE}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and ffph.PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="BEGGIN_DATE1 !=null and BEGGIN_DATE1 !=''"> and
			ffph.BEGGIN_DATE>=to_date(#{BEGGIN_DATE1},'yyyy-mm-dd')</if>
		<if test="BEGGIN_DATE2 !=null and BEGGIN_DATE2 !=''"> and ffph.BEGGIN_DATE
			&lt;=to_date(#{BEGGIN_DATE2},'yyyy-mm-dd')</if>
		<if test="STATUS != null and STATUS != ''">and ffph.STATUS =#{STATUS}</if>
		order by ffph.ID desc
		) CC where rownum &lt;=#{PAGE_END}
		) CCC
		WHERE CCC.ROWNO >= #{PAGE_BEGIN}
	</select>

	<select id="pay_Head_Query_Other_Mg_count" parameterType="java.util.Map"
		resultType="int">
		select count(ID) from fi_fund_payment_head where type=4
		<if test="SUP_ID != null and SUP_ID != ''">and SUPPER_ID = #{SUP_ID}</if>
		<if test="COM_ID != null and COM_ID != ''">and FFPH.COMP_ID IN (${COM_ID})</if>
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PAYMENT_CODE != null and PAYMENT_CODE != ''">and PAYMENT_CODE like '%'||#{PAYMENT_CODE}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="BEGGIN_DATE1 !=null and BEGGIN_DATE1 !=''"> and BEGGIN_DATE>=to_date(#{BEGGIN_DATE1},'yyyy-mm-dd')
		</if>
		<if test="BEGGIN_DATE2 !=null and BEGGIN_DATE2 !=''"> and BEGGIN_DATE
			&lt;=to_date(#{BEGGIN_DATE2},'yyyy-mm-dd')</if>
		<if test="STATUS != null and STATUS != ''">and STATUS =#{STATUS}</if>
	</select>

	<select id="pay_Head_Query_DB_Mg" parameterType="java.util.Map"
		resultType="java.util.Map">
		SELECT * FROM (
		SELECT CC.*,ROWNUM ROWNO FROM
		(
		select
		ffph.ID,ffph.PAYMENT_CODE,ffph.SUPPER_ID,ffph.SUPPER_NAME,ffph.COMP_ID,ffph.COMP_NAME,ffph.PAYMENT_MONEY,ffph.ACCBILL_PRICE
		,ffph.BANKBILL_PRICE,to_char(ffph.BEGGIN_DATE,'yyyy-MM-dd')
		BEGGIN_DATE,ffph.PROJECT_NUM,ffph.PAYEE_NAME,ffph.PAY_BANK_NAME,ffph.PAY_BANK_ADDRESS
		,ffph.PAY_BANK_ACCOUNT,ffph.STATUS,to_char(ffph.REALITY_DATE,'yyyy-MM-dd')
		REALITY_DATE,ffph.REALITY_BANK_NAME,ffph.CREATE_ID,ffph.CREATE_DATE,ffph.TYPE,tsdd.FLAG
		from fi_fund_payment_head ffph
		left join T_SYS_DATA_DICTIONARY tsdd on tsdd.type='放款状态' and
		to_char(ffph.STATUS)=tsdd.CODE
		where ffph.type=2
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and ffph.SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PAYMENT_CODE != null and PAYMENT_CODE != ''">and ffph.PAYMENT_CODE like '%'||#{PAYMENT_CODE}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and ffph.PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="BEGGIN_DATE1 !=null and BEGGIN_DATE1 !=''"> and
			ffph.BEGGIN_DATE>=to_date(#{BEGGIN_DATE1},'yyyy-mm-dd')</if>
		<if test="BEGGIN_DATE2 !=null and BEGGIN_DATE2 !=''"> and ffph.BEGGIN_DATE
			&lt;=to_date(#{BEGGIN_DATE2},'yyyy-mm-dd')</if>
		<if test="STATUS != null and STATUS != ''">and ffph.STATUS =#{STATUS}</if>
		order by ffph.ID desc
		) CC where rownum &lt;=#{PAGE_END}
		) CCC
		WHERE CCC.ROWNO >= #{PAGE_BEGIN}
	</select>

	<select id="pay_Head_Query_DB_count" parameterType="java.util.Map"
		resultType="int">
		select count(ID) from fi_fund_payment_head where type=2
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PAYMENT_CODE != null and PAYMENT_CODE != ''">and PAYMENT_CODE like '%'||#{PAYMENT_CODE}||'%'</if>
		<if test="STATUS != null and STATUS != ''">and STATUS =#{STATUS}</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="BEGGIN_DATE1 !=null and BEGGIN_DATE1 !=''"> and BEGGIN_DATE>=to_date(#{BEGGIN_DATE1},'yyyy-mm-dd')
		</if>
		<if test="BEGGIN_DATE2 !=null and BEGGIN_DATE2 !=''"> and BEGGIN_DATE
			&lt;=to_date(#{BEGGIN_DATE2},'yyyy-mm-dd')</if>
	</select>

	<update id="updateTwoPayMentS" parameterType="java.util.Map">
		update
		fi_fund_payment_detail set PAYMENT_ONE_SECCESS=1,COMPLEMENT_TYPE=2
		where ID in (
		select ID from fi_fund_payment_detail where PROJECT_CODE in (
		select PROJECT_CODE from fi_fund_payment_detail where PAYMENT_HEAD_ID=#{ID}
		and PAYMENT_NUM=1 and PAY_TYPE=1
		) and PAY_TYPE=1 and PAYMENT_NUM=2 and PAYMENT_ONE_SECCESS=0
		)
	</update>

	<select id="queryOneYouTwo" parameterType="java.util.Map"
		resultType="java.util.Map">
		SELECT T.ID
		FROM FI_FUND_PAYMENT_DETAIL T
		LEFT JOIN FI_FUND_PAYMENT_DETAIL TT
		ON TT.PROJECT_CODE = T.PROJECT_CODE
		WHERE T.PAYMENT_NUM = 1
		AND TT.PAYMENT_NUM = 2
		AND T.PAY_TYPE=1
		AND T.PAYMENT_ONE_SECCESS=0
		AND T.PAYMENT_HEAD_ID =#{ID}
	</select>

	<select id="pay_Detail_Eq_Mg" parameterType="java.util.Map"
		resultType="java.util.Map">
		SELECT * FROM (
		SELECT CC.*,ROWNUM ROWNO FROM
		(
		select t.*,case when t.USER_STATUS=1 then '未放款' when t.USER_STATUS=2 then
		'放款中' when t.USER_STATUS=3 then '已放款' end STATUS_FLAG from (
		select t.*,
		case when (t.payment_head_id is null) then 1
		when (t.payment_head_id is not null and t.status=1) then 2
		when t.status=2 then 3
		end USER_STATUS
		from (
		select * from V_FI_FUND_PAYMENT_DETAIL_All where PLATFORM_TYPE in (1,8) and
		PAY_TYPE=1
		union all
		select * from V_FI_FUND_PAYMENT_DETAIL_All where PLATFORM_TYPE not in (1,8)
		and PAY_TYPE=1 and INVOICE_NUM is not null
		) t ) t
		<where>
			<if test="SUP_ID != null and SUP_ID != ''">t.SUPPER_ID=#{SUP_ID}</if>
			<if test="COM_ID != null and COM_ID != ''">and t.COMP_ID IN (${COM_ID})</if>
			<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
			<if test="PROJECT_CODE != null and PROJECT_CODE != ''">and PROJECT_CODE like '%'||#{PROJECT_CODE}||'%'</if>
			<if test="PRODUCT_NAME != null and PRODUCT_NAME != ''">and PRODUCT_NAMES like '%'||#{PRODUCT_NAME}||'%'</if>
			<if test="COMP_NAME != null and COMP_NAME != ''">and COMP_NAME like '%'||#{COMP_NAME}||'%'</if>
			<if test="CUST_NAME != null and CUST_NAME != ''">and CUST_NAME like '%'||#{CUST_NAME}||'%'</if>
			<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
			<if test="INVOICE_DATE1 !=null and INVOICE_DATE1 !=''"> and
				to_date(INVOICE_DATE,'yyyy-mm-dd')>=to_date(#{INVOICE_DATE1},'yyyy-mm-dd')
			</if>
			<if test="INVOICE_DATE2 !=null and INVOICE_DATE2 !=''"> and to_date(INVOICE_DATE,'yyyy-mm-dd')
				&lt;=to_date(#{INVOICE_DATE2},'yyyy-mm-dd')</if>
			<if test="RESERVE_DATE1 !=null and RESERVE_DATE1 !=''"> and
				to_date(RESERVE_DATE,'yyyy-mm-dd')>=to_date(#{RESERVE_DATE1},'yyyy-mm-dd')
			</if>
			<if test="RESERVE_DATE2 !=null and RESERVE_DATE2 !=''"> and to_date(RESERVE_DATE,'yyyy-mm-dd')
				&lt;=to_date(#{RESERVE_DATE2},'yyyy-mm-dd')</if>
			<if test="PAYMENT_HEAD_ID != null and PAYMENT_HEAD_ID != ''">and PAYMENT_HEAD_ID =#{PAYMENT_HEAD_ID}</if>
			<if test="USER_STATUS != null and USER_STATUS != ''">and USER_STATUS =#{USER_STATUS}</if>
		</where>
		order by t.SUPPER_ID,t.PROJECT_CODE
		) CC
		) CCC
		<if test="PAGE_BEGIN!=null and PAGE_BEGIN!=''">WHERE CCC.ROWNO BETWEEN #{PAGE_BEGIN} AND #{PAGE_END}</if>
	</select>

	<select id="pay_Head_Excle_Sum" parameterType="java.util.Map"
		resultType="java.util.Map">
		SELECT FFPH.COMP_NAME,
		ROUND(SUM(PAYMENT_MONEY), 2) PAYMENT_MONEY,
		ROUND(SUM(DEDUCTION_MONEY), 2) DEDUCTION_MONEY,
		ROUND(SUM(BANKBILL_PRICE), 2) BANKBILL_PRICE,
		ROUND(SUM(ACCBILL_PRICE), 2) ACCBILL_PRICE
		FROM FI_FUND_PAYMENT_HEAD FFPH
		WHERE ffph.type=1 AND JBPM_ID=#{PAYMENT_JBPM_ID}
		<if test="COMP_ID != null and COMP_ID != ''"> AND ffph.COMP_ID IN (${COMP_ID})</if>
		GROUP BY FFPH.COMP_ID , FFPH.COMP_NAME ORDER BY FFPH.COMP_ID DESC
	</select>

	<select id="pay_Detail_Excle_Mg" parameterType="java.util.Map"
		resultType="java.util.Map">
		select
		ffph.ID,ffph.PAYMENT_CODE,ffph.SUPPER_ID,ffph.SUPPER_NAME,ffph.COMP_ID,ffph.COMP_NAME,ffph.PAYMENT_MONEY,ffph.ACCBILL_PRICE
		,ffph.BANKBILL_PRICE,to_char(ffph.BEGGIN_DATE,'yyyy-MM-dd')
		BEGGIN_DATE,ffph.PROJECT_NUM,ffph.PAYEE_NAME,ffph.PAY_BANK_NAME,ffph.PAY_BANK_ADDRESS
		,ffph.PAY_BANK_ACCOUNT,ffph.STATUS,to_char(ffph.REALITY_DATE,'yyyy-MM-dd')
		REALITY_DATE,ffph.REALITY_BANK_NAME,ffph.CREATE_ID,ffph.CREATE_DATE,ffph.TYPE,tsdd.FLAG
		,round(DEDUCTION_MONEY,2) DEDUCTION_MONEY,
		ROUND(100 - DEDUCTION_RATE, 2) PAYMENT_RATE,round(DEDUCTION_RATE,2)
		DEDUCTION_RATE,round(LAST_MONEY,2) LAST_MONEY
		from fi_fund_payment_head ffph
		left join T_SYS_DATA_DICTIONARY tsdd on tsdd.type='放款状态' and
		to_char(ffph.STATUS)=tsdd.CODE
		where ffph.type=1 AND JBPM_ID=#{PAYMENT_JBPM_ID}
		<if test="COMP_ID != null and COMP_ID != ''"> AND ffph.COMP_ID IN (${COMP_ID})</if>
		order by ID desc
	</select>

	<select id="queryPaymentJbpmMemo" parameterType="java.util.Map"
		resultType="java.util.Map">
		SELECT T.TASK_NAME,
		MAX(T.OP_NAME) OP_NAME,
		TO_CHAR(MAX(T.OP_TIME), 'YYYY-MM-DD') OP_TIME,
		MAX(H.OP_NAME) APP_NAME,
		TO_CHAR(MAX(H.START_), 'YYYY-MM-DD') APP_TIME
		FROM JBPM_MEMO T
		LEFT JOIN JBPM4_HIST_PROCT H
		ON H.ID_ = T.JBPM_ID
		WHERE H.PROJECT_ID = #{PAYMENT_JBPM_ID}
		GROUP BY T.TASK_NAME
	</select>

	<select id="pay_Detail_Eq_MgNew" parameterType="java.util.Map"
		resultType="java.util.Map">
		SELECT * FROM (
		SELECT CC.*,ROWNUM ROWNO FROM
		(
		select ID, (CASE WHEN T.PLAN_AMT IS NULL THEN NVL(FCC.PLAN_AMT,0) ELSE
		T.PLAN_AMT END) PLAN_AMT,NVL(LIMIT_BOND,0)
		LIMIT_BOND,PAYMENT_CODE,SUPPER_ID,SUPPER_NAME,COMP_ID,COMP_NAME,round(PAYMENT_MONEY,2)
		PAYMENT_MONEY,ACCBILL_PRICE
		,BANKBILL_PRICE,to_char(BEGGIN_DATE,'yyyy-MM-dd')
		BEGGIN_DATE,PROJECT_NUM,PAYEE_NAME,PAY_BANK_NAME,PAY_BANK_ADDRESS
		,PAY_BANK_ACCOUNT,STATUS,to_char(REALITY_DATE,'yyyy-MM-dd')
		REALITY_DATE,REALITY_BANK_NAME,CREATE_ID,CREATE_DATE,TYPE
		,round(DEDUCTION_MONEY,2) DEDUCTION_MONEY,round(DEDUCTION_RATE,2)
		DEDUCTION_RATE,round(LAST_MONEY,2) LAST_MONEY
		from fi_fund_payment_head t LEFT JOIN
		(SELECT SUM(NVL(TT.PLAN_AMT, 0)) - SUM(NVL(TT.FACT_AMT, 0)) -
		SUM(NVL(ACC.USED_AMT, 0)) PLAN_AMT,
		TT.SUP_ID
		FROM FI_CREDIT_CHANNEL_FUND TT
		LEFT JOIN (SELECT TA.APP_ID, NVL(SUM(TA.USED_AMT), 0) USED_AMT
		FROM FI_CREDIT_CHANNEL_FUND_ACCOUNT TA
		WHERE TA.STATUS = 0
		OR TA.STATUS IS NULL
		GROUP BY TA.APP_ID) ACC
		ON ACC.APP_ID = TT.ID
		WHERE TT.STATUS = 0
		GROUP BY TT.SUP_ID) FCC ON FCC.SUP_ID = SUPPER_ID
		where JBPM_ID=#{PAYMENT_JBPM_ID}
		order by ID desc
		) CC
		) CCC
		WHERE CCC.ROWNO BETWEEN #{PAGE_BEGIN} AND #{PAGE_END}
	</select>
	<select id="pay_Detail_Eq_Sum" parameterType="java.util.Map"
		resultType="java.util.Map">
		SELECT '合计' SUPPER_NAME,
		SUM(ROUND(PAYMENT_MONEY, 2)) PAYMENT_MONEY,
		SUM(ACCBILL_PRICE) ACCBILL_PRICE,
		SUM(BANKBILL_PRICE) BANKBILL_PRICE,
		SUM(PROJECT_NUM) PROJECT_NUM,
		SUM(ROUND(DEDUCTION_MONEY, 2)) DEDUCTION_MONEY,
		SUM(ROUND(LAST_MONEY, 2)) LAST_MONEY
		FROM FI_FUND_PAYMENT_HEAD T
		WHERE JBPM_ID = #{PAYMENT_JBPM_ID}
	</select>

	<select id="pay_Detail_Eq_MgNew_count" parameterType="java.util.Map"
		resultType="int">
		select count(1)
		from fi_fund_payment_head t
		where JBPM_ID=#{PAYMENT_JBPM_ID}
		order by ID desc
	</select>



	<select id="pay_Detail_Eq_Mg_count" parameterType="java.util.Map"
		resultType="int">
		select count(*) from (
		select t.*,
		case when (t.payment_head_id is null) then 1
		when (t.payment_head_id is not null and t.status=1) then 2
		when t.status=2 then 3
		end USER_STATUS
		from (
		select * from V_FI_FUND_PAYMENT_DETAIL_All where PLATFORM_TYPE in (1,8) and
		PAY_TYPE=1
		union all
		select * from V_FI_FUND_PAYMENT_DETAIL_All where PLATFORM_TYPE not in (1,8)
		and PAY_TYPE=1 and INVOICE_NUM is not null
		) t ) t
		<where>
			<if test="SUP_ID != null and SUP_ID != ''">t.SUPPER_ID=#{SUP_ID}</if>
			<if test="COM_ID != null and COM_ID != ''">and t.COMP_ID IN (${COM_ID})</if>
			<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
			<if test="PROJECT_CODE != null and PROJECT_CODE != ''">and PROJECT_CODE like '%'||#{PROJECT_CODE}||'%'</if>
			<if test="PRODUCT_NAME != null and PRODUCT_NAME != ''">and PRODUCT_NAMES like '%'||#{PRODUCT_NAME}||'%'</if>
			<if test="COMP_NAME != null and COMP_NAME != ''">and COMP_NAME like '%'||#{COMP_NAME}||'%'</if>
			<if test="CUST_NAME != null and CUST_NAME != ''">and CUST_NAME like '%'||#{CUST_NAME}||'%'</if>
			<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
			<if test="INVOICE_DATE1 !=null and INVOICE_DATE1 !=''"> and
				to_date(INVOICE_DATE,'yyyy-mm-dd')>=to_date(#{INVOICE_DATE1},'yyyy-mm-dd')
			</if>
			<if test="INVOICE_DATE2 !=null and INVOICE_DATE2 !=''"> and to_date(INVOICE_DATE,'yyyy-mm-dd')
				&lt;=to_date(#{INVOICE_DATE2},'yyyy-mm-dd')</if>
			<if test="RESERVE_DATE1 !=null and RESERVE_DATE1 !=''"> and
				to_date(RESERVE_DATE,'yyyy-mm-dd')>=to_date(#{RESERVE_DATE1},'yyyy-mm-dd')
			</if>
			<if test="RESERVE_DATE2 !=null and RESERVE_DATE2 !=''"> and to_date(RESERVE_DATE,'yyyy-mm-dd')
				&lt;=to_date(#{RESERVE_DATE2},'yyyy-mm-dd')</if>
			<if test="PAYMENT_HEAD_ID != null and PAYMENT_HEAD_ID != ''">and PAYMENT_HEAD_ID =#{PAYMENT_HEAD_ID}</if>
			<if test="USER_STATUS != null and USER_STATUS != ''">and USER_STATUS =#{USER_STATUS}</if>
		</where>
	</select>

	<select id="pay_Detail_Other_Mg" parameterType="java.util.Map"
		resultType="java.util.Map">
		SELECT * FROM (
		SELECT CC.*,ROWNUM ROWNO FROM
		(
		select t.* from(
		select * from V_FI_FUND_PAYMENT_DETAIL_All where PLATFORM_TYPE in
		(${NotInvoice}) and PAY_TYPE=4
		<if test="SUP_ID != null and SUP_ID != ''">and t.SUPPER_ID=#{SUP_ID}</if>
		<if test="COM_ID != null and COM_ID != ''">and T.COMP_ID IN (${COM_ID})</if>
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PROJECT_CODE != null and PROJECT_CODE != ''">and PROJECT_CODE like '%'||#{PROJECT_CODE}||'%'</if>
		<if test="PRODUCT_NAME != null and PRODUCT_NAME != ''">and PRODUCT_NAMES like '%'||#{PRODUCT_NAME}||'%'</if>
		<if test="COMP_NAME != null and COMP_NAME != ''">and COMP_NAME like '%'||#{COMP_NAME}||'%'</if>
		<if test="CUST_NAME != null and CUST_NAME != ''">and CUST_NAME like '%'||#{CUST_NAME}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="INVOICE_DATE1 !=null and INVOICE_DATE1 !=''"> and
			to_date(INVOICE_DATE,'yyyy-mm-dd')>=to_date(#{INVOICE_DATE1},'yyyy-mm-dd')
		</if>
		<if test="INVOICE_DATE2 !=null and INVOICE_DATE2 !=''"> and to_date(INVOICE_DATE,'yyyy-mm-dd')
			&lt;=to_date(#{INVOICE_DATE2},'yyyy-mm-dd')</if>
		<if test="RESERVE_DATE1 !=null and RESERVE_DATE1 !=''"> and
			to_date(RESERVE_DATE,'yyyy-mm-dd')>=to_date(#{RESERVE_DATE1},'yyyy-mm-dd')
		</if>
		<if test="RESERVE_DATE2 !=null and RESERVE_DATE2 !=''"> and to_date(RESERVE_DATE,'yyyy-mm-dd')
			&lt;=to_date(#{RESERVE_DATE2},'yyyy-mm-dd')</if>
		union all
		select * from V_FI_FUND_PAYMENT_DETAIL_All where PLATFORM_TYPE not in
		(${NotInvoice}) and PAY_TYPE=4 and INVOICE_NUM is not null
		<if test="SUP_ID != null and SUP_ID != ''">and t.SUPPER_ID=#{SUP_ID}</if>
		<if test="COM_ID != null and COM_ID != ''">and T.COMP_ID IN (${COM_ID})</if>
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PROJECT_CODE != null and PROJECT_CODE != ''">and PROJECT_CODE like '%'||#{PROJECT_CODE}||'%'</if>
		<if test="PRODUCT_NAME != null and PRODUCT_NAME != ''">and PRODUCT_NAMES like '%'||#{PRODUCT_NAME}||'%'</if>
		<if test="COMP_NAME != null and COMP_NAME != ''">and COMP_NAME like '%'||#{COMP_NAME}||'%'</if>
		<if test="CUST_NAME != null and CUST_NAME != ''">and CUST_NAME like '%'||#{CUST_NAME}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="INVOICE_DATE1 !=null and INVOICE_DATE1 !=''"> and
			to_date(INVOICE_DATE,'yyyy-mm-dd')>=to_date(#{INVOICE_DATE1},'yyyy-mm-dd')
		</if>
		<if test="INVOICE_DATE2 !=null and INVOICE_DATE2 !=''"> and to_date(INVOICE_DATE,'yyyy-mm-dd')
			&lt;=to_date(#{INVOICE_DATE2},'yyyy-mm-dd')</if>
		<if test="RESERVE_DATE1 !=null and RESERVE_DATE1 !=''"> and
			to_date(RESERVE_DATE,'yyyy-mm-dd')>=to_date(#{RESERVE_DATE1},'yyyy-mm-dd')
		</if>
		<if test="RESERVE_DATE2 !=null and RESERVE_DATE2 !=''"> and to_date(RESERVE_DATE,'yyyy-mm-dd')
			&lt;=to_date(#{RESERVE_DATE2},'yyyy-mm-dd')</if>
		) t order by t.SUPPER_ID,t.PROJECT_CODE
		) CC where rownum &lt;=#{PAGE_END}
		) CCC
		WHERE CCC.ROWNO >= #{PAGE_BEGIN}
	</select>

	<select id="pay_Detail_Other_Mg_count" parameterType="java.util.Map"
		resultType="int">

		select count(*) from(
		select * from V_FI_FUND_PAYMENT_DETAIL_All where PLATFORM_TYPE in
		(${NotInvoice}) and PAY_TYPE=4
		<if test="SUP_ID != null and SUP_ID != ''">and t.SUPPER_ID=#{SUP_ID}</if>
		<if test="COM_ID != null and COM_ID != ''">and T.COMP_ID IN (${COM_ID})</if>
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PROJECT_CODE != null and PROJECT_CODE != ''">and PROJECT_CODE like '%'||#{PROJECT_CODE}||'%'</if>
		<if test="PRODUCT_NAME != null and PRODUCT_NAME != ''">and PRODUCT_NAMES like '%'||#{PRODUCT_NAME}||'%'</if>
		<if test="COMP_NAME != null and COMP_NAME != ''">and COMP_NAME like '%'||#{COMP_NAME}||'%'</if>
		<if test="CUST_NAME != null and CUST_NAME != ''">and CUST_NAME like '%'||#{CUST_NAME}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="INVOICE_DATE1 !=null and INVOICE_DATE1 !=''"> and
			to_date(INVOICE_DATE,'yyyy-mm-dd')>=to_date(#{INVOICE_DATE1},'yyyy-mm-dd')
		</if>
		<if test="INVOICE_DATE2 !=null and INVOICE_DATE2 !=''"> and to_date(INVOICE_DATE,'yyyy-mm-dd')
			&lt;=to_date(#{INVOICE_DATE2},'yyyy-mm-dd')</if>
		<if test="RESERVE_DATE1 !=null and RESERVE_DATE1 !=''"> and
			to_date(RESERVE_DATE,'yyyy-mm-dd')>=to_date(#{RESERVE_DATE1},'yyyy-mm-dd')
		</if>
		<if test="RESERVE_DATE2 !=null and RESERVE_DATE2 !=''"> and to_date(RESERVE_DATE,'yyyy-mm-dd')
			&lt;=to_date(#{RESERVE_DATE2},'yyyy-mm-dd')</if>
		union all
		select * from V_FI_FUND_PAYMENT_DETAIL_All where PLATFORM_TYPE not in
		(${NotInvoice}) and PAY_TYPE=4 and INVOICE_NUM is not null
		<if test="SUP_ID != null and SUP_ID != ''">and t.SUPPER_ID=#{SUP_ID}</if>
		<if test="COM_ID != null and COM_ID != ''">and T.COMP_ID IN (${COM_ID})</if>
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PROJECT_CODE != null and PROJECT_CODE != ''">and PROJECT_CODE like '%'||#{PROJECT_CODE}||'%'</if>
		<if test="PRODUCT_NAME != null and PRODUCT_NAME != ''">and PRODUCT_NAMES like '%'||#{PRODUCT_NAME}||'%'</if>
		<if test="COMP_NAME != null and COMP_NAME != ''">and COMP_NAME like '%'||#{COMP_NAME}||'%'</if>
		<if test="CUST_NAME != null and CUST_NAME != ''">and CUST_NAME like '%'||#{CUST_NAME}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="INVOICE_DATE1 !=null and INVOICE_DATE1 !=''"> and
			to_date(INVOICE_DATE,'yyyy-mm-dd')>=to_date(#{INVOICE_DATE1},'yyyy-mm-dd')
		</if>
		<if test="INVOICE_DATE2 !=null and INVOICE_DATE2 !=''"> and to_date(INVOICE_DATE,'yyyy-mm-dd')
			&lt;=to_date(#{INVOICE_DATE2},'yyyy-mm-dd')</if>
		<if test="RESERVE_DATE1 !=null and RESERVE_DATE1 !=''"> and
			to_date(RESERVE_DATE,'yyyy-mm-dd')>=to_date(#{RESERVE_DATE1},'yyyy-mm-dd')
		</if>
		<if test="RESERVE_DATE2 !=null and RESERVE_DATE2 !=''"> and to_date(RESERVE_DATE,'yyyy-mm-dd')
			&lt;=to_date(#{RESERVE_DATE2},'yyyy-mm-dd')</if>
		) t

	</select>

	<select id="pay_Detail_DB_Mg" parameterType="java.util.Map"
		resultType="java.util.Map">
		SELECT * FROM (
		SELECT CC.*,ROWNUM ROWNO FROM
		(
		select t.* from(
		select * from V_FI_FUND_PAYMENT_DETAIL_All where PLATFORM_TYPE in
		(${NotInvoice}) and PAY_TYPE=2
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PROJECT_CODE != null and PROJECT_CODE != ''">and PROJECT_CODE like '%'||#{PROJECT_CODE}||'%'</if>
		<if test="PRODUCT_NAME != null and PRODUCT_NAME != ''">and PRODUCT_NAMES like '%'||#{PRODUCT_NAME}||'%'</if>
		<if test="COMP_NAME != null and COMP_NAME != ''">and COMP_NAME like '%'||#{COMP_NAME}||'%'</if>
		<if test="CUST_NAME != null and CUST_NAME != ''">and CUST_NAME like '%'||#{CUST_NAME}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="INVOICE_DATE1 !=null and INVOICE_DATE1 !=''"> and
			to_date(INVOICE_DATE,'yyyy-mm-dd')>=to_date(#{INVOICE_DATE1},'yyyy-mm-dd')
		</if>
		<if test="INVOICE_DATE2 !=null and INVOICE_DATE2 !=''"> and to_date(INVOICE_DATE,'yyyy-mm-dd')
			&lt;=to_date(#{INVOICE_DATE2},'yyyy-mm-dd')</if>
		<if test="RESERVE_DATE1 !=null and RESERVE_DATE1 !=''"> and
			to_date(RESERVE_DATE,'yyyy-mm-dd')>=to_date(#{RESERVE_DATE1},'yyyy-mm-dd')
		</if>
		<if test="RESERVE_DATE2 !=null and RESERVE_DATE2 !=''"> and to_date(RESERVE_DATE,'yyyy-mm-dd')
			&lt;=to_date(#{RESERVE_DATE2},'yyyy-mm-dd')</if>
		union all
		select * from V_FI_FUND_PAYMENT_DETAIL_All where PLATFORM_TYPE not in
		(${NotInvoice}) and PAY_TYPE=2 and INVOICE_NUM is not null
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PROJECT_CODE != null and PROJECT_CODE != ''">and PROJECT_CODE like '%'||#{PROJECT_CODE}||'%'</if>
		<if test="PRODUCT_NAME != null and PRODUCT_NAME != ''">and PRODUCT_NAMES like '%'||#{PRODUCT_NAME}||'%'</if>
		<if test="COMP_NAME != null and COMP_NAME != ''">and COMP_NAME like '%'||#{COMP_NAME}||'%'</if>
		<if test="CUST_NAME != null and CUST_NAME != ''">and CUST_NAME like '%'||#{CUST_NAME}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="INVOICE_DATE1 !=null and INVOICE_DATE1 !=''"> and
			to_date(INVOICE_DATE,'yyyy-mm-dd')>=to_date(#{INVOICE_DATE1},'yyyy-mm-dd')
		</if>
		<if test="INVOICE_DATE2 !=null and INVOICE_DATE2 !=''"> and to_date(INVOICE_DATE,'yyyy-mm-dd')
			&lt;=to_date(#{INVOICE_DATE2},'yyyy-mm-dd')</if>
		<if test="RESERVE_DATE1 !=null and RESERVE_DATE1 !=''"> and
			to_date(RESERVE_DATE,'yyyy-mm-dd')>=to_date(#{RESERVE_DATE1},'yyyy-mm-dd')
		</if>
		<if test="RESERVE_DATE2 !=null and RESERVE_DATE2 !=''"> and to_date(RESERVE_DATE,'yyyy-mm-dd')
			&lt;=to_date(#{RESERVE_DATE2},'yyyy-mm-dd')</if>
		) t order by t.SUPPER_ID,t.PROJECT_CODE
		) CC where rownum &lt;=#{PAGE_END}
		) CCC
		WHERE CCC.ROWNO >= #{PAGE_BEGIN}
	</select>

	<select id="pay_Detail_DB_Mg_count" parameterType="java.util.Map"
		resultType="int">

		select count(*) from(
		select * from V_FI_FUND_PAYMENT_DETAIL_All where PLATFORM_TYPE in
		(${NotInvoice}) and PAY_TYPE=2
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PROJECT_CODE != null and PROJECT_CODE != ''">and PROJECT_CODE like '%'||#{PROJECT_CODE}||'%'</if>
		<if test="PRODUCT_NAME != null and PRODUCT_NAME != ''">and PRODUCT_NAMES like '%'||#{PRODUCT_NAME}||'%'</if>
		<if test="COMP_NAME != null and COMP_NAME != ''">and COMP_NAME like '%'||#{COMP_NAME}||'%'</if>
		<if test="CUST_NAME != null and CUST_NAME != ''">and CUST_NAME like '%'||#{CUST_NAME}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="INVOICE_DATE1 !=null and INVOICE_DATE1 !=''"> and
			to_date(INVOICE_DATE,'yyyy-mm-dd')>=to_date(#{INVOICE_DATE1},'yyyy-mm-dd')
		</if>
		<if test="INVOICE_DATE2 !=null and INVOICE_DATE2 !=''"> and to_date(INVOICE_DATE,'yyyy-mm-dd')
			&lt;=to_date(#{INVOICE_DATE2},'yyyy-mm-dd')</if>
		<if test="RESERVE_DATE1 !=null and RESERVE_DATE1 !=''"> and
			to_date(RESERVE_DATE,'yyyy-mm-dd')>=to_date(#{RESERVE_DATE1},'yyyy-mm-dd')
		</if>
		<if test="RESERVE_DATE2 !=null and RESERVE_DATE2 !=''"> and to_date(RESERVE_DATE,'yyyy-mm-dd')
			&lt;=to_date(#{RESERVE_DATE2},'yyyy-mm-dd')</if>
		union all
		select * from V_FI_FUND_PAYMENT_DETAIL_All where PLATFORM_TYPE not in
		(${NotInvoice}) and PAY_TYPE=2 and INVOICE_NUM is not null
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PROJECT_CODE != null and PROJECT_CODE != ''">and PROJECT_CODE like '%'||#{PROJECT_CODE}||'%'</if>
		<if test="PRODUCT_NAME != null and PRODUCT_NAME != ''">and PRODUCT_NAMES like '%'||#{PRODUCT_NAME}||'%'</if>
		<if test="COMP_NAME != null and COMP_NAME != ''">and COMP_NAME like '%'||#{COMP_NAME}||'%'</if>
		<if test="CUST_NAME != null and CUST_NAME != ''">and CUST_NAME like '%'||#{CUST_NAME}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="INVOICE_DATE1 !=null and INVOICE_DATE1 !=''"> and
			to_date(INVOICE_DATE,'yyyy-mm-dd')>=to_date(#{INVOICE_DATE1},'yyyy-mm-dd')
		</if>
		<if test="INVOICE_DATE2 !=null and INVOICE_DATE2 !=''"> and to_date(INVOICE_DATE,'yyyy-mm-dd')
			&lt;=to_date(#{INVOICE_DATE2},'yyyy-mm-dd')</if>
		<if test="RESERVE_DATE1 !=null and RESERVE_DATE1 !=''"> and
			to_date(RESERVE_DATE,'yyyy-mm-dd')>=to_date(#{RESERVE_DATE1},'yyyy-mm-dd')
		</if>
		<if test="RESERVE_DATE2 !=null and RESERVE_DATE2 !=''"> and to_date(RESERVE_DATE,'yyyy-mm-dd')
			&lt;=to_date(#{RESERVE_DATE2},'yyyy-mm-dd')</if>
		) t

	</select>

	<select id="PayCodeCreate" parameterType="java.util.Map"
		resultType="java.util.Map">
		select create_fk_Id() as PAYMENT_CODE from dual
	</select>

	<select id="queryPayMentDeProHead" parameterType="java.util.Map"
		resultType="java.util.Map">
		select ffpd.ID,ROUND(ffpd.PAY_MONEY,2) PAY_MONEY,fph.ID
		PROJECT_ID , FFPD.PAY_NAME from fi_fund_payment_detail ffpd
		left join
		fil_project_head fph on ffpd.PROJECT_CODE=fph.PRO_CODE
		where
		ffpd.ID=#{ID}
	</select>

	<select id="queryPayMentOneList" parameterType="java.util.Map"
		resultType="java.util.Map">
		select ID from fi_fund_payment_detail where
		PAYMENT_HEAD_ID=#{ID} and id not in (${IDS}) and PAY_TYPE=1
	</select>

	<select id="queryChaeShouQi" parameterType="java.util.Map"
		resultType="java.util.Map">
		select to_char(nvl(ffph.REALITY_DATE,sysdate),'yyyy-MM-dd') PAY_DATE,fph.ID
		PROJECT_ID,fps.value_str from fi_fund_payment_head ffph
		left join fi_fund_payment_detail ffpd on ffpd.PAYMENT_HEAD_ID=ffph.ID
		left join fil_project_head fph on fph.pro_code=ffpd.PROJECT_CODE
		left join fil_project_scheme fps on fph.id=fps.PROJECT_ID
		where ffph.ID=#{ID} and ffpd.PAY_TYPE=1 and ffpd.PAYMENT_NUM=1
		and fps.key_name_en='PAYMENT_STATUS' and fps.value_str in (2,3,4)
		group by fph.ID,ffph.REALITY_DATE,fps.value_str
	</select>

	<select id="queryChaeShouQi4" parameterType="java.util.Map"
		resultType="java.util.Map">
		select to_char(nvl(ffph.REALITY_DATE,sysdate),'yyyy-MM-dd') PAY_DATE,fph.ID
		PROJECT_ID,fps.value_str from fi_fund_payment_head ffph
		left join fi_fund_payment_detail ffpd on ffpd.PAYMENT_HEAD_ID=ffph.ID
		left join fil_project_head fph on fph.pro_code=ffpd.PROJECT_CODE
		left join fil_project_scheme fps on fph.id=fps.PROJECT_ID
		where ffph.ID=#{ID} and ffpd.PAY_TYPE=1 and ffpd.PAYMENT_NUM=1
		and fps.key_name_en='PAYMENT_STATUS' and fps.value_str='4'
		group by fph.ID,ffph.REALITY_DATE,fps.value_str
	</select>

	<update id="updateProj_sub1" parameterType="Map">
		update fil_proj_sub_info set
		FK_RATIO=nvl(FK_RATIO,0)+70,PLAN_MONEY=nvl(PLAN_MONEY,0)+${PAY_MONEY}
		where PROJ_ID=#{PROJECT_ID}
	 </update>

	<update id="updateProj_sub2" parameterType="Map">
		update fil_proj_sub_info set
		FK_RATIO=100,PLAN_MONEY=nvl(PLAN_MONEY,0)+${PAY_MONEY} where
		PROJ_ID=#{PROJECT_ID}
	 </update>

	<update id="PayMentPassStatue" parameterType="Map">
		update fi_fund_payment_head set
		DEDUCTION_MONEY=#{MONEY},DEDUCTION_RATE=#{RATE},LAST_MONEY=#{LASEMONEY},STATUS=4
		<if test="ACCBILL_PRICE != null and ACCBILL_PRICE != ''">,ACCBILL_PRICE = #{ACCBILL_PRICE}</if>
		<if test="BANKBILL_PRICE != null and BANKBILL_PRICE != ''">,BANKBILL_PRICE = #{BANKBILL_PRICE} </if>
		where ID=#{PAYMENT_HEAD_ID}
	</update>

	<update id="PayMentJBPMPassStatue" parameterType="Map">
		update fi_fund_payment_head set STATUS=4
		where JBPM_ID=#{JBPM_ID}
	 </update>

	<select id="payMentPool" parameterType="java.util.Map"
		resultType="java.util.Map">
		select ID,SUPPER_ID,round(nvl(DEDUCTION_MONEY,0),2)
		DEDUCTION_MONEY,to_char(REALITY_DATE,'yyyy-MM-dd') REALITY_DATE from
		fi_fund_payment_head where ID=#{ID}
	 </select>

	<insert id="insertPoolDate" parameterType="Map">
		insert into FI_DEPOSIT_POOL
		(
		POOL_ID
		<if test="OWNER_ID != null and OWNER_ID != ''">,OWNER_ID</if>
		<if test="BASE_MONEY != null and BASE_MONEY != ''">,BASE_MONEY</if>
		<if test="CANUSE_MONEY != null and CANUSE_MONEY != ''">,CANUSE_MONEY</if>
		<if test="STATUS != null and STATUS != ''">,STATUS</if>
		<if test="PAY_TIME != null and PAY_TIME != ''">,PAY_TIME</if>
		<if test="TYPE != null and TYPE != ''">,TYPE</if>
		<if test="SOURCE_ID != null and SOURCE_ID != ''">,SOURCE_ID</if>
		)values
		(
		SEQ_FI_DEPOSIT_POOL.nextval
		<if test="OWNER_ID != null and OWNER_ID != ''">,#{OWNER_ID}</if>
		<if test="BASE_MONEY != null and BASE_MONEY != ''">,#{BASE_MONEY}</if>
		<if test="CANUSE_MONEY != null and CANUSE_MONEY != ''">,#{CANUSE_MONEY}</if>
		<if test="STATUS != null and STATUS != ''">,#{STATUS}</if>
		<if test="PAY_TIME != null and PAY_TIME != ''">,to_date(#{PAY_TIME},'yyyy-MM-dd')</if>
		<if test="TYPE != null and TYPE != ''">,#{TYPE}</if>
		<if test="SOURCE_ID != null and SOURCE_ID != ''">,#{SOURCE_ID}</if>
		)
	</insert>

	<update id="updatePayMent" parameterType="Map">
		update fi_fund_payment_head set ID=#{ID}
		<if test="REALITY_DATE != null and REALITY_DATE != ''">,REALITY_DATE= to_date(#{REALITY_DATE},'yyyy-MM-dd')</if>
		<if test="REALITY_BANK_NAME != null and REALITY_BANK_NAME != ''">,REALITY_BANK_NAME=#{REALITY_BANK_NAME}</if>
		<if test="ACCBILL_PRICE != null and ACCBILL_PRICE != ''">,ACCBILL_PRICE=#{ACCBILL_PRICE}</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">,PAYEE_NAME=#{PAYEE_NAME}</if>
		<if test="PAY_BANK_ACCOUNT != null and PAY_BANK_ACCOUNT != ''">,PAY_BANK_ACCOUNT=#{PAY_BANK_ACCOUNT}</if>
		<if test="PAY_BANK_NAME != null and PAY_BANK_NAME != ''">,PAY_BANK_NAME=#{PAY_BANK_NAME}</if>
		<if test="PAY_BANK_ADDRESS != null and PAY_BANK_ADDRESS != ''">,PAY_BANK_ADDRESS=#{PAY_BANK_ADDRESS}</if>
		<if test="BANKBILL_PRICE != null and BANKBILL_PRICE != ''">,BANKBILL_PRICE=#{BANKBILL_PRICE}</if>
		where ID=#{ID}
	</update>

	<update id="updatePayMentDeatilDate" parameterType="Map">
		update fi_fund_payment_DETAIL set payment_head_id=#{ID}
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">,PAYEE_NAME=#{PAYEE_NAME}</if>
		<if test="PAY_BANK_ACCOUNT != null and PAY_BANK_ACCOUNT != ''">,PAY_BANK_ACCOUNT=#{PAY_BANK_ACCOUNT}</if>
		<if test="PAY_BANK_NAME != null and PAY_BANK_NAME != ''">,PAY_BANK_NAME=#{PAY_BANK_NAME}</if>
		where payment_head_id=#{ID}
	</update>

	<delete id="deletePayMentDetail" parameterType="Map">
		delete FI_FUND_PAYMENT_DETAIL where PROJECT_CODE=(select PRO_CODE from
		fil_project_head where ID=#{PROJECT_ID})
	 </delete>

	<select id="orgListByUserId" parameterType="java.util.Map"
		resultType="map">
		select a.org_id,b.name org_name from secu_user_org a
		left
		join secu_org b on a.org_id=b.id
		where a.user_id=#{USER_ID} and
		rownum=1
		group by a.org_id,b.name
	</select>

	<select id="EQ_UPLOAD_DATE" parameterType="java.util.Map"
		resultType="map">
		select t.*,rownum ROW_NUM from (
		select t.*,case when t.USER_STATUS=1
		then '未放款' when t.USER_STATUS=2 then '放款中' when t.USER_STATUS=3 then
		'已放款' end STATUS_FLAG from (
		select t.*,
		case when (t.payment_head_id is null) then 1
		when (t.payment_head_id is not null and t.status=1) then 2
		when t.status=2 then 3
		end USER_STATUS
		from (
		select * from V_FI_FUND_PAYMENT_DETAIL_All where PLATFORM_TYPE in (1,8) and
		PAY_TYPE=1
		union all
		select * from V_FI_FUND_PAYMENT_DETAIL_All where PLATFORM_TYPE not in (1,8)
		and PAY_TYPE=1 and INVOICE_NUM is not null
		) t ) t
		<where>
			<if test="ORG_LIST != null and ORG_LIST != ''">t.ORG_ID in ${ORG_LIST}</if>
			<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
			<if test="PROJECT_CODE != null and PROJECT_CODE != ''">and PROJECT_CODE like '%'||#{PROJECT_CODE}||'%'</if>
			<if test="PRODUCT_NAME != null and PRODUCT_NAME != ''">and PRODUCT_NAMES like '%'||#{PRODUCT_NAME}||'%'</if>
			<if test="COMP_NAME != null and COMP_NAME != ''">and COMP_NAME like '%'||#{COMP_NAME}||'%'</if>
			<if test="CUST_NAME != null and CUST_NAME != ''">and CUST_NAME like '%'||#{CUST_NAME}||'%'</if>
			<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
			<if test="INVOICE_DATE1 !=null and INVOICE_DATE1 !=''"> and
				to_date(INVOICE_DATE,'yyyy-mm-dd')>=to_date(#{INVOICE_DATE1},'yyyy-mm-dd')
			</if>
			<if test="INVOICE_DATE2 !=null and INVOICE_DATE2 !=''"> and to_date(INVOICE_DATE,'yyyy-mm-dd')
				&lt;=to_date(#{INVOICE_DATE2},'yyyy-mm-dd')</if>
			<if test="RESERVE_DATE1 !=null and RESERVE_DATE1 !=''"> and
				to_date(RESERVE_DATE,'yyyy-mm-dd')>=to_date(#{RESERVE_DATE1},'yyyy-mm-dd')
			</if>
			<if test="RESERVE_DATE2 !=null and RESERVE_DATE2 !=''"> and to_date(RESERVE_DATE,'yyyy-mm-dd')
				&lt;=to_date(#{RESERVE_DATE2},'yyyy-mm-dd')</if>
			<if test="PAYMENT_HEAD_ID != null and PAYMENT_HEAD_ID != ''">and PAYMENT_HEAD_ID =#{PAYMENT_HEAD_ID}</if>
			<if test="USER_STATUS != null and USER_STATUS != ''">and USER_STATUS =#{USER_STATUS}</if>
			<if test="IDS != null and IDS != ''">and ID in (${IDS})</if>
			<if test="SUP_ID != null and SUP_ID != ''">and t.SUPPER_ID =#{SUP_ID}</if>
			<if test="COM_ID != null and COM_ID != ''">and T.COMP_ID IN (${COM_ID})</if>
		</where>
		order by t.SUPPER_ID,t.PROJECT_CODE
		) t
	</select>

	<select id="pay_Detail_Query_Eq_Date" parameterType="java.util.Map"
		resultType="map">
		select t.*,case when t.USER_STATUS=1 then '未放款' when
		t.USER_STATUS=2 then '放款中' when t.USER_STATUS=3 then '已放款' end
		STATUS_FLAG from (
		select t.*,
		case when (t.payment_head_id is null) then 1
		when (t.payment_head_id is not null and t.status=1) then 2
		when t.status=2 then 3
		end USER_STATUS
		from (
		select * from V_FI_FUND_PAYMENT_DETAIL_All where PAY_TYPE=1 and
		PAYMENT_HEAD_ID=#{HEAD_ID}
		) t ) t 
	</select>

	<select id="pay_Detail_Query_Eq_Sum" parameterType="java.util.Map"
		resultType="map">
		SELECT '合计' PROJECT_CODE , SUM(PAY_MONEY) PAY_MONEY
		FROM V_FI_FUND_PAYMENT_DETAIL_ALL
		WHERE PAY_TYPE = 1
		AND PAYMENT_HEAD_ID = #{HEAD_ID}
	</select>

	<update id="updatePayDetailStatus" parameterType="java.util.Map">
		update
		fi_fund_payment_detail set STATUS=2 where PAYMENT_HEAD_ID=#{ID}
	</update>
	<update id="updateCreditFundByHeadid" parameterType="java.util.Map">
		UPDATE
		FI_CREDIT_CHANNEL_FUND T
		SET T.FACT_AMT = NVL(T.FACT_AMT,0) +
		(SELECT SUM(NVL(A.USED_AMT, 0))
		FROM FI_CREDIT_CHANNEL_FUND_ACCOUNT A
		WHERE A.APP_ID = T.ID AND A.FUND_ID = #{ID})
		WHERE T.ID IN (SELECT C.APP_ID
		FROM FI_CREDIT_CHANNEL_FUND_ACCOUNT C
		WHERE C.FUND_ID =#{ID})
	</update>

	<update id="updateCreditAccountByHeadid" parameterType="java.util.Map">
		UPDATE
		FI_CREDIT_CHANNEL_FUND_ACCOUNT T SET T.STATUS = 1 WHERE T.FUND_ID
		=#{ID}
	</update>

	<update id="updatePayDetailStatusForSubmit" parameterType="java.util.Map">
		update fi_fund_payment_detail set STATUS=1 where PAYMENT_HEAD_ID=#{ID}
	</update>

	<select id="pay_ComListAll" parameterType="java.util.Map"
		resultType="map">
		SELECT COMPANY_ID COMP_ID FROM T_SYS_COMPANY T
		<where>
			<if test="COM_ID != null and COM_ID != ''"> COMPANY_ID IN (${COM_ID})</if>
		</where>
	</select>

	<select id="pay_ComListByParam" parameterType="java.util.Map"
		resultType="map">
		select COMPANY_ID COMP_ID from t_sys_company where
		BUSINESS_SECTOR IN (${COMP_ID})
	</select>

	<select id="pay_SupList" parameterType="java.util.Map"
		resultType="map">
		select ffph.SUPPER_ID
		from fi_fund_payment_head ffph
		left join t_sys_company tsc on ffph.COMP_ID=tsc.COMPANY_ID
		where ffph.type=1
		<if test="SUP_ID != null and SUP_ID != ''">and ffph.SUPPER_ID = #{SUP_ID}</if>
		<if test="COM_ID != null and COM_ID != ''">and ffph.COMP_ID IN (${COM_ID})</if>
		<if test="PAYMENT_JBPM_ID != null and PAYMENT_JBPM_ID != ''"> AND FFPH.JBPM_ID IN (${PAYMENT_JBPM_ID})</if>
		<if test="COMP_ID != null and COMP_ID != ''">and tsc.BUSINESS_SECTOR IN (${COMP_ID})</if>
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and ffph.SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PAYMENT_CODE != null and PAYMENT_CODE != ''">and ffph.PAYMENT_CODE like '%'||#{PAYMENT_CODE}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and ffph.PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="BEGGIN_DATE1 !=null and BEGGIN_DATE1 !=''"> and
			ffph.BEGGIN_DATE>=to_date(#{BEGGIN_DATE1},'yyyy-mm-dd')</if>
		<if test="BEGGIN_DATE2 !=null and BEGGIN_DATE2 !=''"> and ffph.BEGGIN_DATE
			&lt;=to_date(#{BEGGIN_DATE2},'yyyy-mm-dd')</if>
		<if test="STATUS != null and STATUS != ''">and ffph.STATUS =#{STATUS}</if>
		group by ffph.SUPPER_ID
		order by ffph.SUPPER_ID desc
	</select>

	<select id="pay_Detail_Excle_Eq_Mg" parameterType="java.util.Map"
		resultType="java.util.Map">
		select ffpd.SUPPER_NAME,ffpd.PROJECT_CODE,fcc.name
		cust_name,ffpd.comp_name,fph.PRODUCT_NAME,fph.amount,
		to_char(ffpd.START_DATE,'yyyy-MM-dd')
		START_DATE,ffpd.PAY_NAME,to_char(ffpd.RESERVE_DATE,'yyyy-MM-dd')
		RESERVE_DATE,
		ffpd.PAYEE_NAME,ffpd.PAY_BANK_ACCOUNT,ROUND(nvl(ffpd.LEASE_TOPRIC,0),
		2) LEASE_TOPRIC,
		ROUND(nvl(ffpd.SQ_PRICE,0), 2) SQ_PRICE,
		ROUND(nvl(ffpd.DB_PRICE,0), 2) DB_PRICE,
		ROUND(nvl(ffpd.FIRST_RENT,0), 2) FIRST_RENT,
		ROUND(nvl(ffpd.QZZJ,0), 2) QZZJ,
		ROUND(nvl(ffpd.LGJK,0), 2) LGJK,
		ROUND(nvl(ffpd.BZJ,0), 2) BZJ,
		ROUND(nvl(ffpd.SXF,0), 2) SXF,
		ROUND(nvl(ffpd.DBF,0), 2) DBF,
		ROUND(nvl(ffpd.BXF,0), 2) BXFF,
		ROUND(nvl(ffpd.QTFY,0), 2) QTFYF,
		ROUND(nvl(ffpd.PAY_MONEY,0), 2) PAY_MONEY
		from fi_fund_payment_head ffph
		left join T_SYS_DATA_DICTIONARY tsdd on tsdd.type='放款状态' and
		to_char(ffph.STATUS)=tsdd.CODE
		left join fi_fund_payment_detail ffpd on ffpd.PAYMENT_HEAD_ID=ffph.ID
		left join fil_project_head fph on ffpd.PROJECT_CODE=fph.pro_code
		left join fil_cust_client fcc on fcc.id=fph.CLIENT_ID
		where ffph.type=1 and ffpd.PAY_TYPE=1 and ffpd.PAYMENT_TYPE=1
		<if test="SUP_ID != null and SUP_ID != ''">and ffph.SUPPER_ID = #{SUP_ID}</if>
		<if test="COM_ID != null and COM_ID != ''">and ffph.COMP_ID IN (${COM_ID})</if>
		<if test="PAYMENT_JBPM_ID != null and PAYMENT_JBPM_ID != ''"> AND FFPH.JBPM_ID IN (${PAYMENT_JBPM_ID})</if>
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and ffph.SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PAYMENT_CODE != null and PAYMENT_CODE != ''">and ffph.PAYMENT_CODE like '%'||#{PAYMENT_CODE}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and ffph.PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="BEGGIN_DATE1 !=null and BEGGIN_DATE1 !=''"> and
			ffph.BEGGIN_DATE>=to_date(#{BEGGIN_DATE1},'yyyy-mm-dd')</if>
		<if test="BEGGIN_DATE2 !=null and BEGGIN_DATE2 !=''"> and ffph.BEGGIN_DATE
			&lt;=to_date(#{BEGGIN_DATE2},'yyyy-mm-dd')</if>
		<if test="STATUS != null and STATUS != ''">and ffph.STATUS =#{STATUS}</if>
		order by ffph.SUPPER_ID desc
	</select>

	<select id="pay_Detail_Excle_Eq_Sum" parameterType="java.util.Map"
		resultType="java.util.Map">
		SELECT FFPH.SUPPER_NAME,
		ROUND(SUM(nvl(ffpd.LEASE_TOPRIC,0)), 2) LEASE_TOPRICALL,
		ROUND(SUM(nvl(ffpd.SQ_PRICE,0)), 2) SQ_PRICEALL,
		ROUND(SUM(nvl(ffpd.DB_PRICE,0)), 2) DB_PRICEALL,
		ROUND(SUM(nvl(ffpd.FIRST_RENT,0)), 2) FIRST_RENTALL,
		ROUND(SUM(nvl(ffpd.QZZJ,0)), 2) QZZJALL,
		ROUND(SUM(nvl(ffpd.LGJK,0)), 2) LGJKALL,
		ROUND(SUM(nvl(ffpd.BZJ,0)), 2) BZJALL,
		ROUND(SUM(nvl(ffpd.SXF,0)), 2) SXFALL,
		ROUND(SUM(nvl(ffpd.DBF,0)), 2) DBFALL,
		ROUND(SUM(nvl(ffpd.BXF,0)), 2) BXFFALL,
		ROUND(SUM(nvl(ffpd.QTFY,0)), 2) QTFYFALL,
		ROUND(SUM(nvl(ffpd.PAY_MONEY,0)), 2) PAY_MONEYALL,
		sum(nvl(fph.AMOUNT,0)) AMOUNTALL
		FROM FI_FUND_PAYMENT_HEAD FFPH
		LEFT JOIN T_SYS_DATA_DICTIONARY TSDD
		ON TSDD.TYPE = '放款状态'
		AND TO_CHAR(FFPH.STATUS) = TSDD.CODE
		left join fi_fund_payment_detail ffpd on ffpd.PAYMENT_HEAD_ID=FFPH.ID
		left join fil_project_head fph on ffpd.PROJECT_CODE=fph.pro_code
		WHERE FFPH.TYPE = 1 and ffpd.PAY_TYPE=1 and ffpd.PAYMENT_TYPE=1
		<if test="SUP_ID != null and SUP_ID != ''">and ffph.SUPPER_ID = #{SUP_ID}</if>
		<if test="COM_ID != null and COM_ID != ''">and ffph.COMP_ID IN (${COM_ID})</if>
		<if test="PAYMENT_JBPM_ID != null and PAYMENT_JBPM_ID != ''"> AND FFPH.JBPM_ID IN (${PAYMENT_JBPM_ID})</if>
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and ffph.SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PAYMENT_CODE != null and PAYMENT_CODE != ''">and ffph.PAYMENT_CODE like '%'||#{PAYMENT_CODE}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and ffph.PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="BEGGIN_DATE1 !=null and BEGGIN_DATE1 !=''"> and
			ffph.BEGGIN_DATE>=to_date(#{BEGGIN_DATE1},'yyyy-mm-dd')</if>
		<if test="BEGGIN_DATE2 !=null and BEGGIN_DATE2 !=''"> and ffph.BEGGIN_DATE
			&lt;=to_date(#{BEGGIN_DATE2},'yyyy-mm-dd')</if>
		<if test="STATUS != null and STATUS != ''">and ffph.STATUS =#{STATUS}</if>
		GROUP BY FFPH.SUPPER_NAME,ffph.SUPPER_ID ORDER BY ffph.SUPPER_ID DESC
	</select>

	<select id="pay_Detail_Excle_Eq_Mg2" parameterType="java.util.Map"
		resultType="java.util.Map">
		select ffpd.SUPPER_NAME,ffpd.PROJECT_CODE,fcc.name
		cust_name,ffpd.comp_name,fph.PRODUCT_NAME,fph.amount,
		to_char(ffpd.START_DATE,'yyyy-MM-dd')
		START_DATE,ffpd.PAY_NAME,to_char(ffpd.RESERVE_DATE,'yyyy-MM-dd')
		RESERVE_DATE,
		ffpd.PAYEE_NAME,ffpd.PAY_BANK_ACCOUNT,ROUND(nvl(ffpd.LEASE_TOPRIC,0),
		2) LEASE_TOPRIC,
		ROUND(nvl(ffpd.SQ_PRICE,0), 2) SQ_PRICE,
		ROUND(nvl(ffpd.DB_PRICE,0), 2) DB_PRICE,
		ROUND(nvl(ffpd.FIRST_RENT,0), 2) FIRST_RENT,
		ROUND(nvl(ffpd.QTFY,0), 2) QTFYF,
		ROUND(nvl(ffpd.CS_PRICE,0), 2) CS_PRICE,
		ROUND(nvl(ffpd.PAY_MONEY,0), 2) PAY_MONEY
		from fi_fund_payment_head ffph
		left join T_SYS_DATA_DICTIONARY tsdd on tsdd.type='放款状态' and
		to_char(ffph.STATUS)=tsdd.CODE
		left join fi_fund_payment_detail ffpd on ffpd.PAYMENT_HEAD_ID=ffph.ID
		left join fil_project_head fph on ffpd.PROJECT_CODE=fph.pro_code
		left join fil_cust_client fcc on fcc.id=fph.CLIENT_ID
		where ffph.type=1 and ffpd.PAY_TYPE=1 and ffpd.PAYMENT_TYPE=2
		<if test="SUP_ID != null and SUP_ID != ''">and ffph.SUPPER_ID = #{SUP_ID}</if>
		<if test="COM_ID != null and COM_ID != ''">and ffph.COMP_ID IN (${COM_ID})</if>
		<if test="PAYMENT_JBPM_ID != null and PAYMENT_JBPM_ID != ''"> AND FFPH.JBPM_ID IN (${PAYMENT_JBPM_ID})</if>
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and ffph.SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PAYMENT_CODE != null and PAYMENT_CODE != ''">and ffph.PAYMENT_CODE like '%'||#{PAYMENT_CODE}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and ffph.PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="BEGGIN_DATE1 !=null and BEGGIN_DATE1 !=''"> and
			ffph.BEGGIN_DATE>=to_date(#{BEGGIN_DATE1},'yyyy-mm-dd')</if>
		<if test="BEGGIN_DATE2 !=null and BEGGIN_DATE2 !=''"> and ffph.BEGGIN_DATE
			&lt;=to_date(#{BEGGIN_DATE2},'yyyy-mm-dd')</if>
		<if test="STATUS != null and STATUS != ''">and ffph.STATUS =#{STATUS}</if>
		order by ffph.SUPPER_ID desc
	</select>

	<select id="pay_Detail_Excle_Eq_Sum2" parameterType="java.util.Map"
		resultType="java.util.Map">
		SELECT FFPH.SUPPER_NAME,
		ROUND(SUM(nvl(ffpd.LEASE_TOPRIC,0)), 2) LEASE_TOPRICALL,
		ROUND(SUM(nvl(ffpd.SQ_PRICE,0)), 2) SQ_PRICEALL,
		ROUND(SUM(nvl(ffpd.DB_PRICE,0)), 2) DB_PRICEALL,
		ROUND(SUM(nvl(ffpd.FIRST_RENT,0)), 2) FIRST_RENTALL,
		ROUND(SUM(nvl(ffpd.QTFY,0)), 2) QTFYFALL,
		ROUND(SUM(nvl(ffpd.CS_PRICE,0)), 2) CS_PRICEALL,
		ROUND(SUM(nvl(ffpd.PAY_MONEY,0)), 2) PAY_MONEYALL,
		sum(nvl(fph.AMOUNT,0)) AMOUNTALL
		FROM FI_FUND_PAYMENT_HEAD FFPH
		LEFT JOIN T_SYS_DATA_DICTIONARY TSDD
		ON TSDD.TYPE = '放款状态'
		AND TO_CHAR(FFPH.STATUS) = TSDD.CODE
		left join fi_fund_payment_detail ffpd on ffpd.PAYMENT_HEAD_ID=FFPH.ID
		left join fil_project_head fph on ffpd.PROJECT_CODE=fph.pro_code
		WHERE FFPH.TYPE = 1 and ffpd.PAY_TYPE=1 and ffpd.PAYMENT_TYPE=2
		<if test="SUP_ID != null and SUP_ID != ''">and ffph.SUPPER_ID = #{SUP_ID}</if>
		<if test="COM_ID != null and COM_ID != ''">and ffph.COMP_ID IN (${COM_ID})</if>
		<if test="PAYMENT_JBPM_ID != null and PAYMENT_JBPM_ID != ''"> AND FFPH.JBPM_ID IN (${PAYMENT_JBPM_ID})</if>
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and ffph.SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PAYMENT_CODE != null and PAYMENT_CODE != ''">and ffph.PAYMENT_CODE like '%'||#{PAYMENT_CODE}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and ffph.PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="BEGGIN_DATE1 !=null and BEGGIN_DATE1 !=''"> and
			ffph.BEGGIN_DATE>=to_date(#{BEGGIN_DATE1},'yyyy-mm-dd')</if>
		<if test="BEGGIN_DATE2 !=null and BEGGIN_DATE2 !=''"> and ffph.BEGGIN_DATE
			&lt;=to_date(#{BEGGIN_DATE2},'yyyy-mm-dd')</if>
		<if test="STATUS != null and STATUS != ''">and ffph.STATUS =#{STATUS}</if>
		GROUP BY FFPH.SUPPER_NAME,ffph.SUPPER_ID ORDER BY ffph.SUPPER_ID DESC
	</select>


	<select id="pay_Detail_Excle_Eq_Mg4" parameterType="java.util.Map"
		resultType="java.util.Map">
		select ffpd.SUPPER_NAME,ffpd.PROJECT_CODE,fcc.name
		cust_name,ffpd.comp_name,fph.PRODUCT_NAME,fph.amount,
		to_char(ffpd.START_DATE,'yyyy-MM-dd')
		START_DATE,ffpd.PAY_NAME,to_char(ffpd.RESERVE_DATE,'yyyy-MM-dd')
		RESERVE_DATE,
		ffpd.PAYEE_NAME,ffpd.PAY_BANK_ACCOUNT,ROUND(nvl(ffpd.LEASE_TOPRIC,0),
		2) LEASE_TOPRIC,
		ROUND(nvl(ffpd.QZZJ,0), 2) QZZJ,
		ROUND(nvl(ffpd.LGJK,0), 2) LGJK,
		ROUND(nvl(ffpd.PAY_MONEY,0), 2) PAY_MONEY
		from fi_fund_payment_head ffph
		left join T_SYS_DATA_DICTIONARY tsdd on tsdd.type='放款状态' and
		to_char(ffph.STATUS)=tsdd.CODE
		left join fi_fund_payment_detail ffpd on ffpd.PAYMENT_HEAD_ID=ffph.ID
		left join fil_project_head fph on ffpd.PROJECT_CODE=fph.pro_code
		left join fil_cust_client fcc on fcc.id=fph.CLIENT_ID
		where ffph.type=1 and ffpd.PAY_TYPE=1 and ffpd.PAYMENT_TYPE=3
		<if test="SUP_ID != null and SUP_ID != ''">and ffph.SUPPER_ID = #{SUP_ID}</if>
		<if test="COM_ID != null and COM_ID != ''">and ffph.COMP_ID IN (${COM_ID})</if>
		<if test="PAYMENT_JBPM_ID != null and PAYMENT_JBPM_ID != ''"> AND FFPH.JBPM_ID IN (${PAYMENT_JBPM_ID})</if>
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and ffph.SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PAYMENT_CODE != null and PAYMENT_CODE != ''">and ffph.PAYMENT_CODE like '%'||#{PAYMENT_CODE}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and ffph.PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="BEGGIN_DATE1 !=null and BEGGIN_DATE1 !=''"> and
			ffph.BEGGIN_DATE>=to_date(#{BEGGIN_DATE1},'yyyy-mm-dd')</if>
		<if test="BEGGIN_DATE2 !=null and BEGGIN_DATE2 !=''"> and ffph.BEGGIN_DATE
			&lt;=to_date(#{BEGGIN_DATE2},'yyyy-mm-dd')</if>
		<if test="STATUS != null and STATUS != ''">and ffph.STATUS =#{STATUS}</if>
		order by ffph.SUPPER_ID desc
	</select>

	<select id="pay_Detail_Excle_Eq_Sum4" parameterType="java.util.Map"
		resultType="java.util.Map">
		SELECT FFPH.SUPPER_NAME,
		ROUND(SUM(nvl(ffpd.LEASE_TOPRIC,0)), 2) LEASE_TOPRICALL,
		ROUND(SUM(nvl(ffpd.QZZJ,0)), 2) QZZJALL,
		ROUND(SUM(nvl(ffpd.LGJK,0)), 2) LGJKALL,
		ROUND(SUM(nvl(ffpd.PAY_MONEY,0)), 2) PAY_MONEYALL,
		sum(nvl(fph.AMOUNT,0)) AMOUNTALL
		FROM FI_FUND_PAYMENT_HEAD FFPH
		LEFT JOIN T_SYS_DATA_DICTIONARY TSDD
		ON TSDD.TYPE = '放款状态'
		AND TO_CHAR(FFPH.STATUS) = TSDD.CODE
		left join fi_fund_payment_detail ffpd on ffpd.PAYMENT_HEAD_ID=FFPH.ID
		left join fil_project_head fph on ffpd.PROJECT_CODE=fph.pro_code
		WHERE FFPH.TYPE = 1 and ffpd.PAY_TYPE=1 and ffpd.PAYMENT_TYPE=3
		<if test="SUP_ID != null and SUP_ID != ''">and ffph.SUPPER_ID = #{SUP_ID}</if>
		<if test="COM_ID != null and COM_ID != ''">and ffph.COMP_ID IN (${COM_ID})</if>
		<if test="PAYMENT_JBPM_ID != null and PAYMENT_JBPM_ID != ''"> AND FFPH.JBPM_ID IN (${PAYMENT_JBPM_ID})</if>
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and ffph.SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PAYMENT_CODE != null and PAYMENT_CODE != ''">and ffph.PAYMENT_CODE like '%'||#{PAYMENT_CODE}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and ffph.PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="BEGGIN_DATE1 !=null and BEGGIN_DATE1 !=''"> and
			ffph.BEGGIN_DATE>=to_date(#{BEGGIN_DATE1},'yyyy-mm-dd')</if>
		<if test="BEGGIN_DATE2 !=null and BEGGIN_DATE2 !=''"> and ffph.BEGGIN_DATE
			&lt;=to_date(#{BEGGIN_DATE2},'yyyy-mm-dd')</if>
		<if test="STATUS != null and STATUS != ''">and ffph.STATUS =#{STATUS}</if>
		GROUP BY FFPH.SUPPER_NAME,ffph.SUPPER_ID ORDER BY ffph.SUPPER_ID DESC
	</select>

	<select id="pay_Detail_Excle_Eq_Mg3" parameterType="java.util.Map"
		resultType="java.util.Map">
		select ffpd.SUPPER_NAME,ffpd.PROJECT_CODE,fcc.name
		cust_name,ffpd.comp_name,fph.PRODUCT_NAME,fph.amount,
		to_char(ffpd.START_DATE,'yyyy-MM-dd')
		START_DATE,ffpd.PAY_NAME,to_char(ffpd.RESERVE_DATE,'yyyy-MM-dd')
		RESERVE_DATE,
		ffpd.PAYEE_NAME,ffpd.PAY_BANK_ACCOUNT,ROUND(nvl(ffpd.LEASE_TOPRIC,0),
		2) LEASE_TOPRIC,
		ROUND(nvl(ffpd.DB_PRICE,0), 2) DB_PRICE,
		ROUND(nvl(ffpd.PAY_MONEY,0), 2) PAY_MONEY
		from fi_fund_payment_head ffph
		left join T_SYS_DATA_DICTIONARY tsdd on tsdd.type='放款状态' and
		to_char(ffph.STATUS)=tsdd.CODE
		left join fi_fund_payment_detail ffpd on ffpd.PAYMENT_HEAD_ID=ffph.ID
		left join fil_project_head fph on ffpd.PROJECT_CODE=fph.pro_code
		left join fil_cust_client fcc on fcc.id=fph.CLIENT_ID
		where ffph.type=1 and ffpd.PAY_TYPE=1 and ffpd.PAYMENT_TYPE=4
		<if test="SUP_ID != null and SUP_ID != ''">and ffph.SUPPER_ID = #{SUP_ID}</if>
		<if test="COM_ID != null and COM_ID != ''">and ffph.COMP_ID IN (${COM_ID})</if>
		<if test="PAYMENT_JBPM_ID != null and PAYMENT_JBPM_ID != ''"> AND FFPH.JBPM_ID IN (${PAYMENT_JBPM_ID})</if>
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and ffph.SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PAYMENT_CODE != null and PAYMENT_CODE != ''">and ffph.PAYMENT_CODE like '%'||#{PAYMENT_CODE}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and ffph.PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="BEGGIN_DATE1 !=null and BEGGIN_DATE1 !=''"> and
			ffph.BEGGIN_DATE>=to_date(#{BEGGIN_DATE1},'yyyy-mm-dd')</if>
		<if test="BEGGIN_DATE2 !=null and BEGGIN_DATE2 !=''"> and ffph.BEGGIN_DATE
			&lt;=to_date(#{BEGGIN_DATE2},'yyyy-mm-dd')</if>
		<if test="STATUS != null and STATUS != ''">and ffph.STATUS =#{STATUS}</if>
		order by ffph.SUPPER_ID desc
	</select>

	<select id="pay_Detail_Excle_Eq_Sum3" parameterType="java.util.Map"
		resultType="java.util.Map">
		SELECT FFPH.SUPPER_NAME,
		ROUND(SUM(nvl(ffpd.LEASE_TOPRIC,0)), 2) LEASE_TOPRICALL,
		ROUND(SUM(nvl(ffpd.DB_PRICE,0)), 2) DB_PRICEALL,
		ROUND(SUM(nvl(ffpd.PAY_MONEY,0)), 2) PAY_MONEYALL,
		sum(nvl(fph.AMOUNT,0)) AMOUNTALL
		FROM FI_FUND_PAYMENT_HEAD FFPH
		LEFT JOIN T_SYS_DATA_DICTIONARY TSDD
		ON TSDD.TYPE = '放款状态'
		AND TO_CHAR(FFPH.STATUS) = TSDD.CODE
		left join fi_fund_payment_detail ffpd on ffpd.PAYMENT_HEAD_ID=FFPH.ID
		left join fil_project_head fph on ffpd.PROJECT_CODE=fph.pro_code
		WHERE FFPH.TYPE = 1 and ffpd.PAY_TYPE=1 and ffpd.PAYMENT_TYPE=4
		<if test="SUP_ID != null and SUP_ID != ''">and ffph.SUPPER_ID = #{SUP_ID}</if>
		<if test="COM_ID != null and COM_ID != ''">and ffph.COMP_ID IN (${COM_ID})</if>
		<if test="PAYMENT_JBPM_ID != null and PAYMENT_JBPM_ID != ''"> AND FFPH.JBPM_ID IN (${PAYMENT_JBPM_ID})</if>
		<if test="SUPPER_NAME != null and SUPPER_NAME != ''">and ffph.SUPPER_NAME like '%'||#{SUPPER_NAME}||'%'</if>
		<if test="PAYMENT_CODE != null and PAYMENT_CODE != ''">and ffph.PAYMENT_CODE like '%'||#{PAYMENT_CODE}||'%'</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME != ''">and ffph.PAYEE_NAME like '%'||#{PAYEE_NAME}||'%'</if>
		<if test="BEGGIN_DATE1 !=null and BEGGIN_DATE1 !=''"> and
			ffph.BEGGIN_DATE>=to_date(#{BEGGIN_DATE1},'yyyy-mm-dd')</if>
		<if test="BEGGIN_DATE2 !=null and BEGGIN_DATE2 !=''"> and ffph.BEGGIN_DATE
			&lt;=to_date(#{BEGGIN_DATE2},'yyyy-mm-dd')</if>
		<if test="STATUS != null and STATUS != ''">and ffph.STATUS =#{STATUS}</if>
		GROUP BY FFPH.SUPPER_NAME,ffph.SUPPER_ID ORDER BY ffph.SUPPER_ID DESC
	</select>


	<select id="selectProidForLosePayData" parameterType="java.util.Map"
		resultType="java.util.Map">
		SELECT T.ID FROM FIL_PROJECT_HEAD T
		WHERE T.STATUS = 20
		AND T.PRO_CODE NOT IN
		(SELECT D.PROJECT_CODE FROM FI_FUND_PAYMENT_DETAIL D) 
	</select>
	<select id="selectSTART_CONFIRM_DATEForLosePayData"
		parameterType="java.util.Map" resultType="java.util.Map">
		SELECT T.PAYLIST_CODE ,
		TO_CHAR(T.START_CONFIRM_DATE,'YYYY-MM-DD') START_CONFIRM_DATE FROM
		FIL_RENT_PLAN_HEAD T WHERE T.PROJECT_ID IN( SELECT H.ID FROM
		FI_FUND_PAYMENT_DETAIL D LEFT JOIN FIL_PROJECT_HEAD H ON H.PRO_CODE =
		D.PROJECT_CODE WHERE D.REMARK ='DSFK' ) 
	</select>

	<update id="updatePayMentDiKou" parameterType="java.util.Map">
		update
		fi_fund_payment_head set ID=#{ID}
		,DEDUCTION_MONEY=#{MONEY}
		,DEDUCTION_RATE=#{RATIO}
		,LAST_MONEY=#{LASTMONEY}
		,LIMIT_BOND=#{LIMIT_BOND}
		,PLAN_AMT=#{PLAN_AMT}
		,BANKBILL_PRICE = #{LASTMONEY} - ACCBILL_PRICE
		where ID=#{ID}
	</update>

	<insert id="insertCreditAccount" parameterType="java.util.Map">
		INSERT INTO
		FI_CREDIT_CHANNEL_FUND_ACCOUNT (ID,APP_ID,USED_AMT,FUND_ID)
		VALUES(SEQ_FI_CREDIT_ACCOUNT.NEXTVAL,#{ID},(SELECT (CASE WHEN
		(NVL(TT.PLAN_AMT, 0) - NVL(TT.FACT_AMT, 0) - NVL(ACC.USED_AMT,0)) >=
		#{LIMIT_BOND_SUM} THEN #{LIMIT_BOND_SUM}
		WHEN #{LIMIT_BOND_SUM} > (NVL(TT.PLAN_AMT, 0) - NVL(TT.FACT_AMT, 0) -
		NVL(ACC.USED_AMT,0)) THEN (NVL(TT.PLAN_AMT, 0) - NVL(TT.FACT_AMT, 0) -
		NVL(ACC.USED_AMT,0)) END )
		FROM FI_CREDIT_CHANNEL_FUND TT LEFT JOIN (SELECT TA.APP_ID,
		NVL(SUM(TA.USED_AMT), 0) USED_AMT
		FROM FI_CREDIT_CHANNEL_FUND_ACCOUNT TA
		WHERE TA.STATUS = 0
		OR TA.STATUS IS NULL
		GROUP BY TA.APP_ID) ACC
		ON ACC.APP_ID = TT.ID WHERE ID = #{ID})
		, #{PAY_ID}) 
	</insert>

	<delete id="deleteCreditAccount" parameterType="java.util.Map">
		DELETE FROM
		FI_CREDIT_CHANNEL_FUND_ACCOUNT WHERE FUND_ID = #{ID}
	</delete>
	<update id="updatePayMentHP" parameterType="java.util.Map">
		update
		fi_fund_payment_head set ID=#{ID}
		,ACCBILL_PRICE=#{ACCBILL_PRICE}
		,BANKBILL_PRICE=#{BANKBILL_PRICE}
		where ID=#{ID}
	</update>

	<select id="queryCreditLimitBySupid" parameterType="java.util.Map"
		resultType="java.util.Map">
		SELECT TT.ID, NVL(TT.PLAN_AMT, 0) PLAN_AMT,
		NVL(TT.FACT_AMT, 0) FACT_AMT
		,NVL(TT.PLAN_AMT, 0) - NVL(TT.FACT_AMT, 0)- NVL(ACC.USED_AMT,0) KS_AMP
		FROM FI_CREDIT_CHANNEL_FUND TT LEFT JOIN (SELECT TA.APP_ID,
		NVL(SUM(TA.USED_AMT), 0) USED_AMT
		FROM FI_CREDIT_CHANNEL_FUND_ACCOUNT TA
		WHERE TA.STATUS = 0
		OR TA.STATUS IS NULL
		GROUP BY TA.APP_ID) ACC
		ON ACC.APP_ID = TT.ID
		WHERE TT.STATUS = 0
		AND (NVL(TT.PLAN_AMT, 0) - NVL(TT.FACT_AMT, 0)) > 0
		AND TT.SUP_ID =#{SUP_ID} ORDER BY TT.ID 
	</select>


	<!-- start by wuyanfei -->

	<select id="getPaymentDetailNextval" resultType="Long">
		SELECT
		SEQ_FI_FUND_PAYMENT_DETAIL.nextval FROM DUAL
	</select>


	<insert id="createPaymentDate" parameterType="java.util.Map">
		INSERT INTO FI_FUND_PAYMENT_DETAIL
		(
		ID
		<if test="PAYMENT_HEAD_ID != null and PAYMENT_HEAD_ID !=''">,PAYMENT_HEAD_ID</if>
		<if test="PROJECT_CODE != null and PROJECT_CODE !='' ">,PROJECT_CODE</if>
		<if test="SUPPER_ID != null and SUPPER_ID !='' ">,SUPPER_ID</if>
		<if test="SUPPER_NAME != null and SUPPER_NAME !='' ">,SUPPER_NAME</if>
		<if test="COMP_ID != null and COMP_ID !='' ">,COMP_ID</if>
		<if test="COMP_NAME != null and COMP_NAME !='' ">,COMP_NAME</if>
		<if test="START_DATE != null and START_DATE !='' ">,START_DATE</if>
		<if test="PAY_MONEY != null and PAY_MONEY !='' ">,PAY_MONEY</if>
		<if test="PAY_NAME != null and PAY_NAME !='' ">,PAY_NAME</if>
		<if test="PAY_TYPE != null and PAY_TYPE !='' ">,PAY_TYPE</if>
		<if test="RESERVE_DATE != null and RESERVE_DATE !='' ">,RESERVE_DATE</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME !='' ">,PAYEE_NAME</if>
		<if test="PAY_BANK_ACCOUNT != null and PAY_BANK_ACCOUNT !='' ">,PAY_BANK_ACCOUNT</if>
		<if test="INVOICE_NUM != null and INVOICE_NUM !='' ">,INVOICE_NUM</if>
		<if test="INVOICE_DATE != null and INVOICE_DATE !='' ">,INVOICE_DATE</if>
		<if test="PLATFORM_TYPE != null and PLATFORM_TYPE !='' ">,PLATFORM_TYPE</if>
		<if test="PAYMENT_TYPE != null and PAYMENT_TYPE !='' ">,PAYMENT_TYPE</if>
		<if test="STATUS != null and STATUS !='' ">,STATUS</if>
		<if test="REALITY_DATE != null and REALITY_DATE !='' ">,REALITY_DATE</if>
		<if test="REALITY_BANK_NAME != null and REALITY_BANK_NAME !='' ">,REALITY_BANK_NAME</if>
		<if test="CREATE_ID != null and CREATE_ID !='' ">,CREATE_ID</if>
		<if test="CREATE_DATE != null and CREATE_DATE !='' ">,CREATE_DATE</if>
		<if test="MONDFY_ID != null and MONDFY_ID !='' ">,MONDFY_ID</if>
		<if test="MONDFY_DATE != null and MONDFY_DATE  !='' ">,MONDFY_DATE</if>
		<if test="REMARK != null and REMARK !='' ">,REMARK</if>
		<if test="LEASE_TOPRIC != null and LEASE_TOPRIC !='' ">,LEASE_TOPRIC</if>
		<if test="SQ_PRICE != null and SQ_PRICE !='' ">,SQ_PRICE</if>
		<if test="GUARANTEE_NUM != null and GUARANTEE_NUM !='' ">,GUARANTEE_NUM</if>
		<if test="GUARANTEE_DATE != null and GUARANTEE_DATE !='' ">,GUARANTEE_DATE</if>
		<if test="ACCEPTANCE_DATE != null and ACCEPTANCE_DATE !='' ">,ACCEPTANCE_DATE</if>
		<if test="PAY_BANK_ADDRESS != null and PAY_BANK_ADDRESS !='' ">,PAY_BANK_ADDRESS</if>
		<if test="PAY_BANK_NAME != null and PAY_BANK_NAME !='' ">,PAY_BANK_NAME</if>
		<if test="DELIVERY_DATE != null and DELIVERY_DATE !='' ">,DELIVERY_DATE</if>
		<if test="DELIVERY_ADDR != null and DELIVERY_ADDR !='' ">,DELIVERY_ADDR</if>
		<if test="TEMP_CLD != null and TEMP_CLD !='' ">,TEMP_CLD</if>
		<if test="CS_PRICE != null and CS_PRICE !='' ">,CS_PRICE</if>
		<if test="DEDUCTION_MONEY != null and DEDUCTION_MONEY !='' ">,DEDUCTION_MONEY</if>
		<if test="DEDUCTION_RATE != null and DEDUCTION_RATE !='' ">,DEDUCTION_RATE</if>
		<if test="LAST_MONEY != null and LAST_MONEY !='' ">,LAST_MONEY</if>
		<if test="PAYLIST_CODE != null and PAYLIST_CODE !='' ">,PAYLIST_CODE</if>
		<if test="BUY_CONTRACT_ID != null and BUY_CONTRACT_ID !='' ">,BUY_CONTRACT_ID</if>
		<if test="DEKOU_SQ != null and DEKOU_SQ !='' ">,DEKOU_SQ</if>
		<if test="IS_PAY_WHY != null and IS_PAY_WHY !='' ">,IS_PAY_WHY</if>
		)
		VALUES
		(
		#{ID}
		<if test="PAYMENT_HEAD_ID != null and PAYMENT_HEAD_ID !=''">,#{PAYMENT_HEAD_ID}</if>
		<if test="PROJECT_CODE != null and PROJECT_CODE !='' ">,#{PROJECT_CODE}</if>
		<if test="SUPPER_ID != null and SUPPER_ID !='' ">,#{SUPPER_ID}</if>
		<if test="SUPPER_NAME != null and SUPPER_NAME !='' ">,#{SUPPER_NAME}</if>
		<if test="COMP_ID != null and COMP_ID !='' ">,#{COMP_ID}</if>
		<if test="COMP_NAME != null and COMP_NAME !='' ">,#{COMP_NAME}</if>
		<if test="START_DATE != null and START_DATE !='' ">,to_date(#{START_DATE},'yyyy-mm-dd')</if>
		<if test="PAY_MONEY != null and PAY_MONEY !='' ">,#{PAY_MONEY}</if>
		<if test="PAY_NAME != null and PAY_NAME !='' ">,#{PAY_NAME}</if>
		<if test="PAY_TYPE != null and PAY_TYPE !='' ">,#{PAY_TYPE}</if>
		<if test="RESERVE_DATE != null and RESERVE_DATE !='' ">,to_date(#{RESERVE_DATE},'yyyy-mm-dd')</if>
		<if test="PAYEE_NAME != null and PAYEE_NAME !='' ">,#{PAYEE_NAME}</if>
		<if test="PAY_BANK_ACCOUNT != null and PAY_BANK_ACCOUNT !='' ">,#{PAY_BANK_ACCOUNT}</if>
		<if test="INVOICE_NUM != null and INVOICE_NUM !='' ">,#{INVOICE_NUM}</if>
		<if test="INVOICE_DATE != null and INVOICE_DATE !='' ">,to_date(#{INVOICE_DATE},'yyyy-mm-dd')</if>
		<if test="PLATFORM_TYPE != null and PLATFORM_TYPE !='' ">,#{PLATFORM_TYPE}</if>
		<if test="PAYMENT_TYPE != null and PAYMENT_TYPE !='' ">,#{PAYMENT_TYPE}</if>
		<if test="STATUS != null and STATUS !='' ">,#{STATUS}</if>
		<if test="REALITY_DATE != null and REALITY_DATE !='' ">,to_date(#{REALITY_DATE},'yyyy-mm-dd')</if>
		<if test="REALITY_BANK_NAME != null and REALITY_BANK_NAME !='' ">,#{REALITY_BANK_NAME}</if>
		<if test="CREATE_ID != null and CREATE_ID !='' ">,#{CREATE_ID}</if>
		<if test="CREATE_DATE != null and CREATE_DATE !='' ">,to_date(#{CREATE_DATE},'yyyy-mm-dd')</if>
		<if test="MONDFY_ID != null and MONDFY_ID !='' ">,#{MONDFY_ID}</if>
		<if test="MONDFY_DATE != null and MONDFY_DATE  !='' ">,to_date(#{MONDFY_DATE},'yyyy-mm-dd')</if>
		<if test="REMARK != null and REMARK !='' ">,#{REMARK}</if>
		<if test="LEASE_TOPRIC != null and LEASE_TOPRIC !='' ">,#{LEASE_TOPRIC}</if>
		<if test="SQ_PRICE != null and SQ_PRICE !='' ">,#{SQ_PRICE}</if>
		<if test="GUARANTEE_NUM != null and GUARANTEE_NUM !='' ">,#{GUARANTEE_NUM}</if>
		<if test="GUARANTEE_DATE != null and GUARANTEE_DATE !='' ">,to_date(#{GUARANTEE_DATE},'yyyy-mm-dd')</if>
		<if test="ACCEPTANCE_DATE != null and ACCEPTANCE_DATE !='' ">,to_date(#{ACCEPTANCE_DATE},'yyyy-mm-dd')</if>
		<if test="PAY_BANK_ADDRESS != null and PAY_BANK_ADDRESS !='' ">,#{PAY_BANK_ADDRESS}</if>
		<if test="PAY_BANK_NAME != null and PAY_BANK_NAME !='' ">,#{PAY_BANK_NAME}</if>
		<if test="DELIVERY_DATE != null and DELIVERY_DATE !='' ">,to_date(#{DELIVERY_DATE},'yyyy-mm-dd')</if>
		<if test="DELIVERY_ADDR != null and DELIVERY_ADDR !='' ">,#{DELIVERY_ADDR}</if>
		<if test="TEMP_CLD != null and TEMP_CLD !='' ">,#{TEMP_CLD}</if>
		<if test="CS_PRICE != null and CS_PRICE !='' ">,#{CS_PRICE}</if>
		<if test="DEDUCTION_MONEY != null and DEDUCTION_MONEY !='' ">,#{DEDUCTION_MONEY}</if>
		<if test="DEDUCTION_RATE != null and DEDUCTION_RATE !='' ">,#{DEDUCTION_RATE}</if>
		<if test="LAST_MONEY != null and LAST_MONEY !='' ">,#{LAST_MONEY}</if>
		<if test="PAYLIST_CODE != null and PAYLIST_CODE !='' ">,#{PAYLIST_CODE}</if>
		<if test="BUY_CONTRACT_ID != null and BUY_CONTRACT_ID !='' ">,#{BUY_CONTRACT_ID}</if>
		<if test="DEKOU_SQ != null and DEKOU_SQ !='' ">,#{DEKOU_SQ}</if>
		<if test="IS_PAY_WHY != null and IS_PAY_WHY !='' ">,#{IS_PAY_WHY}</if>
		)
	</insert>

	<select id="getPaymentDetailsByBuyContractId" parameterType="Long"
		resultType="map">
		SELECT
		T.ID,T.PAYMENT_HEAD_ID,T.PROJECT_CODE,T.SUPPER_ID,T.SUPPER_NAME,T.COMP_ID,T.COMP_NAME,T.START_DATE,T.PAY_MONEY,
		T.PAY_NAME,T.PAY_TYPE,to_char(T.RESERVE_DATE,'yyyy-MM-dd')
		RESERVE_DATE,T.PAYEE_NAME,T.PAY_BANK_ACCOUNT,T.INVOICE_NUM,T.INVOICE_DATE,T.PLATFORM_TYPE,
		T.PAYMENT_TYPE,T.STATUS,T.REALITY_DATE,T.REALITY_BANK_NAME,T.CREATE_ID,T.CREATE_DATE,T.MONDFY_ID,T.MONDFY_DATE,T.REMARK,
		T.LEASE_TOPRIC,T.SQ_PRICE,T.GUARANTEE_NUM,T.GUARANTEE_DATE,T.ACCEPTANCE_DATE,T.PAY_BANK_ADDRESS,T.PAY_BANK_NAME,T.DELIVERY_DATE,
		T.DELIVERY_ADDR,T.TEMP_CLD,T.CS_PRICE,T.DEDUCTION_MONEY,T.DEDUCTION_RATE,T.LAST_MONEY,T.PAYLIST_CODE,T.BUY_CONTRACT_ID,T.DEKOU_SQ,T.IS_PAY_WHY
		FROM FI_FUND_PAYMENT_DETAIL T
		WHERE T.BUY_CONTRACT_ID = #{BUY_CONTRACT_ID} 	
	</select>

	<update id="updatePaymentDetail" parameterType="Map">
		UPDATE FI_FUND_PAYMENT_DETAIL SET
		STATUS = 1
		<if test="PAYMENT_HEAD_ID !=null and PAYMENT_HEAD_ID !=''">,PAYMENT_HEAD_ID=#{PAYMENT_HEAD_ID}</if>
		<if test="PROJECT_CODE !=null and PROJECT_CODE !=''">,PROJECT_CODE=#{PROJECT_CODE}</if>
		<if test="SUPPER_ID !=null and SUPPER_ID !=''">,SUPPER_ID=#{SUPPER_ID}</if>
		<if test="SUPPER_NAME !=null and SUPPER_NAME !=''">,SUPPER_NAME=#{SUPPER_NAME}</if>
		<if test="COMP_ID !=null and COMP_ID !=''">,COMP_ID=#{COMP_ID}</if>
		<if test="COMP_NAME !=null and COMP_NAME !=''">,COMP_NAME=#{COMP_NAME}</if>
		<if test="START_DATE !=null and START_DATE !=''">,START_DATE=TO_DATE(#{START_DATE},'yyyy-mm-dd')</if>
		<if test="PAY_MONEY !=null and PAY_MONEY !=''">,PAY_MONEY=#{PAY_MONEY}</if>
		<if test="PAY_NAME !=null and PAY_NAME !=''">,PAY_NAME=#{PAY_NAME}</if>
		<if test="PAY_TYPE !=null and PAY_TYPE !=''">,PAY_TYPE=#{PAY_TYPE}</if>
		<if test="RESERVE_DATE !=null and RESERVE_DATE !=''">,RESERVE_DATE=TO_DATE(#{RESERVE_DATE},'yyyy-mm-dd')</if>
		<if test="PAYEE_NAME !=null and PAYEE_NAME !=''">,PAYEE_NAME=#{PAYEE_NAME}</if>
		<if test="PAY_BANK_ACCOUNT !=null and PAY_BANK_ACCOUNT !=''">,PAY_BANK_ACCOUNT=#{PAY_BANK_ACCOUNT}</if>
		<if test="INVOICE_NUM !=null and INVOICE_NUM !=''">,INVOICE_NUM=#{INVOICE_NUM}</if>
		<if test="INVOICE_DATE !=null and INVOICE_DATE !=''">,INVOICE_DATE=TO_DATE(#{INVOICE_DATE},'yyyy-mm-dd')</if>
		<if test="PLATFORM_TYPE !=null and PLATFORM_TYPE !=''">,PLATFORM_TYPE=#{PLATFORM_TYPE}</if>
		<if test="PAYMENT_TYPE !=null and PAYMENT_TYPE !=''">,OTHER=#{PAYMENT_TYPE}</if>
		<if test="REALITY_DATE !=null and REALITY_DATE !=''">,REALITY_DATE=TO_DATE(#{REALITY_DATE},'yyyy-mm-dd')</if>
		<if test="REALITY_BANK_NAME !=null and REALITY_BANK_NAME !=''">,REALITY_BANK_NAME=#{REALITY_BANK_NAME}</if>
		<if test="CREATE_ID !=null and CREATE_ID !=''">,CREATE_ID=#{CREATE_ID}</if>
		<if test="CREATE_DATE !=null and CREATE_DATE !=''">,CREATE_DATE=TO_DATE(#{CREATE_DATE},'yyyy-mm-dd')</if>
		<if test="MONDFY_ID !=null and MONDFY_ID !=''">,MONDFY_ID=#{MONDFY_ID}</if>
		<if test="MONDFY_DATE !=null and MONDFY_DATE !=''">,MONDFY_DATE=TO_DATE(#{MONDFY_DATE},'yyyy-mm-dd')</if>
		<if test="REMARK !=null and REMARK !=''">,REMARK=#{REMARK}</if>
		<if test="LEASE_TOPRIC !=null and LEASE_TOPRIC !=''">,LEASE_TOPRIC=#{LEASE_TOPRIC}</if>
		<if test="SQ_PRICE !=null and SQ_PRICE !=''">,SQ_PRICE=#{SQ_PRICE}</if>
		<if test="GUARANTEE_NUM !=null and GUARANTEE_NUM !=''">,GUARANTEE_NUM=#{GUARANTEE_NUM}</if>
		<if test="GUARANTEE_DATE !=null and GUARANTEE_DATE !=''">,GUARANTEE_DATE=TO_DATE(#{GUARANTEE_DATE},'yyyy-mm-dd')
		</if>
		<if test="ACCEPTANCE_DATE !=null and ACCEPTANCE_DATE !=''">,ACCEPTANCE_DATE=TO_DATE(#{ACCEPTANCE_DATE},'yyyy-mm-dd')
		</if>
		<if test="PAY_BANK_ADDRESS !=null and PAY_BANK_ADDRESS !=''">,PAY_BANK_ADDRESS=#{PAY_BANK_ADDRESS}</if>
		<if test="PAY_BANK_NAME !=null and PAY_BANK_NAME !=''">,PAY_BANK_NAME=#{PAY_BANK_NAME}</if>
		<if test="DELIVERY_DATE !=null and DELIVERY_DATE !=''">,THE_BALANCE=TO_DATE(#{DELIVERY_DATE},'yyyy-mm-dd')</if>
		<if test="DELIVERY_ADDR !=null and DELIVERY_ADDR !=''">,DELIVERY_ADDR=#{DELIVERY_ADDR}</if>
		<if test="CS_PRICE !=null and CS_PRICE !=''">,CS_PRICE=#{CS_PRICE}</if>
		<if test="TEMP_CLD !=null and TEMP_CLD !=''">,TEMP_CLD=#{TEMP_CLD}</if>
		<if test="DEDUCTION_MONEY !=null and DEDUCTION_MONEY !=''">,DEDUCTION_MONEY=#{DEDUCTION_MONEY}</if>
		<if test="DEDUCTION_RATE !=null and DEDUCTION_RATE !=''">,DEDUCTION_RATE=#{DEDUCTION_RATE}</if>
		<if test="LAST_MONEY !=null and LAST_MONEY !=''">,LAST_MONEY=#{LAST_MONEY}</if>
		<if test="PAYLIST_CODE !=null and PAYLIST_CODE !=''">,PAYLIST_CODE=#{PAYLIST_CODE}</if>
		<if test="BUY_CONTRACT_ID !=null and BUY_CONTRACT_ID !=''">,BUY_CONTRACT_ID=#{BUY_CONTRACT_ID}</if>
		<if test="DEKOU_SQ !=null and DEKOU_SQ !=''">,DEKOU_SQ=#{DEKOU_SQ}</if>
		<if test="IS_PAY_WHY !=null and IS_PAY_WHY !=''">,IS_PAY_WHY=#{IS_PAY_WHY}</if>
		WHERE ID=#{ID}
	</update>

	<!-- end by wuyanfei -->
</mapper>
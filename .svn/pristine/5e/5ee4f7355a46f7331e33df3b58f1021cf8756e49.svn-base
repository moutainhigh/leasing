<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN"
"http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">
<mapper namespace="targets">
	<select id="queryAreaList" parameterType="java.util.Map" resultType="map">
		select tsa.NAME TYPE_NAME from t_sys_area tsa where tsa.AREA_LEVEL=3 
		 <if test="TYPE_NAME !=null and TYPE_NAME !='' "> and tsa.NAME LIKE '%' ||  '${TYPE_NAME}' || '%'</if> 
	</select>
	
	<select id="queryKHJLList" parameterType="java.util.Map" resultType="map">
		SELECT SE.NAME TYPE_NAME
		  FROM SECU_USER SE , SECU_USER_ORG SUO
		 WHERE SE.ID = SUO.USER_ID
		   AND SUO.ORG_ID in (
            SELECT SO.ID FROM  SECU_ORG SO WHERE  SO.NAME='客户经理'
       )
       <where>
       	<if test="TYPE_NAME !=null and TYPE_NAME !='' ">SE.NAME LIKE '%' ||  '${TYPE_NAME}' || '%'</if> 
       </where>
		  ORDER BY SE.CODE
		 
	</select>	
	
	<select id="queryHYList" parameterType="java.util.Map" resultType="map">
		select tsdd.flag TYPE_NAME from t_sys_data_dictionary tsdd where tsdd.type='行业类型'
		 <if test="TYPE_NAME !=null and TYPE_NAME !='' "> and tsdd.flag LIKE '%' ||  '${TYPE_NAME}' || '%'</if> 
	</select>
	
	<select id="getTargetsDetail" parameterType="java.util.Map" resultType="map">
		select ID,TIMETYPE,to_char(ti.CREAT_DATE,'yyyy-MM-dd') CREAT_DATE,to_char(ti.START_DATE,'yyyy-MM-dd') START_DATE
		,to_char(ti.END_DATE,'yyyy-MM-dd') END_DATE,NAME,INDICATORS_TYPE,TYPE,INDICATORS_VALUE
		from T_INDICATORS ti where ti.INDICATORS_TYPE=#{INDICATORS_TYPE} and ti.TYPE=#{TYPE}
		<if test="RADIOTYPE_NAME !=null and RADIOTYPE_NAME !='' "> and ti.NAME=#{RADIOTYPE_NAME}</if> 
		order by ti.CREAT_DATE desc,ti.END_DATE desc
	</select>
	
	<select id="queryYear" parameterType="java.util.Map" resultType="map">
		select to_char(trunc(sysdate, 'yyyy'),'yyyy-MM-dd') START_DATE,to_char(add_months(trunc(sysdate, 'yyyy'), 12) - 1,'yyyy-MM-dd') END_DATE from dual
	</select>
	
	<select id="queryYearLast" parameterType="java.util.Map" resultType="map">
		select to_char(trunc(trunc(sysdate, 'yyyy')-1, 'yyyy'),'yyyy-MM-dd') START_DATE,to_char(trunc(sysdate, 'yyyy')-1,'yyyy-MM-dd') END_DATE from dual
	</select>
	
	<select id="queryQuarter" parameterType="java.util.Map" resultType="map">
		select to_char(trunc(sysdate, 'Q'),'yyyy-MM-dd') START_DATE,to_char(add_months(trunc(sysdate, 'Q'), 3) - 1,'yyyy-MM-dd') END_DATE from dual
	</select>
	
	<select id="queryQuarterLast" parameterType="java.util.Map" resultType="map">
		select to_char(trunc(trunc(sysdate, 'Q') - 1, 'Q'),'yyyy-MM-dd') START_DATE,to_char(trunc(sysdate, 'Q') - 1,'yyyy-MM-dd') END_DATE from dual
	</select>
	
	<select id="queryMonth" parameterType="java.util.Map" resultType="map">
		select to_char(trunc(sysdate, 'mm'),'yyyy-MM-dd') START_DATE,to_char(last_day(trunc(sysdate)),'yyyy-MM-dd') END_DATE from dual
	</select>
	
	<select id="queryMonthLast" parameterType="java.util.Map" resultType="map">
		select to_char(trunc(trunc(sysdate, 'mm')-1, 'mm'),'yyyy-MM-dd') START_DATE,to_char(trunc(sysdate, 'mm')-1,'yyyy-MM-dd') END_DATE from dual
	</select>
	
	<select id="queryDateName"  parameterType="java.util.Map" resultType="int">
		select count(1) from T_INDICATORS where INDICATORS_TYPE=#{INDICATORS_TYPE} and TYPE=#{TYPE} and START_DATE=to_date(#{START_DATE},'yyyy-MM-dd') and END_DATE=to_date(#{END_DATE},'yyyy-MM-dd') and NAME=#{NAME}
	</select>
	
	<select id="queryDateNameMap"  parameterType="java.util.Map" resultType="int">
		select count(1) from T_INDICATORS where INDICATORS_TYPE=#{INDICATORS_TYPE} and TYPE=#{TYPE} and START_DATE=to_date(#{START_DATE},'yyyy-MM-dd') and END_DATE=to_date(#{END_DATE},'yyyy-MM-dd') and NAME=#{NAME}
		and ID=#{ID}
	</select>
	
	<insert id="addTargetsInfo"  parameterType="java.util.Map">
		insert into T_INDICATORS (
			ID
			<if test="TIMETYPE !=null and TIMETYPE !='' ">,TIMETYPE</if>
			<if test="START_DATE !=null and START_DATE !='' ">,START_DATE</if>
			<if test="END_DATE !=null and END_DATE !='' ">,END_DATE</if>
			<if test="NAME !=null and NAME !='' ">,NAME</if>
			<if test="INDICATORS_TYPE !=null and INDICATORS_TYPE !='' ">,INDICATORS_TYPE</if>
			<if test="TYPE !=null and TYPE !='' ">,TYPE</if>
			<if test="INDICATORS_VALUE !=null and INDICATORS_VALUE !='' ">,INDICATORS_VALUE</if>
			,CREAT_DATE
		)values(
			SEQ_T_INDICATORS.NEXTVAL
			<if test="TIMETYPE !=null and TIMETYPE !='' ">,#{TIMETYPE}</if>
			<if test="START_DATE !=null and START_DATE !='' ">,to_date(#{START_DATE},'yyyy-MM-dd')</if>
			<if test="END_DATE !=null and END_DATE !='' ">,to_date(#{END_DATE},'yyyy-MM-dd')</if>
			<if test="NAME !=null and NAME !='' ">,#{NAME}</if>
			<if test="INDICATORS_TYPE !=null and INDICATORS_TYPE !='' ">,#{INDICATORS_TYPE}</if>
			<if test="TYPE !=null and TYPE !='' ">,#{TYPE}</if>
			<if test="INDICATORS_VALUE !=null and INDICATORS_VALUE !='' ">,#{INDICATORS_VALUE}</if>
			,sysdate
		)
	</insert>

	<delete id="deleteDetail" parameterType="java.util.Map">
		delete T_INDICATORS where ID=#{ID}
	</delete>
	
	<update id="updateTargetsInfo" parameterType="java.util.Map">
		update T_INDICATORS set ID=#{ID}
			<if test="TIMETYPE !=null and TIMETYPE !='' ">,TIMETYPE=#{TIMETYPE}</if>
			<if test="START_DATE !=null and START_DATE !='' ">,START_DATE=to_date(#{START_DATE},'yyyy-MM-dd')</if>
			<if test="END_DATE !=null and END_DATE !='' ">,END_DATE=to_date(#{END_DATE},'yyyy-MM-dd')</if>
			<if test="NAME !=null and NAME !='' ">,NAME=#{NAME}</if>
			<if test="INDICATORS_TYPE !=null and INDICATORS_TYPE !='' ">,INDICATORS_TYPE=#{INDICATORS_TYPE}</if>
			<if test="TYPE !=null and TYPE !='' ">,TYPE=#{TYPE}</if>
			<if test="INDICATORS_VALUE !=null and INDICATORS_VALUE !='' ">,INDICATORS_VALUE=#{INDICATORS_VALUE}</if>
			where ID=#{ID}
	</update>
	
	<select id="queryCharBase" parameterType="java.util.Map" resultType="map">
		select TIMETYPE BASE_TIMETYPE from T_BASE_INDICATORS where INDICATORS_TYPE=#{INDICATORS_TYPE} and TYPE=#{TYPE}
	</select>
	
	<update id="updateBaseTimeType" parameterType="java.util.Map">
		update T_BASE_INDICATORS set TIMETYPE=#{TIMETYPE} where INDICATORS_TYPE=#{INDICATORS_TYPE} and TYPE=#{TYPE}
	</update>
	
	<insert id="insertBaseTimeType" parameterType="java.util.Map">
		insert into T_BASE_INDICATORS (
			INDICATORS_TYPE
			,TYPE
			,TIMETYPE
		)values(
			#{INDICATORS_TYPE}
			,#{TYPE}
			,#{TIMETYPE}
		)
	</insert>
	
	<select id="queryBaseTimeTypeInfoIsF" parameterType="java.util.Map" resultType="map">
		select to_char(START_DATE,'yyyy-MM-dd') START_DATE,to_char(END_DATE,'yyyy-MM-dd') END_DATE from T_INDICATORS where INDICATORS_TYPE=#{INDICATORS_TYPE} and TYPE=#{TYPE} and NAME is not null
		<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==1"> and trunc(START_DATE)=trunc(sysdate, 'yyyy') and END_DATE=trunc(add_months(trunc(sysdate, 'yyyy'), 12) - 1)</if>
		<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==2"> and trunc(START_DATE)=trunc(trunc(sysdate, 'yyyy')-1, 'yyyy') and END_DATE=trunc(trunc(sysdate, 'yyyy')-1)</if>
		<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==3"> and trunc(START_DATE)=trunc(sysdate, 'Q') and END_DATE=trunc(add_months(trunc(sysdate, 'Q'), 3) - 1)</if>
		<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==4"> and trunc(START_DATE)=trunc(trunc(sysdate, 'Q') - 1, 'Q') and END_DATE=trunc(trunc(sysdate, 'Q') - 1)</if>
		<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==5"> and trunc(START_DATE)=trunc(sysdate, 'mm') and END_DATE=trunc(last_day(trunc(sysdate)))</if>
		<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==6"> and trunc(START_DATE)=trunc(trunc(sysdate, 'mm')-1, 'mm') and END_DATE=trunc(trunc(sysdate, 'mm')-1)</if>
		group by START_DATE,END_DATE
	</select>
	
	<select id="queryProfitX"  parameterType="map" resultType="map">
		select NAME X_VALUE from T_INDICATORS where INDICATORS_TYPE=#{INDICATORS_TYPE} and TYPE=#{TYPE} and NAME is not null
		<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==1"> and trunc(START_DATE)=trunc(sysdate, 'yyyy') and END_DATE=trunc(add_months(trunc(sysdate, 'yyyy'), 12) - 1)</if>
		<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==2"> and trunc(START_DATE)=trunc(trunc(sysdate, 'yyyy')-1, 'yyyy') and END_DATE=trunc(trunc(sysdate, 'yyyy')-1)</if>
		<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==3"> and trunc(START_DATE)=trunc(sysdate, 'Q') and END_DATE=trunc(add_months(trunc(sysdate, 'Q'), 3) - 1)</if>
		<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==4"> and trunc(START_DATE)=trunc(trunc(sysdate, 'Q') - 1, 'Q') and END_DATE=trunc(trunc(sysdate, 'Q') - 1)</if>
		<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==5"> and trunc(START_DATE)=trunc(sysdate, 'mm') and END_DATE=trunc(last_day(trunc(sysdate)))</if>
		<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==6"> and trunc(START_DATE)=trunc(trunc(sysdate, 'mm')-1, 'mm') and END_DATE=trunc(trunc(sysdate, 'mm')-1)</if>
		group by NAME
		order by NAME
	</select>
	
	<select id="queryProfitTypeY"  parameterType="map" resultType="map">
		select '标准值' DATA_TYPE from dual
		union all
		select '收益' DATA_TYPE from dual
	</select>
	
	<select id="queryProfitY" parameterType="map" resultType="map">
		select ROUND(NVL(aa.MONEY,0),2) COUNTS,aa.TYPE_NAME DATA_TYPE
		from (
			SELECT ROUND(SUM(NVL(T.MONEY,0)),2) MONEY,'收益' TYPE_NAME,TI.NAME
			  FROM T_INDICATORS TI
			  LEFT JOIN fil_project_head fph ON
			  <if test="TYPE !=null and TYPE !='' and TYPE ==1"> fph.PROVINCE_NAME=TI.NAME</if>
			  <if test="TYPE !=null and TYPE !='' and TYPE ==2"> fph.CLERK_NAME=TI.NAME</if>
			  LEFT JOIN (
				        select NVL(fr.MONEY,0)-NVL(FSP.SPEND_MONEY,0) MONEY,fph.ID PROJECT_ID from fil_project_head fph
	                 left join (
	                      select round(sum(NVL(frb.beginning_money,0)),2) MONEY,frb.project_id 
	                      from fi_r_beginning frb 
	                      where (frb.beginning_name='利息' or frb.item_flag=4)
	                      	<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==1"> and trunc(frb.REALITY_TIME)>=trunc(sysdate, 'yyyy') and trunc(frb.REALITY_TIME) &lt;=trunc(add_months(trunc(sysdate, 'yyyy'), 12) - 1)</if>
							<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==2"> and trunc(frb.REALITY_TIME)>=trunc(trunc(sysdate, 'yyyy')-1, 'yyyy') and trunc(frb.REALITY_TIME) &lt;=trunc(trunc(sysdate, 'yyyy')-1)</if>
							<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==3"> and trunc(frb.REALITY_TIME)>=trunc(sysdate, 'Q') and trunc(frb.REALITY_TIME) &lt;=trunc(add_months(trunc(sysdate, 'Q'), 3) - 1)</if>
							<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==4"> and trunc(frb.REALITY_TIME)>=trunc(trunc(sysdate, 'Q') - 1, 'Q') and trunc(frb.REALITY_TIME) &lt;=trunc(trunc(sysdate, 'Q') - 1)</if>
							<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==5"> and trunc(frb.REALITY_TIME)>=trunc(sysdate, 'mm') and trunc(frb.REALITY_TIME) &lt;=trunc(last_day(trunc(sysdate)))</if>
							<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==6"> and trunc(frb.REALITY_TIME)>=trunc(trunc(sysdate, 'mm')-1, 'mm') and trunc(frb.REALITY_TIME) &lt;=trunc(trunc(sysdate, 'mm')-1)</if>
	                      group by frb.project_id
	                 ) fr on fph.id=fr.project_id
	                 left join FIL_SPEND_PROJECT fsp on fph.id=fsp.project_id
	                 <if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==1"> and trunc(fsp.CREATE_DATE)>=trunc(sysdate, 'yyyy') and trunc(fsp.CREATE_DATE) &lt;=trunc(add_months(trunc(sysdate, 'yyyy'), 12) - 1)</if>
					 <if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==2"> and trunc(fsp.CREATE_DATE)>=trunc(trunc(sysdate, 'yyyy')-1, 'yyyy') and trunc(fsp.CREATE_DATE) &lt;=trunc(trunc(sysdate, 'yyyy')-1)</if>
					 <if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==3"> and trunc(fsp.CREATE_DATE)>=trunc(sysdate, 'Q') and trunc(fsp.CREATE_DATE) &lt;=trunc(add_months(trunc(sysdate, 'Q'), 3) - 1)</if>
					 <if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==4"> and trunc(fsp.CREATE_DATE)>=trunc(trunc(sysdate, 'Q') - 1, 'Q') and trunc(fsp.CREATE_DATE) &lt;=trunc(trunc(sysdate, 'Q') - 1)</if>
					 <if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==5"> and trunc(fsp.CREATE_DATE)>=trunc(sysdate, 'mm') and trunc(fsp.CREATE_DATE) &lt;=trunc(last_day(trunc(sysdate)))</if>
					 <if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==6"> and trunc(fsp.CREATE_DATE)>=trunc(trunc(sysdate, 'mm')-1, 'mm') and trunc(fsp.CREATE_DATE) &lt;=trunc(trunc(sysdate, 'mm')-1)</if>
	                 
			     )T ON T.PROJECT_ID=fph.id
			 where INDICATORS_TYPE=#{INDICATORS_TYPE} and TYPE=#{TYPE} and NAME is not null
			 	<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==1"> and trunc(TI.START_DATE)=trunc(sysdate, 'yyyy') and TI.END_DATE=trunc(add_months(trunc(sysdate, 'yyyy'), 12) - 1)</if>
				<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==2"> and trunc(TI.START_DATE)=trunc(trunc(sysdate, 'yyyy')-1, 'yyyy') and TI.END_DATE=trunc(trunc(sysdate, 'yyyy')-1)</if>
				<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==3"> and trunc(TI.START_DATE)=trunc(sysdate, 'Q') and TI.END_DATE=trunc(add_months(trunc(sysdate, 'Q'), 3) - 1)</if>
				<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==4"> and trunc(TI.START_DATE)=trunc(trunc(sysdate, 'Q') - 1, 'Q') and TI.END_DATE=trunc(trunc(sysdate, 'Q') - 1)</if>
				<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==5"> and trunc(TI.START_DATE)=trunc(sysdate, 'mm') and TI.END_DATE=trunc(last_day(trunc(sysdate)))</if>
				<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==6"> and trunc(TI.START_DATE)=trunc(trunc(sysdate, 'mm')-1, 'mm') and TI.END_DATE=trunc(trunc(sysdate, 'mm')-1)</if>
			 GROUP BY TI.NAME
			 union all 
			 select ROUND(NVL(INDICATORS_VALUE,0),2) MONEY,'标准值' TYPE_NAME,TI.NAME from T_INDICATORS TI
			 where INDICATORS_TYPE=#{INDICATORS_TYPE} and TYPE=#{TYPE} and NAME is not null
			 	<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==1"> and trunc(TI.START_DATE)=trunc(sysdate, 'yyyy') and TI.END_DATE=trunc(add_months(trunc(sysdate, 'yyyy'), 12) - 1)</if>
				<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==2"> and trunc(TI.START_DATE)=trunc(trunc(sysdate, 'yyyy')-1, 'yyyy') and TI.END_DATE=trunc(trunc(sysdate, 'yyyy')-1)</if>
				<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==3"> and trunc(TI.START_DATE)=trunc(sysdate, 'Q') and TI.END_DATE=trunc(add_months(trunc(sysdate, 'Q'), 3) - 1)</if>
				<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==4"> and trunc(TI.START_DATE)=trunc(trunc(sysdate, 'Q') - 1, 'Q') and TI.END_DATE=trunc(trunc(sysdate, 'Q') - 1)</if>
				<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==5"> and trunc(TI.START_DATE)=trunc(sysdate, 'mm') and TI.END_DATE=trunc(last_day(trunc(sysdate)))</if>
				<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==6"> and trunc(TI.START_DATE)=trunc(trunc(sysdate, 'mm')-1, 'mm') and TI.END_DATE=trunc(trunc(sysdate, 'mm')-1)</if>
		) aa where aa.TYPE_NAME=#{DATA_TYPE}
		order by aa.NAME
	</select>
	
	
	<select id="showProfitDate" parameterType="map" resultType="map">
		SELECT ${SQL_COLUMN} FROM (	 
						 SELECT CC.* ,ROWNUM ROWNO FROM 
						 (
						 	SELECT SUM(T.MONEY) MONEY_VALUE,fph.PROVINCE_NAME,fph.CLERK_NAME,FICATION.FLAG FICATION_NAME,fcc.NAME CUST_NAME,fph.PRO_CODE,fph.LEASE_CODE
							  FROM (
								        select NVL(fr.MONEY,0)-NVL(FSP.SPEND_MONEY,0) MONEY,fph.ID PROJECT_ID from fil_project_head fph
					                 left join (
					                      select round(sum(NVL(frb.beginning_money,0)),2) MONEY,frb.project_id 
					                      from fi_r_beginning frb 
					                      where (frb.beginning_name='利息' or frb.item_flag=4)
					                      	<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==1"> and trunc(frb.REALITY_TIME)>=trunc(sysdate, 'yyyy') and trunc(frb.REALITY_TIME) &lt;=trunc(add_months(trunc(sysdate, 'yyyy'), 12) - 1)</if>
											<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==2"> and trunc(frb.REALITY_TIME)>=trunc(trunc(sysdate, 'yyyy')-1, 'yyyy') and trunc(frb.REALITY_TIME) &lt;=trunc(trunc(sysdate, 'yyyy')-1)</if>
											<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==3"> and trunc(frb.REALITY_TIME)>=trunc(sysdate, 'Q') and trunc(frb.REALITY_TIME) &lt;=trunc(add_months(trunc(sysdate, 'Q'), 3) - 1)</if>
											<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==4"> and trunc(frb.REALITY_TIME)>=trunc(trunc(sysdate, 'Q') - 1, 'Q') and trunc(frb.REALITY_TIME) &lt;=trunc(trunc(sysdate, 'Q') - 1)</if>
											<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==5"> and trunc(frb.REALITY_TIME)>=trunc(sysdate, 'mm') and trunc(frb.REALITY_TIME) &lt;=trunc(last_day(trunc(sysdate)))</if>
											<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==6"> and trunc(frb.REALITY_TIME)>=trunc(trunc(sysdate, 'mm')-1, 'mm') and trunc(frb.REALITY_TIME) &lt;=trunc(trunc(sysdate, 'mm')-1)</if>
					                      group by frb.project_id
					                 ) fr on fph.id=fr.project_id
					                 left join FIL_SPEND_PROJECT fsp on fph.id=fsp.project_id
					                 <if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==1"> and trunc(fsp.CREATE_DATE)>=trunc(sysdate, 'yyyy') and trunc(fsp.CREATE_DATE) &lt;=trunc(add_months(trunc(sysdate, 'yyyy'), 12) - 1)</if>
									 <if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==2"> and trunc(fsp.CREATE_DATE)>=trunc(trunc(sysdate, 'yyyy')-1, 'yyyy') and trunc(fsp.CREATE_DATE) &lt;=trunc(trunc(sysdate, 'yyyy')-1)</if>
									 <if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==3"> and trunc(fsp.CREATE_DATE)>=trunc(sysdate, 'Q') and trunc(fsp.CREATE_DATE) &lt;=trunc(add_months(trunc(sysdate, 'Q'), 3) - 1)</if>
									 <if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==4"> and trunc(fsp.CREATE_DATE)>=trunc(trunc(sysdate, 'Q') - 1, 'Q') and trunc(fsp.CREATE_DATE) &lt;=trunc(trunc(sysdate, 'Q') - 1)</if>
									 <if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==5"> and trunc(fsp.CREATE_DATE)>=trunc(sysdate, 'mm') and trunc(fsp.CREATE_DATE) &lt;=trunc(last_day(trunc(sysdate)))</if>
									 <if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==6"> and trunc(fsp.CREATE_DATE)>=trunc(trunc(sysdate, 'mm')-1, 'mm') and trunc(fsp.CREATE_DATE) &lt;=trunc(trunc(sysdate, 'mm')-1)</if>
	                 
							     ) T
							 left join fil_project_head fph on T.PROJECT_ID=fph.id
							 left join fil_cust_client fcc on fph.client_id=fcc.id
							 left join (SELECT Tdd.code, tdd.flag FROM t_sys_data_dictionary tdd where tdd.type = '行业类型') FICATION on fph.INDUSTRY_FICATION=FICATION.code
							 <where>
							 	<if test="TYPE !=null and TYPE !='' and TYPE ==1">fph.PROVINCE_NAME is not null</if>
			  					<if test="TYPE !=null and TYPE !='' and TYPE ==2">fph.CLERK_NAME is not null</if>
			  				</where>
							 GROUP BY fcc.NAME,fph.PRO_CODE,fph.LEASE_CODE,fph.PROVINCE_NAME,fph.CLERK_NAME,FICATION.FLAG
							 <if test="TYPE !=null and TYPE !='' and TYPE ==1"> order by fph.PROVINCE_NAME</if>
			  				 <if test="TYPE !=null and TYPE !='' and TYPE ==2"> order by fph.CLERK_NAME</if>
						) CC

				<if test="PAGE_END!=null and PAGE_END!=''">	WHERE ROWNUM &lt;= #{PAGE_END}</if>
				) CCC
		 <if test="PAGE_BEGIN!=null and PAGE_BEGIN!=''"> WHERE CCC.ROWNO >= #{PAGE_BEGIN}</if>

	</select>
	
	<select id="showProfitDate_count" parameterType="map" resultType="int">
		select count(1) from (
				SELECT SUM(T.MONEY) MONEY_VALUE,fph.PROVINCE_NAME,fph.CLERK_NAME,FICATION.FLAG FICATION_NAME,fcc.NAME CUST_NAME,fph.PRO_CODE,fph.LEASE_CODE
							  FROM (
								        select NVL(fr.MONEY,0)-NVL(FSP.SPEND_MONEY,0) MONEY,fph.ID PROJECT_ID from fil_project_head fph
					                 left join (
					                      select round(sum(NVL(frb.beginning_money,0)),2) MONEY,frb.project_id 
					                      from fi_r_beginning frb 
					                      where (frb.beginning_name='利息' or frb.item_flag=4)
					                      	<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==1"> and trunc(frb.REALITY_TIME)>=trunc(sysdate, 'yyyy') and trunc(frb.REALITY_TIME) &lt;=trunc(add_months(trunc(sysdate, 'yyyy'), 12) - 1)</if>
											<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==2"> and trunc(frb.REALITY_TIME)>=trunc(trunc(sysdate, 'yyyy')-1, 'yyyy') and trunc(frb.REALITY_TIME) &lt;=trunc(trunc(sysdate, 'yyyy')-1)</if>
											<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==3"> and trunc(frb.REALITY_TIME)>=trunc(sysdate, 'Q') and trunc(frb.REALITY_TIME) &lt;=trunc(add_months(trunc(sysdate, 'Q'), 3) - 1)</if>
											<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==4"> and trunc(frb.REALITY_TIME)>=trunc(trunc(sysdate, 'Q') - 1, 'Q') and trunc(frb.REALITY_TIME) &lt;=trunc(trunc(sysdate, 'Q') - 1)</if>
											<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==5"> and trunc(frb.REALITY_TIME)>=trunc(sysdate, 'mm') and trunc(frb.REALITY_TIME) &lt;=trunc(last_day(trunc(sysdate)))</if>
											<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==6"> and trunc(frb.REALITY_TIME)>=trunc(trunc(sysdate, 'mm')-1, 'mm') and trunc(frb.REALITY_TIME) &lt;=trunc(trunc(sysdate, 'mm')-1)</if>
					                      group by frb.project_id
					                 ) fr on fph.id=fr.project_id
					                 left join FIL_SPEND_PROJECT fsp on fph.id=fsp.project_id
					                 <if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==1"> and trunc(fsp.CREATE_DATE)>=trunc(sysdate, 'yyyy') and trunc(fsp.CREATE_DATE) &lt;=trunc(add_months(trunc(sysdate, 'yyyy'), 12) - 1)</if>
									 <if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==2"> and trunc(fsp.CREATE_DATE)>=trunc(trunc(sysdate, 'yyyy')-1, 'yyyy') and trunc(fsp.CREATE_DATE) &lt;=trunc(trunc(sysdate, 'yyyy')-1)</if>
									 <if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==3"> and trunc(fsp.CREATE_DATE)>=trunc(sysdate, 'Q') and trunc(fsp.CREATE_DATE) &lt;=trunc(add_months(trunc(sysdate, 'Q'), 3) - 1)</if>
									 <if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==4"> and trunc(fsp.CREATE_DATE)>=trunc(trunc(sysdate, 'Q') - 1, 'Q') and trunc(fsp.CREATE_DATE) &lt;=trunc(trunc(sysdate, 'Q') - 1)</if>
									 <if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==5"> and trunc(fsp.CREATE_DATE)>=trunc(sysdate, 'mm') and trunc(fsp.CREATE_DATE) &lt;=trunc(last_day(trunc(sysdate)))</if>
									 <if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==6"> and trunc(fsp.CREATE_DATE)>=trunc(trunc(sysdate, 'mm')-1, 'mm') and trunc(fsp.CREATE_DATE) &lt;=trunc(trunc(sysdate, 'mm')-1)</if>
	                 
							     ) T
							 left join fil_project_head fph on T.PROJECT_ID=fph.id
							 left join fil_cust_client fcc on fph.client_id=fcc.id
							 left join (SELECT Tdd.code, tdd.flag FROM t_sys_data_dictionary tdd where tdd.type = '行业类型') FICATION on fph.INDUSTRY_FICATION=FICATION.code
							 <where>
							 	<if test="TYPE !=null and TYPE !='' and TYPE ==1">fph.PROVINCE_NAME is not null</if>
			  					<if test="TYPE !=null and TYPE !='' and TYPE ==2">fph.CLERK_NAME is not null</if>
			  				</where>
							 GROUP BY fcc.NAME,fph.PRO_CODE,fph.LEASE_CODE,fph.PROVINCE_NAME,fph.CLERK_NAME,FICATION.FLAG
							 <if test="TYPE !=null and TYPE !='' and TYPE ==1"> order by fph.PROVINCE_NAME</if>
			  				 <if test="TYPE !=null and TYPE !='' and TYPE ==2"> order by fph.CLERK_NAME</if>
		)
	</select>
	
	<select id="queryDunRateTypeY"  parameterType="map" resultType="map">
		select '标准值' DATA_TYPE from dual
		union all
		select '逾期率' DATA_TYPE from dual
	</select>
	
	<select id="queryDunRateY" parameterType="map" resultType="map">
		select ROUND(NVL(aa.MONEY,0),2) COUNTS,aa.TYPE_NAME DATA_TYPE
		from (
			SELECT ROUND(sum(fr.beginning_paid) * 100/sum(fr.beginning_money),2) MONEY,'逾期率' TYPE_NAME,TI.NAME
			  FROM T_INDICATORS TI
			  LEFT JOIN (
			  	select ID,fph.PROVINCE_NAME,fph.CLERK_NAME,tdd.FLAG FICATION_NAME from fil_project_head fph 
			  	left join t_sys_data_dictionary tdd on tdd.type = '行业类型' and fph.INDUSTRY_FICATION=tdd.code
			  	where fph.LEASE_CODE is not null
			  		<if test="TYPE !=null and TYPE !='' and TYPE ==1"> AND fph.PROVINCE_NAME is not null</if>
				  	<if test="TYPE !=null and TYPE !='' and TYPE ==2"> AND fph.CLERK_NAME  is not null</if>
				  	<if test="TYPE !=null and TYPE !='' and TYPE ==3"> AND fph.INDUSTRY_FICATION is not null</if>
			  ) fph ON
			  <if test="TYPE !=null and TYPE !='' and TYPE ==1"> fph.PROVINCE_NAME=TI.NAME</if>
			  <if test="TYPE !=null and TYPE !='' and TYPE ==2"> fph.CLERK_NAME=TI.NAME</if>
			  <if test="TYPE !=null and TYPE !='' and TYPE ==3"> fph.FICATION_NAME=TI.NAME</if>
			  LEFT JOIN (
			  			select frb.PROJECT_ID,ROUND(sum(NVL(frb.beginning_money,0)),2) beginning_money,ROUND(sum(NVL(frb.beginning_money,0))-sum(NVL(frb.beginning_paid,0)),2) beginning_paid
						from fi_r_beginning frb
						where frb.item_flag=2
						    <if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==1"> and trunc(frb.BEGINNING_RECEIVE_DATA)>=trunc(sysdate, 'yyyy') and trunc(frb.BEGINNING_RECEIVE_DATA) &lt;=trunc(add_months(trunc(sysdate, 'yyyy'), 12) - 1)</if>
							<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==2"> and trunc(frb.BEGINNING_RECEIVE_DATA)>=trunc(trunc(sysdate, 'yyyy')-1, 'yyyy') and trunc(frb.BEGINNING_RECEIVE_DATA) &lt;=trunc(trunc(sysdate, 'yyyy')-1)</if>
							<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==3"> and trunc(frb.BEGINNING_RECEIVE_DATA)>=trunc(sysdate, 'Q') and trunc(frb.BEGINNING_RECEIVE_DATA) &lt;=trunc(add_months(trunc(sysdate, 'Q'), 3) - 1)</if>
							<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==4"> and trunc(frb.BEGINNING_RECEIVE_DATA)>=trunc(trunc(sysdate, 'Q') - 1, 'Q') and trunc(frb.BEGINNING_RECEIVE_DATA) &lt;=trunc(trunc(sysdate, 'Q') - 1)</if>
							<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==5"> and trunc(frb.BEGINNING_RECEIVE_DATA)>=trunc(sysdate, 'mm') and trunc(frb.BEGINNING_RECEIVE_DATA) &lt;=trunc(last_day(trunc(sysdate)))</if>
							<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==6"> and trunc(frb.BEGINNING_RECEIVE_DATA)>=trunc(trunc(sysdate, 'mm')-1, 'mm') and trunc(frb.BEGINNING_RECEIVE_DATA) &lt;=trunc(trunc(sysdate, 'mm')-1)</if>
						 
						group by frb.project_id
	                 ) fr on fph.id=fr.project_id
			 where TI.INDICATORS_TYPE=#{INDICATORS_TYPE} and TI.TYPE=#{TYPE} and TI.NAME is not null
			 	<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==1"> and trunc(TI.START_DATE)=trunc(sysdate, 'yyyy') and TI.END_DATE=trunc(add_months(trunc(sysdate, 'yyyy'), 12) - 1)</if>
				<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==2"> and trunc(TI.START_DATE)=trunc(trunc(sysdate, 'yyyy')-1, 'yyyy') and TI.END_DATE=trunc(trunc(sysdate, 'yyyy')-1)</if>
				<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==3"> and trunc(TI.START_DATE)=trunc(sysdate, 'Q') and TI.END_DATE=trunc(add_months(trunc(sysdate, 'Q'), 3) - 1)</if>
				<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==4"> and trunc(TI.START_DATE)=trunc(trunc(sysdate, 'Q') - 1, 'Q') and TI.END_DATE=trunc(trunc(sysdate, 'Q') - 1)</if>
				<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==5"> and trunc(TI.START_DATE)=trunc(sysdate, 'mm') and TI.END_DATE=trunc(last_day(trunc(sysdate)))</if>
				<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==6"> and trunc(TI.START_DATE)=trunc(trunc(sysdate, 'mm')-1, 'mm') and TI.END_DATE=trunc(trunc(sysdate, 'mm')-1)</if>
			 GROUP BY TI.NAME
			 union all 
			 select ROUND(NVL(INDICATORS_VALUE,0),2) MONEY,'标准值' TYPE_NAME,TI.NAME from T_INDICATORS TI
			 where INDICATORS_TYPE=#{INDICATORS_TYPE} and TYPE=#{TYPE} and NAME is not null
			 	<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==1"> and trunc(TI.START_DATE)=trunc(sysdate, 'yyyy') and TI.END_DATE=trunc(add_months(trunc(sysdate, 'yyyy'), 12) - 1)</if>
				<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==2"> and trunc(TI.START_DATE)=trunc(trunc(sysdate, 'yyyy')-1, 'yyyy') and TI.END_DATE=trunc(trunc(sysdate, 'yyyy')-1)</if>
				<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==3"> and trunc(TI.START_DATE)=trunc(sysdate, 'Q') and TI.END_DATE=trunc(add_months(trunc(sysdate, 'Q'), 3) - 1)</if>
				<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==4"> and trunc(TI.START_DATE)=trunc(trunc(sysdate, 'Q') - 1, 'Q') and TI.END_DATE=trunc(trunc(sysdate, 'Q') - 1)</if>
				<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==5"> and trunc(TI.START_DATE)=trunc(sysdate, 'mm') and TI.END_DATE=trunc(last_day(trunc(sysdate)))</if>
				<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==6"> and trunc(TI.START_DATE)=trunc(trunc(sysdate, 'mm')-1, 'mm') and TI.END_DATE=trunc(trunc(sysdate, 'mm')-1)</if>
		) aa where aa.TYPE_NAME=#{DATA_TYPE}
		order by aa.NAME
	</select>
	
	<select id="showDunRateDate" parameterType="map" resultType="map">
		SELECT ${SQL_COLUMN} FROM (	 
						 SELECT CC.* ,ROWNUM ROWNO FROM 
						 (
						 	SELECT ROUND(sum(T.beginning_paid) * 100/sum(T.beginning_money),2) || '%' MONEY_VALUE,fph.PROVINCE_NAME,fph.CLERK_NAME,FICATION.FLAG FICATION_NAME,fcc.NAME CUST_NAME,fph.PRO_CODE,fph.LEASE_CODE
							  FROM (
								       select frb.PROJECT_ID,ROUND(sum(NVL(frb.beginning_money,0)),2) beginning_money,ROUND(sum(NVL(frb.beginning_money,0))-sum(NVL(frb.beginning_paid,0)),2) beginning_paid
											from fi_r_beginning frb
											where frb.item_flag=2
											    <if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==1"> and trunc(frb.BEGINNING_RECEIVE_DATA)>=trunc(sysdate, 'yyyy') and trunc(frb.BEGINNING_RECEIVE_DATA) &lt;=trunc(add_months(trunc(sysdate, 'yyyy'), 12) - 1)</if>
												<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==2"> and trunc(frb.BEGINNING_RECEIVE_DATA)>=trunc(trunc(sysdate, 'yyyy')-1, 'yyyy') and trunc(frb.BEGINNING_RECEIVE_DATA) &lt;=trunc(trunc(sysdate, 'yyyy')-1)</if>
												<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==3"> and trunc(frb.BEGINNING_RECEIVE_DATA)>=trunc(sysdate, 'Q') and trunc(frb.BEGINNING_RECEIVE_DATA) &lt;=trunc(add_months(trunc(sysdate, 'Q'), 3) - 1)</if>
												<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==4"> and trunc(frb.BEGINNING_RECEIVE_DATA)>=trunc(trunc(sysdate, 'Q') - 1, 'Q') and trunc(frb.BEGINNING_RECEIVE_DATA) &lt;=trunc(trunc(sysdate, 'Q') - 1)</if>
												<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==5"> and trunc(frb.BEGINNING_RECEIVE_DATA)>=trunc(sysdate, 'mm') and trunc(frb.BEGINNING_RECEIVE_DATA) &lt;=trunc(last_day(trunc(sysdate)))</if>
												<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==6"> and trunc(frb.BEGINNING_RECEIVE_DATA)>=trunc(trunc(sysdate, 'mm')-1, 'mm') and trunc(frb.BEGINNING_RECEIVE_DATA) &lt;=trunc(trunc(sysdate, 'mm')-1)</if>
											 
											group by frb.project_id
	                 
							     ) T
							 left join fil_project_head fph on T.PROJECT_ID=fph.id
							 left join fil_cust_client fcc on fph.client_id=fcc.id
							 left join (SELECT Tdd.code, tdd.flag FROM t_sys_data_dictionary tdd where tdd.type = '行业类型') FICATION on fph.INDUSTRY_FICATION=FICATION.code
							 <where>
							 	<if test="TYPE !=null and TYPE !='' and TYPE ==1">fph.PROVINCE_NAME is not null</if>
			  					<if test="TYPE !=null and TYPE !='' and TYPE ==2">fph.CLERK_NAME is not null</if>
			  					<if test="TYPE !=null and TYPE !='' and TYPE ==3">fph.INDUSTRY_FICATION is not null</if>
			  				</where>
							 GROUP BY fcc.NAME,fph.PRO_CODE,fph.LEASE_CODE,fph.PROVINCE_NAME,fph.CLERK_NAME,FICATION.FLAG
							 <if test="TYPE !=null and TYPE !='' and TYPE ==1"> order by fph.PROVINCE_NAME</if>
			  				 <if test="TYPE !=null and TYPE !='' and TYPE ==2"> order by fph.CLERK_NAME</if>
			  				 <if test="TYPE !=null and TYPE !='' and TYPE ==3"> order by FICATION.FLAG</if>
						) CC

				<if test="PAGE_END!=null and PAGE_END!=''">	WHERE ROWNUM &lt;= #{PAGE_END}</if>
				) CCC
		 <if test="PAGE_BEGIN!=null and PAGE_BEGIN!=''"> WHERE CCC.ROWNO >= #{PAGE_BEGIN}</if>

	</select>
	
	<select id="showDunRateDate_count" parameterType="map" resultType="int">
		select count(1) from (
				SELECT ROUND(sum(T.beginning_paid) * 100/sum(T.beginning_money),2) MONEY_VALUE,fph.PROVINCE_NAME,fph.CLERK_NAME,FICATION.FLAG FICATION_NAME,fcc.NAME CUST_NAME,fph.PRO_CODE,fph.LEASE_CODE
							  FROM (
								       select frb.PROJECT_ID,ROUND(sum(NVL(frb.beginning_money,0)),2) beginning_money,ROUND(sum(NVL(frb.beginning_money,0))-sum(NVL(frb.beginning_paid,0)),2) beginning_paid
											from fi_r_beginning frb
											where frb.item_flag=2
											    <if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==1"> and trunc(frb.BEGINNING_RECEIVE_DATA)>=trunc(sysdate, 'yyyy') and trunc(frb.BEGINNING_RECEIVE_DATA) &lt;=trunc(add_months(trunc(sysdate, 'yyyy'), 12) - 1)</if>
												<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==2"> and trunc(frb.BEGINNING_RECEIVE_DATA)>=trunc(trunc(sysdate, 'yyyy')-1, 'yyyy') and trunc(frb.BEGINNING_RECEIVE_DATA) &lt;=trunc(trunc(sysdate, 'yyyy')-1)</if>
												<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==3"> and trunc(frb.BEGINNING_RECEIVE_DATA)>=trunc(sysdate, 'Q') and trunc(frb.BEGINNING_RECEIVE_DATA) &lt;=trunc(add_months(trunc(sysdate, 'Q'), 3) - 1)</if>
												<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==4"> and trunc(frb.BEGINNING_RECEIVE_DATA)>=trunc(trunc(sysdate, 'Q') - 1, 'Q') and trunc(frb.BEGINNING_RECEIVE_DATA) &lt;=trunc(trunc(sysdate, 'Q') - 1)</if>
												<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==5"> and trunc(frb.BEGINNING_RECEIVE_DATA)>=trunc(sysdate, 'mm') and trunc(frb.BEGINNING_RECEIVE_DATA) &lt;=trunc(last_day(trunc(sysdate)))</if>
												<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==6"> and trunc(frb.BEGINNING_RECEIVE_DATA)>=trunc(trunc(sysdate, 'mm')-1, 'mm') and trunc(frb.BEGINNING_RECEIVE_DATA) &lt;=trunc(trunc(sysdate, 'mm')-1)</if>
											 
											group by frb.project_id
	                 
							     ) T
							 left join fil_project_head fph on T.PROJECT_ID=fph.id
							 left join fil_cust_client fcc on fph.client_id=fcc.id
							 left join (SELECT Tdd.code, tdd.flag FROM t_sys_data_dictionary tdd where tdd.type = '行业类型') FICATION on fph.INDUSTRY_FICATION=FICATION.code
							 <where>
							 	<if test="TYPE !=null and TYPE !='' and TYPE ==1">fph.PROVINCE_NAME is not null</if>
			  					<if test="TYPE !=null and TYPE !='' and TYPE ==2">fph.CLERK_NAME is not null</if>
			  					<if test="TYPE !=null and TYPE !='' and TYPE ==3">fph.INDUSTRY_FICATION is not null</if>
			  				</where>
							 GROUP BY fcc.NAME,fph.PRO_CODE,fph.LEASE_CODE,fph.PROVINCE_NAME,fph.CLERK_NAME,FICATION.FLAG
							 <if test="TYPE !=null and TYPE !='' and TYPE ==1"> order by fph.PROVINCE_NAME</if>
			  				 <if test="TYPE !=null and TYPE !='' and TYPE ==2"> order by fph.CLERK_NAME</if>
			  				 <if test="TYPE !=null and TYPE !='' and TYPE ==3"> order by FICATION.FLAG</if>
		)
	</select>
	
	<select id="queryYieldRateTypeY"  parameterType="map" resultType="map">
		select '标准值' DATA_TYPE from dual
		union all
		select '收益率' DATA_TYPE from dual
	</select>
	
	
	<select id="queryYieldRateY" parameterType="map" resultType="map">
		select ROUND(NVL(aa.MONEY,0),2) COUNTS,aa.TYPE_NAME DATA_TYPE
		from (
			SELECT ROUND(avg(fr.IRRAVG),2) MONEY,'收益率' TYPE_NAME,TI.NAME
			  FROM T_INDICATORS TI
			  LEFT JOIN (
			  	select ID,fph.PROVINCE_NAME,fph.CLERK_NAME,tdd.FLAG FICATION_NAME from fil_project_head fph 
			  	left join t_sys_data_dictionary tdd on tdd.type = '行业类型' and fph.INDUSTRY_FICATION=tdd.code
			  	where fph.LEASE_CODE is not null
			  		<if test="TYPE !=null and TYPE !='' and TYPE ==1"> AND fph.PROVINCE_NAME is not null</if>
				  	<if test="TYPE !=null and TYPE !='' and TYPE ==2"> AND fph.CLERK_NAME  is not null</if>
				  	<if test="TYPE !=null and TYPE !='' and TYPE ==3"> AND fph.INDUSTRY_FICATION is not null</if>
			  ) fph ON
			  <if test="TYPE !=null and TYPE !='' and TYPE ==1"> fph.PROVINCE_NAME=TI.NAME</if>
			  <if test="TYPE !=null and TYPE !='' and TYPE ==2"> fph.CLERK_NAME=TI.NAME</if>
			  <if test="TYPE !=null and TYPE !='' and TYPE ==3"> fph.FICATION_NAME=TI.NAME</if>
			  LEFT JOIN (
			  			select fpi.project_id,avg(fpi.real_irr) IRRAVG from fil_project_irr fpi
			  			<where>
						    <if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==1"> and trunc(fpi.CREATE_DATE)>=trunc(sysdate, 'yyyy') and trunc(fpi.CREATE_DATE) &lt;=trunc(add_months(trunc(sysdate, 'yyyy'), 12) - 1)</if>
							<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==2"> and trunc(fpi.CREATE_DATE)>=trunc(trunc(sysdate, 'yyyy')-1, 'yyyy') and trunc(fpi.CREATE_DATE) &lt;=trunc(trunc(sysdate, 'yyyy')-1)</if>
							<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==3"> and trunc(fpi.CREATE_DATE)>=trunc(sysdate, 'Q') and trunc(fpi.CREATE_DATE) &lt;=trunc(add_months(trunc(sysdate, 'Q'), 3) - 1)</if>
							<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==4"> and trunc(fpi.CREATE_DATE)>=trunc(trunc(sysdate, 'Q') - 1, 'Q') and trunc(fpi.CREATE_DATE) &lt;=trunc(trunc(sysdate, 'Q') - 1)</if>
							<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==5"> and trunc(fpi.CREATE_DATE)>=trunc(sysdate, 'mm') and trunc(fpi.CREATE_DATE) &lt;=trunc(last_day(trunc(sysdate)))</if>
							<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==6"> and trunc(fpi.CREATE_DATE)>=trunc(trunc(sysdate, 'mm')-1, 'mm') and trunc(fpi.CREATE_DATE) &lt;=trunc(trunc(sysdate, 'mm')-1)</if>
						</where> 
						group by fpi.project_id
	                 ) fr on fph.id=fr.project_id
			 where TI.INDICATORS_TYPE=#{INDICATORS_TYPE} and TI.TYPE=#{TYPE} and TI.NAME is not null
			 	<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==1"> and trunc(TI.START_DATE)=trunc(sysdate, 'yyyy') and TI.END_DATE=trunc(add_months(trunc(sysdate, 'yyyy'), 12) - 1)</if>
				<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==2"> and trunc(TI.START_DATE)=trunc(trunc(sysdate, 'yyyy')-1, 'yyyy') and TI.END_DATE=trunc(trunc(sysdate, 'yyyy')-1)</if>
				<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==3"> and trunc(TI.START_DATE)=trunc(sysdate, 'Q') and TI.END_DATE=trunc(add_months(trunc(sysdate, 'Q'), 3) - 1)</if>
				<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==4"> and trunc(TI.START_DATE)=trunc(trunc(sysdate, 'Q') - 1, 'Q') and TI.END_DATE=trunc(trunc(sysdate, 'Q') - 1)</if>
				<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==5"> and trunc(TI.START_DATE)=trunc(sysdate, 'mm') and TI.END_DATE=trunc(last_day(trunc(sysdate)))</if>
				<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==6"> and trunc(TI.START_DATE)=trunc(trunc(sysdate, 'mm')-1, 'mm') and TI.END_DATE=trunc(trunc(sysdate, 'mm')-1)</if>
			 GROUP BY TI.NAME
			 union all 
			 select ROUND(NVL(INDICATORS_VALUE,0),2) MONEY,'标准值' TYPE_NAME,TI.NAME from T_INDICATORS TI
			 where INDICATORS_TYPE=#{INDICATORS_TYPE} and TYPE=#{TYPE} and NAME is not null
			 	<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==1"> and trunc(TI.START_DATE)=trunc(sysdate, 'yyyy') and TI.END_DATE=trunc(add_months(trunc(sysdate, 'yyyy'), 12) - 1)</if>
				<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==2"> and trunc(TI.START_DATE)=trunc(trunc(sysdate, 'yyyy')-1, 'yyyy') and TI.END_DATE=trunc(trunc(sysdate, 'yyyy')-1)</if>
				<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==3"> and trunc(TI.START_DATE)=trunc(sysdate, 'Q') and TI.END_DATE=trunc(add_months(trunc(sysdate, 'Q'), 3) - 1)</if>
				<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==4"> and trunc(TI.START_DATE)=trunc(trunc(sysdate, 'Q') - 1, 'Q') and TI.END_DATE=trunc(trunc(sysdate, 'Q') - 1)</if>
				<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==5"> and trunc(TI.START_DATE)=trunc(sysdate, 'mm') and TI.END_DATE=trunc(last_day(trunc(sysdate)))</if>
				<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==6"> and trunc(TI.START_DATE)=trunc(trunc(sysdate, 'mm')-1, 'mm') and TI.END_DATE=trunc(trunc(sysdate, 'mm')-1)</if>
		) aa where aa.TYPE_NAME=#{DATA_TYPE}
		order by aa.NAME
	</select>
	
	<select id="showYieldRateDate" parameterType="map" resultType="map">
		SELECT ${SQL_COLUMN} FROM (	 
						 SELECT CC.* ,ROWNUM ROWNO FROM 
						 (
						 	SELECT ROUND(avg(T.IRRAVG),2) || '%' MONEY_VALUE,fph.PROVINCE_NAME,fph.CLERK_NAME,FICATION.FLAG FICATION_NAME,fcc.NAME CUST_NAME,fph.PRO_CODE,fph.LEASE_CODE
							  FROM (
								       select fpi.project_id,avg(fpi.real_irr) IRRAVG from fil_project_irr fpi
							  			<where>
										    <if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==1"> and trunc(fpi.CREATE_DATE)>=trunc(sysdate, 'yyyy') and trunc(fpi.CREATE_DATE) &lt;=trunc(add_months(trunc(sysdate, 'yyyy'), 12) - 1)</if>
											<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==2"> and trunc(fpi.CREATE_DATE)>=trunc(trunc(sysdate, 'yyyy')-1, 'yyyy') and trunc(fpi.CREATE_DATE) &lt;=trunc(trunc(sysdate, 'yyyy')-1)</if>
											<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==3"> and trunc(fpi.CREATE_DATE)>=trunc(sysdate, 'Q') and trunc(fpi.CREATE_DATE) &lt;=trunc(add_months(trunc(sysdate, 'Q'), 3) - 1)</if>
											<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==4"> and trunc(fpi.CREATE_DATE)>=trunc(trunc(sysdate, 'Q') - 1, 'Q') and trunc(fpi.CREATE_DATE) &lt;=trunc(trunc(sysdate, 'Q') - 1)</if>
											<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==5"> and trunc(fpi.CREATE_DATE)>=trunc(sysdate, 'mm') and trunc(fpi.CREATE_DATE) &lt;=trunc(last_day(trunc(sysdate)))</if>
											<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==6"> and trunc(fpi.CREATE_DATE)>=trunc(trunc(sysdate, 'mm')-1, 'mm') and trunc(fpi.CREATE_DATE) &lt;=trunc(trunc(sysdate, 'mm')-1)</if>
										</where> 
										group by fpi.project_id
	                 
							     ) T
							 left join fil_project_head fph on T.PROJECT_ID=fph.id
							 left join fil_cust_client fcc on fph.client_id=fcc.id
							 left join (SELECT Tdd.code, tdd.flag FROM t_sys_data_dictionary tdd where tdd.type = '行业类型') FICATION on fph.INDUSTRY_FICATION=FICATION.code
							 <where>
							 	<if test="TYPE !=null and TYPE !='' and TYPE ==1">fph.PROVINCE_NAME is not null</if>
			  					<if test="TYPE !=null and TYPE !='' and TYPE ==2">fph.CLERK_NAME is not null</if>
			  					<if test="TYPE !=null and TYPE !='' and TYPE ==3">fph.INDUSTRY_FICATION is not null</if>
			  				</where>
							 GROUP BY fcc.NAME,fph.PRO_CODE,fph.LEASE_CODE,fph.PROVINCE_NAME,fph.CLERK_NAME,FICATION.FLAG
							 <if test="TYPE !=null and TYPE !='' and TYPE ==1"> order by fph.PROVINCE_NAME</if>
			  				 <if test="TYPE !=null and TYPE !='' and TYPE ==2"> order by fph.CLERK_NAME</if>
			  				 <if test="TYPE !=null and TYPE !='' and TYPE ==3"> order by FICATION.FLAG</if>
						) CC

				<if test="PAGE_END!=null and PAGE_END!=''">	WHERE ROWNUM &lt;= #{PAGE_END}</if>
				) CCC
		 <if test="PAGE_BEGIN!=null and PAGE_BEGIN!=''"> WHERE CCC.ROWNO >= #{PAGE_BEGIN}</if>

	</select>
	
	<select id="showYieldRateDate_count" parameterType="map" resultType="int">
		select count(1) from (
				SELECT ROUND(avg(T.IRRAVG),2) MONEY_VALUE,fph.PROVINCE_NAME,fph.CLERK_NAME,FICATION.FLAG FICATION_NAME,fcc.NAME CUST_NAME,fph.PRO_CODE,fph.LEASE_CODE
							  FROM (
								       select fpi.project_id,avg(fpi.real_irr) IRRAVG from fil_project_irr fpi
							  			<where>
										    <if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==1"> and trunc(fpi.CREATE_DATE)>=trunc(sysdate, 'yyyy') and trunc(fpi.CREATE_DATE) &lt;=trunc(add_months(trunc(sysdate, 'yyyy'), 12) - 1)</if>
											<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==2"> and trunc(fpi.CREATE_DATE)>=trunc(trunc(sysdate, 'yyyy')-1, 'yyyy') and trunc(fpi.CREATE_DATE) &lt;=trunc(trunc(sysdate, 'yyyy')-1)</if>
											<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==3"> and trunc(fpi.CREATE_DATE)>=trunc(sysdate, 'Q') and trunc(fpi.CREATE_DATE) &lt;=trunc(add_months(trunc(sysdate, 'Q'), 3) - 1)</if>
											<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==4"> and trunc(fpi.CREATE_DATE)>=trunc(trunc(sysdate, 'Q') - 1, 'Q') and trunc(fpi.CREATE_DATE) &lt;=trunc(trunc(sysdate, 'Q') - 1)</if>
											<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==5"> and trunc(fpi.CREATE_DATE)>=trunc(sysdate, 'mm') and trunc(fpi.CREATE_DATE) &lt;=trunc(last_day(trunc(sysdate)))</if>
											<if test="TIMETYPE !=null and TIMETYPE !='' and TIMETYPE ==6"> and trunc(fpi.CREATE_DATE)>=trunc(trunc(sysdate, 'mm')-1, 'mm') and trunc(fpi.CREATE_DATE) &lt;=trunc(trunc(sysdate, 'mm')-1)</if>
										</where> 
										group by fpi.project_id
	                 
							     ) T
							 left join fil_project_head fph on T.PROJECT_ID=fph.id
							 left join fil_cust_client fcc on fph.client_id=fcc.id
							 left join (SELECT Tdd.code, tdd.flag FROM t_sys_data_dictionary tdd where tdd.type = '行业类型') FICATION on fph.INDUSTRY_FICATION=FICATION.code
							 <where>
							 	<if test="TYPE !=null and TYPE !='' and TYPE ==1">fph.PROVINCE_NAME is not null</if>
			  					<if test="TYPE !=null and TYPE !='' and TYPE ==2">fph.CLERK_NAME is not null</if>
			  					<if test="TYPE !=null and TYPE !='' and TYPE ==3">fph.INDUSTRY_FICATION is not null</if>
			  				</where>
							 GROUP BY fcc.NAME,fph.PRO_CODE,fph.LEASE_CODE,fph.PROVINCE_NAME,fph.CLERK_NAME,FICATION.FLAG
							 <if test="TYPE !=null and TYPE !='' and TYPE ==1"> order by fph.PROVINCE_NAME</if>
			  				 <if test="TYPE !=null and TYPE !='' and TYPE ==2"> order by fph.CLERK_NAME</if>
			  				 <if test="TYPE !=null and TYPE !='' and TYPE ==3"> order by FICATION.FLAG</if>
		)
	</select>
</mapper>
#parse("content/importBase.vm")
<script type="text/javascript" src="$_basePath/gls/js/ajaxfileupload.js"></script>
<script type="text/javascript" src="$_basePath/gls/js/glsAreaPjt.js"></script>
<!--<script type="text/javascript" src="$_basePath/creditReports/js/ajaxfileupload.js"></script>

-->
<script type="text/javascript" >
var userid=$USERID;
var orgId=$ORG_ID;
function confrim(ID,CUS_NAME,PRO_CODE){
	if(confirm('确定立项吗?')){
	
	top.addTab("添加客户信息",_basePath+"/customers/Customers!toAddCust.action?CUST_TYPE=NP&GLS_CODE="+PRO_CODE);
	
	}
}


/**添加**/
function addGls(){
	$("#fromDate input[name='DEPT']").val('$!oUser');
	$("#fromDate input[name='WRITE_MEN']").val('$!user1');
	$("#fromDate input[name='PRO_CODE']").val('$!code1');
	$("#TEMPLATE_TYPE_UPDATE").combobox('select','1');
	/*显示省市县**/
	showPjtLocation();
	//$("#GENJINREN").val(json.data.NAME);
	$("#olduploadFileListName2").empty();
	$("#olduploadFileListName2").hide();
	$("#oldUploadFileList2").empty();
	$("#oldUploadFileList2").hide();
	$("#oldPjtLocation").hide();
	$("#oldUploadedFile").hide();
	//alert('$!code1');
	$(function(){
   var curr_time = new Date();
   var strDate = curr_time.getFullYear()+"-";
   strDate += curr_time.getMonth()+1+"-";
   strDate += curr_time.getDate();
 
   $("#sjtxdate").datebox("setValue", strDate); 
  });
	
	 controlMove("dialogDiv"); 
	$("#dialogDiv").dialog({   
		 title:"添 加",
		 buttons: [{
				  id:"btnbc",
	            text:'保 存',
	         iconCls:'icon-save',
	         handler:function(){
			 	$('#btnbc').linkbutton('disable');
				
				/**地区赋值begin**/
            	getPjtLocationData();
            	/**地区赋值end**/
            	var files={};
				$("#oldUploadFileList2").children("input[type='file']").each(function(index){
			 		files[index]=this.id;
			 	});
				if($('#fromDate').form('validate')){
				jQuery.ajaxFileUpload({
			        url: "GlsPjtLocation!saveFiles.action?_dateTime="+new Date(),//?param=+getFromData("#fromDate2"),
			        type: "post",
					secureuri: false,
        	        fileElementId: files,
			        dataType: "json",
			        success: function(json){
			        	jQuery.ajax({
					        url: "Gls!doAddGls.action?_dateTime="+new Date(),
					        data: "param="+getFromData("#fromDate")+"&list="+JSON.stringify(json.data),
					        type: "post",
					        //secureuri: false,
		        	        //fileElementId: files,
							dataType: "json",
					        success: function(json){
				                if(json.flag){
								
									$("#dialogDiv").dialog('close');
									//$('#pageTable').datagrid('load',{ID:json.data.ID});
									$.messager.alert('提示','保存成功');
									location.reload();
								}else{
									$('#btnbc').linkbutton('enable');
									$.messager.alert('提示','保存失败，请与管理员联系！','warning');
								}
					        }
					    });
			        }
				});
				}
				else{
					$('#btnbc').linkbutton('enable');
				}
             }
        },{
            text:'关 闭',
			iconCls:'icon-cancel',
            handler:function(){
               $("#dialogDiv").dialog('close');
            }
        }]
	}); 
	
	$("#dialogDiv").dialog('open');
	
}

    
function validate(){
	if(""==$('#GENJINREN2').combobox("getValue")){
		$.messager.alert('提示','请选择跟进人');
		return false;
	}
	if(""==$('#GENJIN_DATE2').datebox("getValue")){
		$.messager.alert('提示','请选择跟进时间');
		return false;
	}
	return true;
}

/**添加跟进**/
function addGlsGenjin(ID){
	//alert(ID);
	jQuery.ajax({
        url: "Gls!getGlsData.action?_dateTime="+new Date(),
        data: "ID=" + ID,
        type: "post",
        dataType: "json",
        success: function(json){
            if (json.flag) {
            	$("#fromDate2 input[name='GLS_ID2']").val(json.data.ID);
				$("#fromDate2 input[name='PRO_CODE2']").val(json.data.PRO_CODE);
				$("#fromDate2 input[name='PJT_SHOT_NAME2']").val(json.data.PJT_SHOT_NAME);
				$("#fromDate2 input[name='CUS_NAME2']").val(json.data.CUS_NAME);
				$("#PRICE2").numberbox('setValue',json.data.PRICE);
				$("#PRO_COUNT2").numberbox('setValue',json.data.PRO_COUNT);
				$("#fromDate2 input[name='PJT_NAME2']").val(json.data.PJT_NAME);
				$("#fromDate2 input[name='DEPT2']").val(json.data.DEPT);
				$("#fromDate2 input[name='PJT_LOCATION2']").val(json.data.PJT_LOCATION);
				$("#fromDate2 input[name='PJT_REFEREE2']").val(json.data.PJT_REFEREE);
				$("#fromDate2 input[name='MEASUREMENT2']").val(json.data.MEASUREMENT);
				$("#fromDate2 input[name='WRITE_MEN2']").val(json.data.WRITE_MEN);
				$("#TEMPLATE_TYPE_UPDATE2").combobox('select',json.data.STATUS);
				
				//$("#vv1").datebox('setValue', json.data.GENJIN_DATE);
				//$("#GENJINREN2").val(json.data.GENJINREN);
				//$("#FOLLOWUP_RECORDS2").val(json.data.FOLLOWUP_RECORDS);
				//$("#NEXT_FOLLOW_PLAN2").val(json.data.NEXT_FOLLOW_PLAN);
				
        }}
    });  
   
	/* $(function(){
           var curr_time = new Date();
          	var strDate = curr_time.getFullYear()+"-";
				strDate += (curr_time.getMonth()<10?"0":"")+(curr_time.getMonth()+1)+"-";
				strDate += (curr_time.getDate()<10?"0":"")+curr_time.getDate();
           $("#vv2").datebox("setValue", strDate); 
	  });
	   */
	   controlMove("dialogDiv1"); 
	$("#dialogDiv1").dialog({  
		 title:"跟进",
		 buttons: [{
				  id:"btnbc1",
	            text:'保 存',
	         iconCls:'icon-save',
	         handler:function(){
	        	var files={};
			 	$('#btnbc1').linkbutton('disable');
			 	$("#oldUploadFileList").children("input[type='file']").each(function(index){
			 		files[index]=this.id;
			 	});
				if(validate()){
				try{
				jQuery.ajaxFileUpload({
			        url: "GlsPjtLocation!saveFiles.action?_dateTime="+new Date(),//?param=+getFromData("#fromDate2"),
			        type: "post",
					secureuri: false,
        	        fileElementId: files,
			        dataType: "json",
			        success: function(json){
			        		jQuery.ajax({
			        	        url: "GlsPjtLocation!addGlsMore.action?_dateTime="+new Date(),
			        	        data: "param="+getFromData("#fromDate2")+"&list="+JSON.stringify(json.data),
			        	        type: "post",
			        	        dataType: "json",
			        	        success: function(json){
			        	        	if(json.flag){
										$("#fromDate2 input[name='ID']").val(json.data.ID);
										//saveUpLoad();
											$("#dialogDiv1").dialog('close');
											$.messager.alert('提示','保存成功');
											//$('#pageTable1').datagrid('load',{ID:json.data.ID});
										}else{
											$('#btnbc').linkbutton('enable');
											$.messager.alert('提示','保存失败，请与管理员联系！','warning');
									    }}
			        	    });  
			        }
			    });
				}catch(e){
				throw(e.name);
				}
				}
				else{
					$('#btnbc1').linkbutton('enable');
				}
             }
        },{
            text:'关 闭',
			iconCls:'icon-cancel',
            handler:function(){
               $("#dialogDiv1").dialog('close');
            }
        }]
	}); 
	$("#dialogDiv1").dialog('open');
	//alert(json.data.ID);
}


//搜索
function conditionsSelect(){
	$('#pageTable').datagrid('load', {
		CUS_NAME:$("#CUS_NAME").val(),
		PRO_CODE:$("#PRO_CODE").val(),
		PJT_NAME:$("#PJT_NAME").val(),
		STATUS:$("#TEMPLATE_TYPE_UPDATE0").combobox('getValue')
	
	});
}

function serchConfrim(CUS_ID){
		
				//alert(CUS_ID);
			      // href = "$!_basePath+'/customers/Customers!toViewCustInfo.action?ID='+CUS_ID
				// window.location.href=_basePath+'/customers/Customers!toViewCustInfo.action?CLIENT_ID='+CUS_ID+"&TYPE=LP&tab=view";
			     top.addTab('客户详细信息',_basePath+'/customers/Customers!toViewCustInfo.action?CLIENT_ID='+CUS_ID+"&TYPE=LP&tab=view");
 
			        
			  

}

function getOperation(value,rowDate,index){
	var	change ="";
	 if(parseInt(orgId)==parseInt(rowDate.ORD_ID)){
		change = change+ "<a href='javascript:void(0)' onclick='toFindGlsByOrderId("+value+","+rowDate.ORD_ID+")'>批示查看</a>" ; 
	 }else{
		change = change+ "<a href='javascript:void(0)' onclick='toFindGlsByOrderId("+value+","+rowDate.ORD_ID+")'>批示</a>" ;
	 }
		
		change=change+"&nbsp|&nbsp<a href='javascript:void(0)' onclick='toShowGenjinren("+value+")'>跟进记录</a>";
		//alert("orgId="+orgId+"|ordid="+rowDate.ORD_ID+"|rowDate.GLSNUM="+rowDate.GLSNUM);
	 if(parseInt(orgId)==parseInt(rowDate.ORD_ID)){
		 
		 //var pjtName = rowDate.PJT_NAME.replace(" ","-");
		 
		change=change+"&nbsp|&nbsp<a href='javascript:void(0)' onclick=addGlsGenjin('"+value+"')>跟进</a>";
	 	
		change=change+"&nbsp|&nbsp<a href='javascript:void(0)' onclick='toUpdateGls("+value+")'>修改</a>";
	 	
		//change=change+"&nbsp|&nbsp<a href='javascript:void(0)' onclick='deleteGls("+value+","+index+","+rowDate.CUS_ID+")'>删除</a>";
		
		change=change+"&nbsp|&nbsp<a href='javascript:void(0)' id='confirmId' onclick=confrim("+rowDate.ID+",'"+rowDate.CUS_NAME+"','"+rowDate.PRO_CODE+"')>确定立项</a>" ;
	 }
	 
	 return change;
}

/*查看(废弃 )**/
function toFindGls(ID){
	jQuery.ajax({
        url: "Gls!getGlsData.action?_dateTime="+new Date(),
        data: "ID=" + ID,
        type: "post",
        dataType: "json",
        success: function(json){
            if (json.flag) {
				$("#fromDate1 input[name='ID']").val(json.data.ID);
				$("#fromDate1 input[name='PRO_CODE']").val(json.data.PRO_CODE);
				$("#fromDate1 input[name='PJT_SHOT_NAME']").val(json.data.PJT_SHOT_NAME);
				$("#fromDate1 input[name='CUS_NAME']").val(json.data.CUS_NAME);
				$("#PRICE1").numberbox('setValue',json.data.PRICE);
				$("#GENJINREN1").val(json.data.GENJINREN);
				$("#PRO_COUNT1").numberbox('setValue',json.data.PRO_COUNT);
				$("#fromDate1 input[name='PJT_NAME']").val(json.data.PJT_NAME);
				
				$("#vv1").datebox('setValue', json.data.GENJIN_DATE);
				$("#sjtxdate1").datebox('setValue', json.data.DATAEND_DATE);
				$("#fromDate1 input[name='DEPT']").val(json.data.DEPT);
				$("#fromDate1 input[name='PJT_LOCATION']").val(json.data.PJT_LOCATION);
				$("#fromDate1 input[name='PJT_REFEREE']").val(json.data.PJT_REFEREE);
				$("#fromDate1 input[name='MEASUREMENT']").val(json.data.MEASUREMENT);
				$("#fromDate1 input[name='WRITE_MEN']").val(json.data.WRITE_MEN);
			
				$("#FOLLOWUP_RECORDS1").val(json.data.FOLLOWUP_RECORDS);
				$("#NEXT_FOLLOW_PLAN1").val(json.data.NEXT_FOLLOW_PLAN);
				$("#TEMPLATE_TYPE_UPDATE1").combobox('select',json.data.STATUS);
				/* $("#uploadedFile").empty();
				jQuery.ajax({
					url: "GlsPjtLocation!getFileListByProjectId.action?_dateTime="+new Date(),
			        data: "ID=" + ID,
			        type: "post",
			        dataType: "json",
			        success: function(json){
			        	if(json.data.length > 0){
						    for(var j=0; j < json.data.length; j++){
							  // alert("file_path="+glsFile[j].FILE_PATH+"|file_name="+glsFile[j].FILE_NAME);
						       $("#uploadedFile").append("<a href='Gls!download.action?path="+json.data[j].FILE_PATH+"&fileName="+json.data[j].FILE_NAME+"'>"+json.data[j].FILE_NAME+"</a></br>");
						    }
						}else{
							$("#uploadedFile").append("未上传文件");
						}
			        }
				}); */
				$("#dialogDivShow").dialog({   
					 title:"查 看",
					 buttons: [{
			            text:'关 闭',
						iconCls:'icon-cancel',
			            handler:function(){
			               $("#dialogDivShow").dialog('close');
			            }
			        }]
				}); 
				$("#dialogDivShow").dialog('open');
            } else {
				$.messager.alert('提示','加载失败，请与管理员联系！');
            }
        }
    })  
}
function clearInput(){
	$("#pageForm input").val("");
	
}


$(document).ready(function(){ 
	$('#dialogDiv').dialog({
	    onClose:function(){
			$("#fromDate").form('clear');
	    }
	});
})																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																					
$(document).ready(function(){ 
	$('#dialogDiv1').dialog({
	    onClose:function(){
			$("#fromDate2").form('clear');
	    }
	});
})
$(document).ready(function(){ 
	$('#recordDiv').dialog({
	    onClose:function(){
			$("#tbody_1").empty();
		
	    }
	});
})

/*修改*/
function toUpdateGls(ID){
	//$("#oldPjtLocation").show();
	//$("#oldUploadedFile").show();
	
	jQuery.ajax({
        url: "Gls!getGlsData.action?_dateTime="+new Date(),
        data: "ID=" + ID,
        type: "post",
        dataType: "json",
        success: function(json){
            if (json.flag) {
				$("#fromDate input[name='ID']").val(json.data.ID);
				$("#fromDate input[name='PRO_CODE']").val(json.data.PRO_CODE);
				$("#fromDate input[name='PJT_SHOT_NAME']").val(json.data.PJT_SHOT_NAME);
				$("#fromDate input[name='CUS_NAME']").val(json.data.CUS_NAME);
				//$("#PRICE").val(json.data.PRICE);
				$('#PRICE').numberbox('setValue',json.data.PRICE);   
				//alert(json.data.GENJINREN);
				$("#addGENJINREN").combobox('select',json.data.GENJINREN);
				$("#PRO_COUNT").numberbox('setValue',json.data.PRO_COUNT);
				$("#fromDate input[name='PJT_NAME']").val(json.data.PJT_NAME);
				
				$("#vv").datebox('setValue', json.data.GENJIN_DATE);
				$("#sjtxdate").datebox('setValue', json.data.DATAEND_DATE);
				$("#fromDate input[name='DEPT']").val(json.data.DEPT);
				//$("#fromDate input[name='PJT_LOCATION']").val(json.data.PJT_LOCATION); 
				//$("#fromDate input[name='PJT_LOCATION1']").val(json.data.PJT_LOCATION);
						
				$("#fromDate input[name='PJT_REFEREE']").val(json.data.PJT_REFEREE);
				$("#fromDate input[name='MEASUREMENT']").val(json.data.MEASUREMENT);
				$("#fromDate input[name='WRITE_MEN']").val(json.data.WRITE_MEN);
				//$("#FOLLOWUP_RECORDS").val(json.data.FOLLOWUP_RECORDS);
				//$("#NEXT_FOLLOW_PLAN").val(json.data.NEXT_FOLLOW_PLAN);
				$("#TEMPLATE_TYPE_UPDATE").combobox('select',json.data.STATUS);
				$("#CUS_TYPE1").combobox('select',json.data.CUS_TYPE);
				var files=["file_upload4","file_upload5","file_upload6"];
				/* $("#uploadedFile1").empty();
				jQuery.ajax({
					url: "GlsPjtLocation!getFileListByProjectId.action",
			        data: "ID=" + ID,
			        type: "post",
			        dataType: "json",
			        success: function(json){
			        	hideUploadInput();
			        	if(json.data.length > 0){
						    for(var j=0; j < json.data.length; j++){
						       $("#uploadedFile1").append("<a href='Gls!download.action?path="+json.data[j].FILE_PATH+"&fileName="+json.data[j].FILE_NAME+"' id='fileId"+json.data[j].ID+"'>"+json.data[j].FILE_NAME+"</a>  <input id='fileBtn"+json.data[j].ID+"' type='button' value='删除' onclick='delProjectFileByFileId("+json.data[j].ID+")'/></br>");
						    }
						}else{
							$("#uploadedFile1").append("未上传文件");
						}
			        	for (var int = 0; int < 3-json.data.length; int++) {
							$("#file_upload"+(4+int)).show();
			        		$("#viewFileUpload"+(4+int)).show();
						}
			        }
				}); */
				var pjtLocation=json.data.PJT_LOCATION;
				showPjtLocation(pjtLocation);
				controlMove("dialogDiv"); 
				$("#dialogDiv").dialog({   
					 title:"修 改",
					 buttons: [{
							  id:"btnbc_update",
				            text:'保 存',
				         iconCls:'icon-save',
				         handler:function(){
						 	$('#btnbc_update').linkbutton('disable');
						 	var provinceIndex = document.getElementById("province").options.selectedIndex;
						 	if(provinceIndex > 0){
						 		/**地区赋值begin**/
	                        	getPjtLocationData();
	                        	/**地区赋值end**/
						 	}
							
							jQuery.ajax({
						        url: "Gls!doUpdateGls.action?_dateTime="+new Date(),
						        data: "param="+getFromData("#fromDate"),
						        type: "post",
								//secureuri: false,
        	                    //fileElementId: files,
						        dataType: "json",
						        success: function(json){
					                if(json.flag){
										$("#dialogDiv").dialog('close');
										$('#pageTable').datagrid('load',{ID:json.data.ID});
										$.messager.alert('提示','修改成功！');
									}else{
										$('#btnbc_update').linkbutton('enable');
										$.messager.alert('提示','修改失败，请与管理员联系！','warning');
									}
						        }
						    })
			             }
			        },{
			            text:'关 闭',
						iconCls:'icon-cancel',
			            handler:function(){
			               $("#dialogDiv").dialog('close');
			            }
			        }]
				}); 
				$("#dialogDiv").dialog('open');
				
            } else {
				$.messager.alert('提示','加载失败，请与管理员联系！');
            }
        }
    })
}

/**删除文件**/
function delProjectFileByFileId(id){
	if(confirm('确定要删除吗?')){
	$("#fileBtn"+id).attr("disabled","true");
	jQuery.ajax({
		url: "GlsPjtLocation!delProjectFileByFileId.action",
        data: "ID=" + id,
        type: "post",
        dataType: "json",
        success: function(json){
        	if(json.flag){
        		$.messager.alert('提示','删除成功！');
        		$("#uploadedFile1").children('#fileId'+id).remove();
        		$("#uploadedFile1").children('#fileBtn'+id).remove();
        		var lth=$("#uploadedFile1 a").length;
        		hideUploadInput();
        		for (var int = 0; int < 3-lth; int++) {
        			$("#file_upload"+(4+int)).show();
        			$("#viewFileUpload"+(4+int)).show();
				}
			}else{
				$.messager.alert('提示','删除失败，请联系管理员！');
			}
        }
	});
	}
}

function hideUploadInput(){
	$("#file_upload4").hide();
	$("#viewFileUpload4").hide();
	$("#file_upload5").hide();
	$("#viewFileUpload5").hide();
	$("#file_upload6").hide();
	$("#viewFileUpload6").hide();
}

//显示跟进记录
function toShowGenjinren(glszId){
	jQuery.ajax({
        url: "Gls!getGlsData.action?_dateTime="+new Date(),
        data: "ID=" + glszId,
        type: "post",
        dataType: "json",
        success: function(json){
            if (json.flag) {
				$("#recordForm input[name='ID']").val(json.data.ID);
				$("#recordForm input[name='PRO_CODE']").val(json.data.PRO_CODE);
				$("#recordForm input[name='PJT_SHOT_NAME']").val(json.data.PJT_SHOT_NAME);
				$("#recordForm input[name='CUS_NAME']").val(json.data.CUS_NAME);
				$('#PRICE4').numberbox('setValue',json.data.PRICE);   
				//$("#addGENJINREN").combobox('select',json.data.GENJINREN);
				$("#PRO_COUNT4").numberbox('setValue',json.data.PRO_COUNT);
				$("#recordForm input[name='PJT_NAME']").val(json.data.PJT_NAME);
				$("#recordForm input[name='PJT_LOCATION']").val(json.data.PJT_LOCATION);
				//$("#vv").datebox('setValue', json.data.GENJIN_DATE);
				//$("#sjtxdate").datebox('setValue', json.data.DATAEND_DATE);
				$("#recordForm input[name='DEPT']").val(json.data.DEPT);
						
				$("#recordForm input[name='PJT_REFEREE']").val(json.data.PJT_REFEREE);
				$("#recordForm input[name='MEASUREMENT']").val(json.data.MEASUREMENT);
				$("#recordForm input[name='WRITE_MEN']").val(json.data.WRITE_MEN);
				//$("#TEMPLATE_TYPE_UPDATE").combobox('select',json.data.STATUS);
				//$("#CUS_TYPE1").combobox('select',json.data.CUS_TYPE);
}}});
	//alert(glszId);
	jQuery.ajax({
        url: "GlsPjtLocation!getGlsDataList.action?_dateTime="+new Date(),
        data: "ID=" + glszId,
        type: "post",
        dataType: "json",
        success: function(json){
            if (json.flag) {
				 $("#ID1").val(ID);
				 $("#ADDR1").val();
				 $("#pageTablef1_record").val(ID);
				//$("#recordDiv").each(function(){
				controlMove("recordDiv"); 
				$("#recordDiv").dialog({   
					 title:"跟进记录",
					 buttons: [{
			            text:'关 闭',
						iconCls:'icon-cancel',
			            handler:function(){
			               $("#recordDiv").dialog('close');
						  $("#tbody_1").empty();
						 
			            }
			        }]
				}); 
				//alert("data.length="+json.data.length);
				if(json.data.length<=0){
					$("#tbody_1").append($("<tr><td class='table_th' style='text-align:center ;' colspan='4'> 跟 进 查 看 </td></tr><tr><td style='text-align:center ;' colspan='4'>对不起，没有跟进记录</td></tr>"));
					$("#recordDiv").dialog('open');
					return;
				}
				for(var i=0; i<json.data.length; i++){
				    var glsData = json.data[i][0];
					var glsFile = json.data[i][1]; 
				    var PRO_CODE = "";
					if(glsData.PRO_CODE){
						PRO_CODE = glsData.PRO_CODE;
					}
					var PJT_NAME = "";
					if(glsData.PJT_NAME){
						PJT_NAME = glsData.PJT_NAME;
					}
					var GENJINREN = "";
					if(glsData.GENJINREN){
						GENJINREN = glsData.GENJINREN;
					}
					var WRITE_MEN ="";
					if(glsData.WRITE_MEN){
						WRITE_MEN = glsData.WRITE_MEN;
					}
					var DATAEND_DATE ="";
					if(glsData.DATAEND_DATE){
						DATAEND_DATE = glsData.DATAEND_DATE;
					}
					var NEXT_FOLLOW_PLAN ="";
					if(glsData.NEXT_FOLLOW_PLAN){
						NEXT_FOLLOW_PLAN = glsData.NEXT_FOLLOW_PLAN;
					}
					var FOLLOWUP_RECORDS ="";
					if(glsData.FOLLOWUP_RECORDS){
						FOLLOWUP_RECORDS = glsData.FOLLOWUP_RECORDS;
					}
					var STATUS ="";
					if(glsData.STATUS){
						STATUS = glsData.STATUS;
					}
					var GENJIN_DATE ="";
					if(glsData.GENJIN_DATE){
						GENJIN_DATE = glsData.GENJIN_DATE;
					}
					var ID ="";
					if(glsData.ID){
						ID = glsData.ID;
					}
					var ORD_ID ="";
					if(glsData.ORD_ID){
						ORD_ID = glsData.ORD_ID;
					}
					 $("#tbody_1").append($("<tbody>").append("<tr><td class='table_th' style='text-align:center' colspan='4'> 跟 进 记 录 </td></tr>").append("</tbody>"));
					 $("#tbody_1").append($("<tbody id='tglszId"+ID+"'>").append("<tr>")
							    .append("<td style='text-align:left;border-top-style: solid;border-top-width: 1px;' colspan='4'>跟进记录"+(i+1)+"：  操作：<span id='delId"+ID+"'></span></td></tr>")
        			
       			                .append("<tr>")
								.append("<td style='text-align:right'>跟进人：</td>")
								.append("<td ><input name='INSTRUCT_NAME1' class='easyui-textbox' id='INSTRUCT_NAME1' style='width: 180px;margin:0px' readonly = true value='"+GENJINREN+"'/></td>")
								.append("<td style='text-align:right'>跟进日期：</td>")
			  					.append("<td ><input class='easyui-textbox' data-options='required:true' style='width:180px' readonly = true value='"+GENJIN_DATE+"'></td></tr>")
       			 
       			                .append("<tr >")
								.append("<td style='text-align:right'>跟进记录：</td>")
			 					.append("<td colspan='4'><textarea style='width: 470;height:50px;resize: none;' readonly = true>"+FOLLOWUP_RECORDS+"</textarea> </td>")
								.append("</tr>")
       			   
       			                .append("<tr >")
								.append("<td style='text-align:right'>下一步跟进计划：</td>")
			 					.append("<td colspan='4'><textarea style='width: 470;height:50px;resize: none;' readonly = true>"+NEXT_FOLLOW_PLAN+"</textarea> </td>")
								.append("</tr>")
       			 
       			                .append("<tr >")
								.append("<td style='text-align:right'>附件：</td>")
			 					.append("<td align='center'><div id='path"+ID+"' style='width:auto'></div></td>")
								.append("</tr></tbody>")); 
										/*   $("#tbody_1").append($("<tr id='tglszId"+ID+"'>")
									.append("<td align='center' id='delId"+ID+"'></td>")
									.append("<td align='center'>"+FOLLOWUP_RECORDS+"</td>")
									.append("<td align='center'>"+NEXT_FOLLOW_PLAN+"</td>")
									.append("<td align='center'><div id='path"+ID+"' style='width:auto'></div>")
				 					.append("<td align='center'>"+GENJINREN+"</td>")
				 					.append("<td align='center'>"+GENJIN_DATE+"</td>")
									.append("</td></tr>")); */
									//alert("glsFile.length="+glsFile.length);
									if(glsFile.length > 0){
									    for(var j=0; j < glsFile.length; j++){
										  // alert("file_path="+glsFile[j].FILE_PATH+"|file_name="+glsFile[j].FILE_NAME);
									       $("#path"+ID).append("<a href='Gls!download.action?path="+glsFile[j].FILE_PATH+"&fileName="+glsFile[j].FILE_NAME+"'>"+glsFile[j].FILE_NAME+"</a></br>");
									    }
									}
									if(orgId==ORD_ID){
										$("#delId"+ID).append("<a href='javascript:void(0);' onclick='delGlsGenJinRecord("+ID+","+glszId+");'> 删除 </a>");
									}
									
									//getGlsFile(ID);
									//.append("<td align='center'>"+"<a href='Gls!download.action?ID="+json1.data[i].FILE_PATH++"'>"+json1.data[i].FILE_NAME+"</a>"+"</td></tr>"));
				}
				 
				
				//$("#recordDiv").append( $("#tbody_1"));
				
				$("#recordDiv").dialog('open');
				//controlMove("recordDiv");
            } else {
				$.messager.alert('提示','加载失败，请与管理员联系！');
            }
        }
    })
}

/**删除跟进记录**/
function delGlsGenJinRecord(id,glszId){
	if(confirm('确定要删除吗?')){
		jQuery.ajax({
			url: "GlsPjtLocation!delGlsZDataById.action",
	        data: "ID=" + id,
	        type: "post",
	        dataType: "json",
	        success: function(json){
	        	if(json.flag){
	        		$.messager.alert('提示','删除成功！');
	        		$("#tglszId"+id).remove();
				}else{
					$.messager.alert('提示','删除失败，请联系管理员！');
				}
	        }
		});
	}
}
	
	
/**获取文件list(废弃)**/
function getGlsFile(ID){
   jQuery.ajax({
         url: "GlsPjtLocation!getGlsFileDataList.action?_dateTime="+new Date(),
          data: "ID=" + ID,
         type: "post",
         dataType: "json",
    	 success: function(json1){
    	 //alert(json1.data.length);
    	 for(var i=0; i<json1.data.length; i++){
    	 $("#addr"+ID).append("<a href='Gls!download.action?ID="+json1.data[i].FILE_PATH+"'>"+json1.data[i].FILE_NAME+"</a>  ");   
	   }
	 }
   });
}


/**删除营销编号*/
function deleteGls(ID,index,CUS_ID){
	 $('#pageTable').datagrid('selectRow',index);
	var opts = $('#pageTable').datagrid('getSelected');
	jQuery.messager.confirm('提示', '确定删除营销编号为"'+opts.PRO_CODE+'"的数据吗？', function(r){
		if(r){
		jQuery.ajax({
	        url: "Gls!doDeleteGls.action?ID="+ID+"&CUS_ID="+CUS_ID,
	        type: "post",
	        dataType: "json",
	        success: function(json){
	            if(json.flag){
					$('#pageTable').datagrid('load');
				}else{
					$.messager.alert('提示','删除失败，请与管理员联系！','warning');
				}
	        }
	    })
		}
	})
}

function isChinaOrNumbOrLett(){//判断是否是汉字、字母、数字组成
	var s = $("#GENJINREN").val();
	var regu = "^[\da-za-zA-Z\u4e00-\u9fa5][\da-za-zA-Z\u4e00-\u9fa5\·]+$";  
    var re = new RegExp(regu);
	if (!re.test(s)) {
    	alert('人名请勿输入特殊字符,并且不少于两个字符');
    	$("#GENJINREN").val('');
    }
	
} 
function isChinaOrNumbOrLett1(){//判断是否是汉字、字母、数字组成
	var s = $("#CUS_NAME2").val();
	//var s2 = $("#PJT_REFEREE").val();
	var regu = "^[\da-za-zA-Z\u4e00-\u9fa5][\da-za-zA-Z\u4e00-\u9fa5\·\/\、]+$";  
    var re = new RegExp(regu);
	if (!re.test(s)) {
    	alert('人名请勿输入特殊字符,并且不少于两个字符');
    	$("#CUS_NAME2").val('');
    }
} 
function isChinaOrNumbOrLett2(){//判断是否是汉字、字母、数字组成
	var s = $("#PJT_REFEREE").val();
	var regu = "^[\da-za-zA-Z\u4e00-\u9fa5][\da-za-zA-Z\u4e00-\u9fa5\·\/\、]+$";  
    var re = new RegExp(regu);
	if (!re.test(s)) {
    	alert('人名请勿输入特殊字符,并且不少于两个字符');
    	$("#PJT_REFEREE").val('');
    }
} 
function passDate(){//判断是否跟进日期大于今天
	var curr_time = new Date();
	var vv2=$("#vv2").datebox('getValue');
	var v=vv2.split("-");
   	var strDate = curr_time.getFullYear()+"-";
	strDate += (curr_time.getMonth()<10?"0":"")+(curr_time.getMonth()+1)+"-";
	strDate += (curr_time.getDate()<10?"0":"")+curr_time.getDate();
	if(v[0]<curr_time.getFullYear() || v[1]<curr_time.getMonth() || v[2]<curr_time.getDate()){
		alert("跟进日期不能大于当前日期,请重新选择!");
		$("#vv2").datebox('setValue',strDate);
	}
} 
function addPassDate(){//判断是否跟进日期大于今天

//var now = new Date();
//alert(now.getYear()+"-"+((now.getMonth()+1)<10?"0":"")+(now.getMonth()+1)+"-"+(now.getDate()<10?"0":"")+now.getDate());
	var curr_time = new Date();
   	var strDate = curr_time.getFullYear()+"-";
	strDate += (curr_time.getMonth()<10?"0":"")+(curr_time.getMonth()+1)+"-";
	strDate += (curr_time.getDate()<10?"0":"")+curr_time.getDate();
	strDate = strDate.replace(/-/g,"");
	
	var genjinTime = $("#vv").datebox('getValue');
	genjinTime = genjinTime.replace(/-/g,"");
	if(genjinTime>strDate){
		alert("跟进日期不能大于当前日期,请重新选择!");
		$("#vv").datebox('setValue','');
	}

	
} 



function uploadFile(row,index){
	var divId = 'uploadFileDiv';
	var formId = 'uploadFileForm';
	$("#"+divId).show();
	$("#"+divId).dialog({   
		 title:'上传',
		 iconCls: 'icon-application',
     	 modal:true,
		 resizable:true,
		 buttons: [{
			id:"btnbc3",
            text:'点击上传',
            iconCls:'icon-up',
            handler:function(){
			 	$('#btnbc3').linkbutton('disable');
			 	row.PARENT_ID=row.ID;
			 	row.ID = '';
			 	row.REMARK = $("#uploadFileForm").find("#REMARK").val();
			 	row.FK_ID = row.FK_ID;
			 	var data_ = row;
				$("#uploadify").uploadify("settings", "formData", data_); 
				$('#uploadify').uploadify('upload','*');
            }
        },{
            text:'关闭',
			iconCls:'icon-cancel',
            handler:function(){
            	//$('#uploadify').uploadify('cancel','*');
               $("#"+divId).dialog('close');
            }
        }]
	}); 
	$("[name='upload']").each(function(){
		$(this).val('');
	});
	$('#FILE_TYPE1').val(row.TPM_TYPE);
	$("#uploadFileForm").find("#REMARK").val('');
}

function openUpload(pro_id){
	$('#PROJECT_ID').val(pro_id);
	$('#uploadFileDialog').show();
	$('#uploadFileDialog').dialog({
		title:'上传文件',
		width:600,
		height:300,
		closed:false,
		cache: false,
		buttons:[{
			text:'上传',
			iconCls:'icon-up',
			handler:function(){
//				$('#uploadFileForm').submit();
				saveUpLoad();
			}
		},{
            text:'关 闭',
			iconCls:'icon-cancel',
            handler:function(){
               $("#uploadFileDialog").dialog('close');
            }
        }]
	});
}
	function saveUpLoad(){
	var file=$("#file_upload").val();
	var GLS_ID=$("#GLS_ID").val();
	if(file==null||file==""){
		
		return false;
	}else{
		jQuery.ajaxFileUpload({
        	    url:"Gls!uploadFile.action?GLS_ID="+GLS_ID,
        	    secureuri:false,
        	    fileElementId:"file_upload",	 
        	    dataType: "json",
				success: function (data,status)  //服务器成功响应处理函数
                {alert("保存成功");
						$("#uploadFileDialog").dialog('close');
					if(data.flag){
						alert(data.msg);
					
					}else{
						
					}
                },

       	});	
		$("#uploadFileDialog").dialog('close');
	}
}


//校验是否重复
function ifRepeat(){
		jQuery.ajax({
	        url: "Gls!toValidateCode.action?_dateTime="+new Date(),
	        data: "PRO_CODE="+$("#PRO_CODE").val(),
	        type: "post",
	        dataType: "json",
	        success: function(json){
    			//console.info(json);
                if(json.flag){
					alert("营销编号已存在,请重新操作");
					window.location.href = _basePath + '/gls/Gls.action';
				}
	        }
	    })
	}
	
function exportExcel(){
	jQuery.messager.confirm("导出","确定要导出查询记录吗?",function(r){
		
		if(r){
			//alert(r);
			window.location.href = _basePath + "/gls/GlsPjtLocation!exportExcel.action?orderName="+$('#orderName').val()+"&orderType="+$('#orderType').val();
		}
	});
}

function changeList(orderName,orderType){
	//alert("changeList("+orderName+","+orderType+");");
	$('#orderName').val(orderName);
	$('#orderType').val(orderType);
	$('#pageTable').datagrid('load',{orderName:orderName,orderType:orderType});
}

</script>

 <style>
	html,body{margin:200px 400px;}
	#search{color:#aaa;border:1px solid #CC0000;padding:1px; }
</style> 
<body class="easyui-layout">
	   
	<div region="center" border="false">
		<div id="pageForm" style="padding: 20px ">
			<table border="0" cellpadding="4" cellspacing="0">
				<tr >
					<td style="text-align:right">
        				营销编号：
                    </td>
					<td >
						
                        <input name="PRO_CODE" id="PRO_CODE" style="width:100px" >
						#foreach($!item in $!codeType)	
								<option value="$!item.CODE" >$!item.CODE</option>
							#end
						
						</input>
                    </td>
					<td style="text-align:right">
        				项目名称：
                    </td>
					<td >
						<input name="PJT_NAME" id="PJT_NAME" style="width:100px"/>
                    </td>
					<td style="text-align:right">
        				客户名称：
                    </td>
					<td >
						<input name="CUS_NAME" id="CUS_NAME" style="width:100px"/>
                    </td>
					<td style="text-align:right">
        				跟进人：
                    </td>
					<td >
						<input name="GENJINREN" id="GENJINREN" style="width:100px"/>
                    </td>
					
					<td style="text-align:right">
        				当前状态：
                    </td>
					<td >
						<select class="easyui-combobox" editable="false"  name="STATUS" id="TEMPLATE_TYPE_UPDATE0" style="width: 180px;">
							<option value="">---请选择---</option>
						#foreach($!item in $!list)	
								<option value="$!item.CODE" #if($!item.CODE == $!list.CODE)selected#end>$!item.FLAG</option>
						#end
                        </select>
                    </td>
					<td style="text-align:right">
					
					<td colspan="2">
						<a href="javascript:void(0);" class="easyui-linkbutton" iconCls="icon-search" onclick="conditionsSelect();">查 询</a>
						<a href="javascript:void(0);" class="easyui-linkbutton" iconCls="icon-clean" onclick="clearInput();">清 空</a>
						<a href="javascript:void(0);" class="easyui-linkbutton" iconCls="icon-add" onclick="addGls()">添 加</a>
					 	<a href="javascript:void(0);" class="easyui-linkbutton" iconCls="icon-down" onclick='exportExcel();'>导出</a>
                    </td>                                               
				</tr>                                                   
            </table>
			
		</div>
			
		<table id="pageTable"
			   class="easyui-datagrid"
			   url="$_basePath/gls/Gls!getMgGlsData.action"
			   pagination="true"
			   rownumbers="true"
			   fitColumns="false"
			   fit="true"
			   singleSelect="true"
			   pageSize="20"
			   toolbar="#pageForm"
			   sortName="ID" 
			   sortOrder="ASC"
		>
			<thead>
				<tr>
					<th field="ID" align="center" width="280" sortable="true" formatter="getOperation">操作</th>
					<th field="PRO_CODE"  align="center" width="140" sortable="true">营销编号</th><!-- <a href="javascript:void(0);" onclick="changeList('PRO_CODE','ASC');"> ↑ </a>|<a href="javascript:void(0);" onclick="changeList('PRO_CODE','DESC');"> ↓ </a> -->
					<th field="PJT_NAME"   align="center" width="150">项目名称</th>
					<th field="PJT_SHOT_NAME"   align="center" width="100">项目简称</th>
					<th field="CUS_NAME" align="center" width="100">客户名称</th>
					##<th field="CUS_TYPE" align="center" width="70">客户类型</th>
					<th field="STATUS"  align="center" width="100">当前状态</th>
					<th field="PRICE" align="center" width="130" sortable="true">估计金额（万元）</th><!-- <a href="javascript:void(0);" onclick="changeList('PRICE','ASC');"> ↑ </a>|<a href="javascript:void(0);" onclick="changeList('PRICE','DESC');"> ↓ </a> -->
					<th field="GENJINREN" align="center" width="70">跟进人</th>
					<th field="GENJIN_DATE" align="center" width="100" sortable="true">跟进日期</th><!-- <a href="javascript:void(0);" onclick="changeList('GENJIN_DATE','ASC');"> ↑ </a>|<a href="javascript:void(0);" onclick="changeList('GENJIN_DATE','DESC');"> ↓ </a> -->
					##<th field="CUS_ID" align="center" width="100"></th>
				</tr>
			</thead>
			<input type="hidden" name="orderName" id="orderName"/>
			<input type="hidden" name="orderType" id="orderType"/>
		</table>
    </div>
    <div id="importInvoceMess-buttons">
        <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-save" onclick="uploadSave()">保存</a>
        <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-cancel" onclick="javascript:$('#importInvoceMess').dialog('close')">关闭</a>
    </div> 
	<!--添加/修改div--begin-->
	<div id="dialogDiv" class="easyui-dialog" closed="true" modal="true" resizable="true" style="width:650px; height:500px;">
		<form id="fromDate" >
			<input type="hidden" id="ID" name="ID"/>
    		<table border="0" cellpadding="5" cellspacing="0">
                <tr>
					<td class="table_th" style="text-align:center " colspan="4"> 基 本 信 息 </td>
				</tr>
				<tr >
					<td style="text-align:right" >营销编号：</td>
					<td >
						<input name="PRO_CODE" readonly = true style="width: 180px;margin:0px" />
                    </td>
                    <td style="text-align:right">
        				经办部门：
                    </td>
    				<td >
                        <input name="DEPT" readonly = true style="width: 180px;margin:0px" />
                    </td>
					<!--<td style="text-align:right">
        				##客户类型：
                    </td>
					<td >
						##<select class="easyui-combobox" data-options="required:true"  editable="false" name="CUS_TYPE" id="CUS_TYPE1" style="width: 180px;">
						##	<option value="">---请选择---</option>
						###foreach($!item in $!list2)	
						##		<option value="$!item.CODE" #if($!item.CODE == $!list2.CODE)selected#end>$!item.FLAG</option>
						###end
                      ##  </select>
                    </td>-->
					
                </tr>
				<tr >
    				
    				<td style="text-align:right">
        				客户名称：
                    </td>
					<td >
						<input name="CUS_NAME" id="CUS_NAME2"  onchange="isChinaOrNumbOrLett1()" style="width: 180px;margin:0px"/>
                    </td>
					<td style="text-align:right">
        				项目推荐人：
                    </td>
					<td >
						<input name="PJT_REFEREE" id="PJT_REFEREE"  onchange="isChinaOrNumbOrLett2()" style="width: 180px;margin:0px" />
                    </td>
				</tr>
				<tr >
    				<td style="text-align:right">
        				项目名称：
                    </td>
    				<td colspan="5">
						<input name="PJT_NAME" class="easyui-validatebox" data-options="required:true"  style="width: 460px;margin:0px" />
                    </td>
                </tr>
                <tr >
    				<td style="text-align:right">
        				项目简称：
                    </td>
					<td >
						<input name="PJT_SHOT_NAME" class="easyui-validatebox" validtype="length[0,6]" invalidMessage="有6个汉字以内"  data-options="required:true"  missingMessage="必须填写"  style="width: 180px;margin:0px" />
                    </td>
                    <td style="text-align:right">
        				信息填写人：
                    </td>
					<td >
						<input name="WRITE_MEN" readonly = true style="width: 180px;margin:0px" />
                    </td>
				</tr>
				<!-- <tr id="oldPjtLocation">
					<td style="text-align:right">
					    前项目所在地区：
	                </td>
					<td colspan="5">
						<input id="PJT_LOCATION1" name="PJT_LOCATION1" style="width:180px;" type="text" class="easyui-validatebox" readonly = true/>
	                </td>
			    </tr> -->
				<tr >
					<td style="text-align:right">
        				项目所在地区：
                    </td>
					<td colspan="5">
						
						<select name="province" id="province" style="width:150px">
						<option>--请选择--</option>
						</select>
						
						<select name="city" id="city" style="width:150px">
						<option>--请选择--</option>
						</select>
						
						<select name="county" id="county" style="width:150px">
						<option>--请选择--</option>
						</select>
						<input name="PJT_LOCATION" type="hidden" id="PJT_LOCATION"/>
						<!--<input name="PJT_LOCATION" style="width: 180px;margin:0px" />-->
                    </td>
				</tr>
				
				<tr >
    				
					<td style="text-align:right">
        				标的物数量：
                    </td>
					<td >
						<input id="PRO_COUNT" name="PRO_COUNT" class="easyui-numberbox" style="width: 180px;margin:0px" />
                    </td>
                    <td style="text-align:right">
        				标的物单位：
                    </td>
					<td >
						<input id="MEASUREMENT" name="MEASUREMENT" class="easyui-validatebox" style="width: 180px;margin:0px" />
                    </td> 
				</tr>
				<tr >
    				<td style="text-align:right">
        				标的物金额（万元）
                    </td>
					<td >
						<input id="PRICE" name="PRICE" class="easyui-numberbox" precision="2" style="width: 180px;margin:0px" />
                    </td>
					<td style="text-align:right">
        				当前状态：
                    </td>
					<td >
						<select class="easyui-combobox" data-options="required:true" editable="false" name="STATUS" readonly=true id="TEMPLATE_TYPE_UPDATE" style="width: 180px;">
							<option value="">前期调研中</option>
						#foreach($!item in $!list)	
								<option value="$!item.CODE" #if($!item.CODE == $!list.CODE)selected#end>$!item.FLAG</option>
							#end
                    </td>
					
				</tr>
				</table>
			<table border="0" cellpadding="5" cellspacing="0">
			    <tr>
					<td class="table_th" style="text-align:center " colspan="4"> 增 加 跟 进 </td>
				</tr>
				<tr >
					<td style="text-align:right">
        				跟进人：
                    </td>
					<td >
						<select class="easyui-combobox" data-options="required:true"  editable="false" name="GENJINREN" id="addGENJINREN"  style="width: 180px;">
							<option value="---请选择---"></option>
						    #foreach($!item in $!list1)	
								<option>$!item.NAME</option>
							#end
                    </td>
                    <td style="text-align:right">
        				跟进日期：
                    </td>
					<td >
						<input id = "vv" class="easyui-datebox" data-options="required:true" editable="false"  name="GENJIN_DATE" style="width:180px">
                    </td>
				</tr>
				 <tr>
				<td style="text-align:right">
						上传附件：
					</td>
                    <td colspan="4">
					<input type="text" id="viewFileUpload4" style="width:400px;" readonly = true/>
					<input type="file" name="file_upload" id="file_upload4" enctype="multipart/form-data" method="post" onchange="document.getElementById('viewFileUpload4').value=this.value;getUploadFileContent2(this);" size="10" style="width:62px;">
					<!-- <input type="text" id="viewFileUpload5" style="width:100px;" readonly = true/>
					<input type="file" name="file_upload" id="file_upload5" enctype="multipart/form-data" method="post" onchange="document.getElementById('viewFileUpload5').value=this.value;" size="10" style="width:65px;">
					<input type="text" id="viewFileUpload6" style="width:100px;" readonly = true/>
					<input type="file" name="file_upload" id="file_upload6" enctype="multipart/form-data" method="post" onchange="document.getElementById('viewFileUpload6').value=this.value;" size="10" style="width:65px;"> -->
					</br><span id="olduploadFileListName2" style="display: none;"></span>
					<div id="oldUploadFileList2" style="display: none;"></div>
					</td>
				</tr>
				 
				<tr>
    				<td style="text-align:right">
        				跟进记录：
                    </td>
					<td colspan="4">
						<textarea id="FOLLOWUP_RECORDS" name="FOLLOWUP_RECORDS" style="width: 470px; height:100px;" ></textarea> 
                    </td>
				</tr>
                <tr>
					<td style="text-align:right">
        				下一步跟进计划：
                    </td>
					<td colspan="4">
						<textarea id="NEXT_FOLLOW_PLAN" name = "NEXT_FOLLOW_PLAN" style="width: 470px; height:100px;"></textarea> 
                    </td>
				</tr>
            </table>
        </form>
    </div>
	<!--添加/修改div---end-->
	<!--跟进div---begin-->
	<div id="dialogDiv1" class="easyui-dialog" closed="true" modal="true" resizable="true" style="width:650px; height:500px;">
		<form id="fromDate2" >
			<input type="hidden" id="GLS_ID2" name="GLS_ID2"/>
    		<table border="0" cellpadding="5" cellspacing="0">
                <tr>
					<td class="table_th" style="text-align:center " colspan="4"> 基 本 信 息 </td>
				</tr>
				<tr >
					<td style="text-align:right">营销编号：</td>
					<td >
						<input name="PRO_CODE2" style="width: 180px;margin:0px" readonly = true/>
                    </td>
					<td style="text-align:right">
        				经办部门：
                    </td>
    				<td >
                        <input name="DEPT2"  style="width: 180px;margin:0px" readonly = true/>
                    </td>
                </tr>
				<tr >
    				<td style="text-align:right">
        				客户名称：
                    </td>
					<td >
						<input name="CUS_NAME2" style="width: 180px;margin:0px" readonly = true/>
                    </td>
                    <td style="text-align:right">
        				项目推荐人：
                    </td>
					<td >
						<input name="PJT_REFEREE2" style="width: 180px;margin:0px" readonly = true/>
                    </td>
				</tr>
				<tr >
				<td style="text-align:right;">
        				项目名称：
                    </td>
    				<td colspan="3">
						<input name="PJT_NAME2" data-options="required:true"  style="width: 460px;margin:0px" readonly = true/>
                    </td>
                </tr>
				
				<tr >
    				<td style="text-align:right">
        				项目简称：
                    </td>
					<td >
						<input name="PJT_SHOT_NAME2" data-options="required:true"  style="width: 180px;margin:0px" readonly = true/>
                        </td>
					<td style="text-align:right">
        				信息填写人：
                    </td>
					<td >
						<input name="WRITE_MEN2" style="width: 180px;margin:0px" readonly = true/>
                    
				</tr>
				
				<tr>
				   </td>	
						<td style="text-align:right">
        				项目所在地区：
                    </td>
					<td colspan="5">
						<input name="PJT_LOCATION2" style="width: 460px;margin:0px" readonly = true/>
                    </td>
				</tr>
				
				<tr >
					<td style="text-align:right">
        				标的物数量：
                    </td>
					<td >
						<input id="PRO_COUNT2" name="PRO_COUNT2" class="easyui-numberbox" style="width: 180px;margin:0px" readonly = true/>
                    </td>
                    <td style="text-align:right">
        				标的物单位：
                    </td>
					<td >
						<input id="MEASUREMENT2" name="MEASUREMENT2" class="easyui-validatebox" style="width: 180px;margin:0px" readonly = true/>
                    </td> 
				</tr>
				<tr >
    				<td style="text-align:right">
        				标的物金额(万元)
                    </td>
					<td >
						<input id="PRICE2" name="PRICE2" class="easyui-numberbox" precision="2" style="width: 180px;margin:0px" readonly = true/>
                    </td>
					<td style="text-align:right">
        				当前状态：
                    </td>
					<td >
						<select class="easyui-combobox" name="STATUS2" id="TEMPLATE_TYPE_UPDATE2" readonly = true style="width: 180px;">
							<option value="">前期调研中</option>
						#foreach($!item in $!list)	
								<option value="$!item.CODE" #if($!item.CODE == $!list.CODE)selected#end>$!item.FLAG</option>
						#end
                        </select>
						
                    </td>
					
				</tr>
             </table>
			 <table id="addGlsZById" border="0" cellpadding="5" cellspacing="0" style="border-collapse: collapse;">
                <tr>
					<td class="table_th" style="text-align:center " colspan="4"> 增 加 跟 进 </td>
				</tr>
				<tr >
					<td style="text-align:right">
        				跟进人：
                    </td>
					<td >
						<select class="easyui-combobox " data-options="required:true" editable="false" name="GENJINREN2" id="GENJINREN2"  style="width: 180px;">
							<option value="">---请选择---</option>
						#foreach($!item in $!list1)	
								<option>$!item.NAME</option>
							#end
                    </td>
					<td style="text-align:right">
        				跟进日期：
                    </td>
					<td >
						<input id = "GENJIN_DATE2" class="easyui-datebox" data-options="required:true"  name="GENJIN_DATE2" style="width:180px">
                    </td>
				</tr>
				<tr >
                    <td style="text-align:right">
						上传附件：
					</td>
                    <td colspan="4">
					<input type="text" id="viewFileUpload1" style="width:400px;" readonly = true/>
					<input type="file" name="file_upload1" id="file_upload1" enctype="multipart/form-data" method="post" onchange="document.getElementById('viewFileUpload1').value=this.value;getUploadFileContent(this);" size="10" style="width:62px;">
					<!-- <input type="text" id="viewFileUpload2" style="width:100px;" readonly = true/>
					<input type="file" name="file_upload2" id="file_upload2" enctype="multipart/form-data" method="post" onchange="document.getElementById('viewFileUpload2').value=this.value;" size="10" style="width:65px;">
					<input type="text" id="viewFileUpload3" style="width:100px;" readonly = true/>
					<input type="file" name="file_upload3" id="file_upload3" enctype="multipart/form-data" method="post" onchange="document.getElementById('viewFileUpload3').value=this.value;" size="10" style="width:65px;"> -->
					<span id="olduploadFileListName" style="display: none;"></span>
					<div id="oldUploadFileList" style="display: none;"></div>
					</td>
				</tr>
				<tr>
    				<td style="text-align:right">
        				跟进记录：
                    </td>
					<td colspan="3">
						<textarea id="FOLLOWUP_RECORDS2" name="FOLLOWUP_RECORDS2" style="width: 460px; height: 100px; "></textarea> 
                    </td>
				</tr>
                <tr>
					<td style="text-align:right">
        				下一步跟进计划：
                    </td>
					<td colspan="3">
						<textarea id="NEXT_FOLLOW_PLAN2" name = "NEXT_FOLLOW_PLAN2" style="width: 460px;height: 100px; "></textarea> 
                    </td>
				</tr>	
            </table>
        </form>
    </div>
	<!--跟进div---end-->
	<!--跟进记录div---begin-->
	<div  id="recordDiv" class="easyui-dialog" closed="true" modal="true" resizable="true" style="width:650px; height:480px;">
    <form id="recordForm" >
    <table  border="0" cellpadding="5" cellspacing="0" width="100%">
                <tr>
					<td class="table_th" style="text-align:center " colspan="4"> 基 本 信 息 </td>
				</tr>
				<input name="ID" type="hidden"/>
				<tr >
					<td style="text-align:right">营销编号：</td>
					<td >
						<input name="PRO_CODE" style="width: 180px;margin:0px" readonly = true/>
                    </td>
					<td style="text-align:right">
        				经办部门：
                    </td>
    				<td >
                        <input name="DEPT"  style="width: 180px;margin:0px" readonly = true/>
                    </td>
                </tr>
				<tr >
    				<td style="text-align:right">
        				客户名称：
                    </td>
					<td >
						<input name="CUS_NAME" style="width: 180px;margin:0px" readonly = true/>
                    </td>
                    <td style="text-align:right">
        				项目推荐人：
                    </td>
					<td >
						<input name="PJT_REFEREE" style="width: 180px;margin:0px" readonly = true/>
                    </td>
				</tr>
				<tr >
				<td style="text-align:right;">
        				项目名称：
                    </td>
    				<td colspan="3">
						<input name="PJT_NAME" data-options="required:true"  style="width: 480px;margin:0px" readonly = true/>
                    </td>
                </tr>
				<tr >
    				<td style="text-align:right">
        				项目简称：
                    </td>
					<td >
						<input name="PJT_SHOT_NAME" data-options="required:true"  style="width: 180px;margin:0px" readonly = true/>
                        </td>
					<td style="text-align:right">
        				信息填写人：
                    </td>
					<td >
						<input name="WRITE_MEN" style="width: 180px;margin:0px" readonly = true/>
				</tr>
				<tr>
				   </td>	
						<td style="text-align:right">
        				项目所在地区：
                    </td>
					<td colspan="5">
						<input name="PJT_LOCATION" style="width: 480px;margin:0px" readonly = true/>
                    </td>
				</tr>
				<tr >
					<td style="text-align:right">
        				标的物数量：
                    </td>
					<td >
						<input id="PRO_COUNT4" name="PRO_COUNT4" class="easyui-numberbox" style="width: 180px;margin:0px" readonly = true/>
                    </td>
                    <td style="text-align:right">
        				标的物单位：
                    </td>
					<td >
						<input id="MEASUREMENT" name="MEASUREMENT" class="easyui-validatebox" style="width: 180px;margin:0px" readonly = true/>
                    </td> 
				</tr>
				<tr >
    				<td style="text-align:right">
        				标的物金额(万元)
                    </td>
					<td >
						<input id="PRICE4" name="PRICE4" class="easyui-numberbox" precision="2" style="width: 180px;margin:0px" readonly = true/>
                    </td>
					<td style="text-align:right">
        				当前状态：
                    </td>
					<td >
						<select class="easyui-combobox" data-options="required:true"  name="STATUS" id="TEMPLATE_TYPE_UPDATE1" readonly = true style="width: 180px;">
							<option value="">前期调研中</option>
						#foreach($!item in $!list)	
								<option value="$!item.CODE" #if($!item.CODE == $!list.CODE)selected#end>$!item.FLAG</option>
							#end
                    </td>
					
				</tr>
            </table>
		 <table id="tbody_1" style="width: 600px;">
		 </table>
    </form>
</div>
	<!--跟进记录div---end-->
	
	<!--批示/批示查看div---begin-->
	<div id="dialogDivShow" class="easyui-dialog" closed="true" modal="true" resizable="true" style="width:600px; height:500px;">
		<form id="fromDate1" >
			<input type="hidden" id="ID" name="ID"/>
    		<table  border="0" cellpadding="5" cellspacing="0">
                <tr>
					<td class="table_th" style="text-align:center " colspan="4"> 基 本 信 息 </td>
				</tr>
				<tr >
					<td style="text-align:right">营销编号：</td>
					<td >
						<input name="PRO_CODE" style="width: 180px;margin:0px" readonly = true/>
                    </td>
					<!--  <td style="text-align:right">
        				##客户类型：
                    </td>
					<td >
						##<select class="easyui-combobox" data-options="required:true"  editable="false" name="CUS_TYPE" id="CUS_TYPE1" style="width: 180px;">
						##	<option value="">---请选择---</option>
						###foreach($!item in $!list2)	
						##		<option value="$!item.CODE" #if($!item.CODE == $!list2.CODE)selected#end>$!item.FLAG</option>
					##	#end
                    ##    </select>
                    </td>-->
					<td style="text-align:right">
        				经办部门：
                    </td>
    				<td >
                        <input name="DEPT"  style="width: 180px;margin:0px" readonly = true/>
                    </td>
                </tr>
				<tr >
    				
					
    				<td style="text-align:right">
        				客户名称：
                    </td>
					<td >
						<input name="CUS_NAME" style="width: 180px;margin:0px" readonly = true/>
                    </td>
                    <td style="text-align:right">
        				项目推荐人：
                    </td>
					<td >
						<input name="PJT_REFEREE" style="width: 180px;margin:0px" readonly = true/>
                    </td>
				</tr>
				<tr >
				<td style="text-align:right;">
        				项目名称：
                    </td>
    				<td colspan="3">
						<input name="PJT_NAME" data-options="required:true"  style="width: 455px;margin:0px" readonly = true/>
                    </td>
                </tr>
				
				<tr >
    				<td style="text-align:right">
        				项目简称：
                    </td>
					<td >
						<input name="PJT_SHOT_NAME" data-options="required:true"  style="width: 180px;margin:0px" readonly = true/>
                        </td>
					<td style="text-align:right">
        				信息填写人：
                    </td>
					<td >
						<input name="WRITE_MEN" style="width: 180px;margin:0px" readonly = true/>
                    
				</tr>
				
				<tr>
				   </td>	
						<td style="text-align:right">
        				项目所在地区：
                    </td>
					<td colspan="5">
						<input name="PJT_LOCATION" style="width: 455px;margin:0px" readonly = true/>
                    </td>
				</tr>
				
				<tr >
					<td style="text-align:right">
        				标的物数量：
                    </td>
					<td >
						<input id="PRO_COUNT1" name="PRO_COUNT" class="easyui-numberbox" style="width: 180px;margin:0px" readonly = true/>
                    </td>
                    <td style="text-align:right">
        				标的物单位：
                    </td>
					<td >
						<input id="MEASUREMENT" name="MEASUREMENT" class="easyui-validatebox" style="width: 180px;margin:0px" readonly = true/>
                    </td> 
				</tr>
				<tr >
    				<td style="text-align:right">
        				标的物金额(万元)
                    </td>
					<td >
						<input id="PRICE1" name="PRICE" class="easyui-numberbox" precision="2" style="width: 180px;margin:0px" readonly = true/>
                    </td>
					<td style="text-align:right">
        				当前状态：
                    </td>
					<td >
						<select class="easyui-combobox" data-options="required:true"  name="STATUS" id="TEMPLATE_TYPE_UPDATE1" readonly = true style="width: 180px;">
							<option value="">前期调研中</option>
						#foreach($!item in $!list)	
								<option value="$!item.CODE" #if($!item.CODE == $!list.CODE)selected#end>$!item.FLAG</option>
							#end
                    </td>
					
				</tr>
                <!--  <tr>
	               <td style="text-align:right" >
					  已传文件：
	               </td>
	                <td colspan="4" >
					  <div id="uploadedFile" name="uploadedFile"></div>
	               </td>
				</tr>-->
    			
				<!-- <tr >
    				<td style="text-align:right" >
        				跟进记录：
                    </td>
					<td colspan="4">
						<textarea id="FOLLOWUP_RECORDS1" name="FOLLOWUP_RECORDS"  style="width: 470px;height:180px;resize: none; ";" " readonly = true>
						</textarea> 
                    </td>
					
					
				</tr>
                <tr>
					<td style="text-align:right">
        				下一步跟进计划：
                    </td>
					<td colspan="4">
						<textarea id = "NEXT_FOLLOW_PLAN1" name = "NEXT_FOLLOW_PLAN" style="width: 470px;height: 180px;resize: none; ";" "resize: none;>
                        </textarea> 
                    </td>
				</tr> -->
            </table>
            <!-- 批示增加批示（领导）start -->
            <table id="addInstruct" border="0" cellpadding="5" cellspacing="0" style="border-collapse: collapse;">
                <tr>
					<td class="table_th" style="text-align:center " colspan="4"> 增 加 批 示 </td>
				</tr>
               <tr >
					<td style="text-align:right">
        				批示人：
                    </td>
					<td >
					   <select class="easyui-combobox" editable="false" name="INSTRUCT_NAME" id="INSTRUCT_NAME"  style="width: 180px;" required="required">
							<option value="">---请选择---</option>
						#foreach($!item in $!list1)	
								<option>$!item.NAME</option>
							#end
						<!-- <input name="INSTRUCT_NAME" class="easyui-textbox" data-options="prompt:'Enter a email address...',validType:'email'" id="INSTRUCT_NAME" style="width: 180px;margin:0px"/> -->
                    </td>
                    <td style="text-align:right">
        				批示日期：
                    </td>
					<td >
						<input id = "INSTRUCT_DATE" class="easyui-datebox" required="required" name="INSTRUCT_DATE" style="width:180px">
                    </td>
				</tr>
				<tr >
    				<td style="text-align:right" >
        				批示内容：
                    </td>
					<td colspan="4">
						<textarea id="INSTURCT_CONTENT" name="INSTURCT_CONTENT"  style="width: 465px;height:100px;resize: none;" ></textarea> 
                    </td>
				</tr>
				<tr >
					<td colspan="5" style="text-align: center;">
					<a href="javascript:void(0)" onclick="saveInstruct();" class="l-btn" group="" id="btnbc"><span class="l-btn-left"><span class="l-btn-text icon-save l-btn-icon-left">保 存</span></span></a>
                    </td>
				</tr>
			</table>
			 <!-- 批示增加批示（领导）start --> 
            <!-- 查看批示start -->
            <table id="queryInstruct" style="width: 567px;" border="0" cellpadding="5" cellspacing="0">
			</table>
			 <!-- 查看批示end -->
        </form>
		
    </div>
	 <!--批示/批示查看div---end-->
</body>
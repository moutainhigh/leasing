<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN"
"http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">
<mapper namespace="payReport">
	<select id="showPayDate" parameterType="map" resultType="map">
		SELECT ${SQL_COLUMN} FROM (	 
						 SELECT CC.* ,ROWNUM ROWNO FROM 
					(
						 SELECT 
							(SELECT B.FLAG FROM T_SYS_DATA_DICTIONARY B WHERE B.TYPE='还款计划状态' AND B.CODE=A.STATUS) STATUS,--状态
							C.LEASE_CODE,A.PAYLIST_CODE,A.VERSION_CODE,C.CLERK_NAME,D.NAME CLIENT_NAME,--客户名称
							to_char(A.CREATE_DATE,'yyyy-MM-dd') CREATE_DATE,to_char(A.START_DATE,'yyyy-MM-dd') START_DATE,
							E.PRODUCT_NAME,E.SPEC_NAME,E.COMPANY_NAME,E.WHOLE_ENGINE_CODE,E.AMOUNT,
							A.LEASE_TERM,to_char(A.END_DATE,'yyyy-MM-dd') END_DATE,A.LEASE_TOPRIC,A.MONEY_ALL,A.TOPRIC_SUBFIRENT,
							H.YEAR_INTEREST YD_INTEREST,--约定利率
							A.YEAR_INTEREST,--现行利率
							A.FIRSTRENT_VALUE,A.FIRSTRENT_RATE,
							(SELECT MAX(P.ITEM_MONEY) FROM FIL_RENT_PLAN_DETAIL P WHERE P.PAY_ID=A.ID AND P.PERIOD_NUM=1 AND P.ITEM_NAME='租金') FIRST_RENTMONEY,--第一期租金
							A.DEPOSIT_VALUE,(G.INSURANCE_PERCENT*0.01*G.LEASE_TOPRIC) INSURANCE_VALUE,
							A.POUNDAGE_PRICE,A.POUNDAGE_VALUE,E.STAYBUY_PRICE,A.FIRST_MONEY_ALL,
							(SELECT SUM(P.ITEM_MONEY) FROM FIL_RENT_PLAN_DETAIL P WHERE P.PAY_ID=A.ID AND P.ITEM_FLAG=4) OTHER_SUM,--其他费用合计
							(SELECT B.FLAG FROM T_SYS_SITE_DICTIONARY B WHERE B.TYPE='业务类型' AND B.CODE=C.PLATFORM_TYPE) PLATFORM_TYPE,--业务类型
							C.PROVINCE_NAME,--区域
							(SELECT B.FLAG FROM T_SYS_DATA_DICTIONARY B WHERE B.TYPE='客户类型' AND B.CODE=D.TYPE) CLIENT_TYPE,--客户类型
							E.SUPPLIERS_NAME--经销商
							FROM 
							FIL_RENT_PLAN_HEAD_BAS_MAX__V A,
							FIL_PROJECT_HEAD C ,
							FIL_CUST_CLIENT D,
							FIL_PROJECT_EQUIPMENT E,
							FIL_RENT_PLAN_HEAD_BAS_MIN__V H,
							FIL_RENT_PLAN_HEAD G
							WHERE A.PROJECT_ID=C.ID--支付表关联项目表
							AND C.CLIENT_ID=D.ID--由项目表关联客户表
							AND C.ID=E.PROJECT_ID AND E.ID = (SELECT MAX(O.ID) FROM FIL_PROJECT_EQUIPMENT O WHERE O.PROJECT_ID=C.ID)
							AND A.PAYLIST_CODE=H.PAYLIST_CODE
							AND A.ID=G.ID
							<if test="STATUS !=null and STATUS !='' and STATUS==0">and A.STATUS=0</if>
							<if test="STATUS !=null and STATUS !='' and STATUS==1">and A.STATUS!=0</if>
							<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==2">and trunc(A.CREATE_DATE)>=trunc(sysdate, 'mm')</if>
							<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==3">and trunc(A.CREATE_DATE)&lt;trunc(sysdate, 'mm') and trunc(A.CREATE_DATE) >= trunc(trunc(sysdate, 'mm')-1, 'mm')</if>
							<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==4">and trunc(A.CREATE_DATE)>=trunc(sysdate, 'yy')</if>
							<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==5">and trunc(A.CREATE_DATE)&lt;trunc(sysdate, 'yy') and trunc(A.CREATE_DATE) >= trunc(trunc(sysdate, 'yy')-1, 'yy')</if>
							<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==6 and START_TIME !=null and START_TIME !=''">and trunc(A.CREATE_DATE)>=to_date(#{START_TIME},'yyyy-MM-dd')</if>
							<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==6 and END_TIME !=null and END_TIME !=''">and trunc(A.CREATE_DATE)&lt;=to_date(#{END_TIME},'yyyy-MM-dd')</if>
		
			<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==6">ORDER BY CLIENT_TYPE DESC</if>
			<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==4">ORDER BY PLATFORM_TYPE DESC</if>
			<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==3">ORDER BY CLERK_NAME DESC</if>
			<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==5">ORDER BY PROVINCE_NAME DESC</if>
			<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==7">ORDER BY SUPPLIERS_NAME DESC</if>
			<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==8">ORDER BY STATUS DESC</if>
		) CC

				<if test="PAGE_END!=null and PAGE_END!=''">	WHERE ROWNUM &lt;= #{PAGE_END}</if>
				) CCC
		 <if test="PAGE_BEGIN!=null and PAGE_BEGIN!=''"> WHERE CCC.ROWNO >= #{PAGE_BEGIN}</if>

	</select>
	<select id="showPayDate_count" parameterType="map" resultType="int">
		select count(1) from (
					SELECT 
							(SELECT B.FLAG FROM T_SYS_DATA_DICTIONARY B WHERE B.TYPE='还款计划状态' AND B.CODE=A.STATUS) STATUS,--状态
							C.LEASE_CODE,A.PAYLIST_CODE,A.VERSION_CODE,C.CLERK_NAME,D.NAME CLIENT_NAME,--客户名称
							to_char(A.CREATE_DATE,'yyyy-MM-dd') CREATE_DATE,to_char(A.START_DATE,'yyyy-MM-dd') START_DATE,
							E.PRODUCT_NAME,E.SPEC_NAME,E.COMPANY_NAME,E.WHOLE_ENGINE_CODE,E.AMOUNT,
							A.LEASE_TERM,to_char(A.END_DATE,'yyyy-MM-dd') END_DATE,A.LEASE_TOPRIC,A.MONEY_ALL,A.TOPRIC_SUBFIRENT,
							H.YEAR_INTEREST YD_INTEREST,--约定利率
							A.YEAR_INTEREST,--现行利率
							A.FIRSTRENT_VALUE,A.FIRSTRENT_RATE,
							(SELECT MAX(P.ITEM_MONEY) FROM FIL_RENT_PLAN_DETAIL P WHERE P.PAY_ID=A.ID AND P.PERIOD_NUM=1 AND P.ITEM_NAME='租金') FIRST_RENTMONEY,--第一期租金
							A.DEPOSIT_VALUE,(G.INSURANCE_PERCENT*0.01*G.LEASE_TOPRIC) INSURANCE_VALUE,
							A.POUNDAGE_PRICE,A.POUNDAGE_VALUE,E.STAYBUY_PRICE,A.FIRST_MONEY_ALL,
							(SELECT SUM(P.ITEM_MONEY) FROM FIL_RENT_PLAN_DETAIL P WHERE P.PAY_ID=A.ID AND P.ITEM_FLAG=4) OTHER_SUM,--其他费用合计
							(SELECT B.FLAG FROM T_SYS_SITE_DICTIONARY B WHERE B.TYPE='业务类型' AND B.CODE=C.PLATFORM_TYPE) PLATFORM_TYPE,--业务类型
							C.PROVINCE_NAME,--区域
							(SELECT B.FLAG FROM T_SYS_DATA_DICTIONARY B WHERE B.TYPE='客户类型' AND B.CODE=D.TYPE) CLIENT_TYPE,--客户类型
							E.SUPPLIERS_NAME--经销商
							FROM 
							FIL_RENT_PLAN_HEAD_BAS_MAX__V A,
							FIL_PROJECT_HEAD C ,
							FIL_CUST_CLIENT D,
							FIL_PROJECT_EQUIPMENT E,
							FIL_RENT_PLAN_HEAD_BAS_MIN__V H,
							FIL_RENT_PLAN_HEAD G
							WHERE A.PROJECT_ID=C.ID--支付表关联项目表
							AND C.CLIENT_ID=D.ID--由项目表关联客户表
							AND C.ID=E.PROJECT_ID AND E.ID = (SELECT MAX(O.ID) FROM FIL_PROJECT_EQUIPMENT O WHERE O.PROJECT_ID=C.ID)
							AND A.PAYLIST_CODE=H.PAYLIST_CODE
							AND A.ID=G.ID
							<if test="STATUS !=null and STATUS !='' and STATUS==0">and A.STATUS=0</if>
							<if test="STATUS !=null and STATUS !='' and STATUS==1">and A.STATUS!=0</if>
							<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==2">and trunc(A.CREATE_DATE)>=trunc(sysdate, 'mm')</if>
							<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==3">and trunc(A.CREATE_DATE)&lt;trunc(sysdate, 'mm') and trunc(A.CREATE_DATE) >= trunc(trunc(sysdate, 'mm')-1, 'mm')</if>
							<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==4">and trunc(A.CREATE_DATE)>=trunc(sysdate, 'yy')</if>
							<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==5">and trunc(A.CREATE_DATE)&lt;trunc(sysdate, 'yy') and trunc(A.CREATE_DATE) >= trunc(trunc(sysdate, 'yy')-1, 'yy')</if>
							<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==6 and START_TIME !=null and START_TIME !=''">and trunc(A.CREATE_DATE)>=to_date(#{START_TIME},'yyyy-MM-dd')</if>
							<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==6 and END_TIME !=null and END_TIME !=''">and trunc(A.CREATE_DATE)&lt;=to_date(#{END_TIME},'yyyy-MM-dd')</if>
		)
	</select>
<!-- 新增支付表数，饼状图 -->	
	<select id="showGroupNewPay" parameterType="map" resultType="map">
		select 
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==4">aa.PLATFORM_TYPE DATA_TYPE,count(aa.PLATFORM_TYPE) DATA_VALUE</if>
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==3">aa.CLERK_NAME DATA_TYPE,count(aa.CLERK_NAME) DATA_VALUE</if>
		from (
			SELECT 
				(SELECT B.FLAG FROM T_SYS_DATA_DICTIONARY B WHERE B.TYPE='还款计划状态' AND B.CODE=A.STATUS) STATUS,--状态
				C.LEASE_CODE,A.PAYLIST_CODE,A.VERSION_CODE,C.CLERK_NAME,D.NAME CLIENT_NAME,--客户名称
				to_char(A.CREATE_DATE,'yyyy-MM-dd') CREATE_DATE,to_char(A.START_DATE,'yyyy-MM-dd') START_DATE,
				E.PRODUCT_NAME,E.SPEC_NAME,E.COMPANY_NAME,E.WHOLE_ENGINE_CODE,E.AMOUNT,
				A.LEASE_TERM,to_char(A.END_DATE,'yyyy-MM-dd') END_DATE,A.LEASE_TOPRIC,A.MONEY_ALL,A.TOPRIC_SUBFIRENT,
				H.YEAR_INTEREST YD_INTEREST,--约定利率
				A.YEAR_INTEREST,--现行利率
				A.FIRSTRENT_VALUE,A.FIRSTRENT_RATE,
				(SELECT MAX(P.ITEM_MONEY) FROM FIL_RENT_PLAN_DETAIL P WHERE P.PAY_ID=A.ID AND P.PERIOD_NUM=1 AND P.ITEM_NAME='租金') FIRST_RENTMONEY,--第一期租金
				A.DEPOSIT_VALUE,(G.INSURANCE_PERCENT*0.01*G.LEASE_TOPRIC) INSURANCE_VALUE,
				A.POUNDAGE_PRICE,A.POUNDAGE_VALUE,E.STAYBUY_PRICE,A.FIRST_MONEY_ALL,
				(SELECT SUM(P.ITEM_MONEY) FROM FIL_RENT_PLAN_DETAIL P WHERE P.PAY_ID=A.ID AND P.ITEM_FLAG=4) OTHER_SUM,--其他费用合计
				(SELECT B.FLAG FROM T_SYS_SITE_DICTIONARY B WHERE B.TYPE='业务类型' AND B.CODE=C.PLATFORM_TYPE) PLATFORM_TYPE,--业务类型
				C.PROVINCE_NAME,--区域
				(SELECT B.FLAG FROM T_SYS_DATA_DICTIONARY B WHERE B.TYPE='客户类型' AND B.CODE=D.TYPE) CLIENT_TYPE,--客户类型
				E.SUPPLIERS_NAME--经销商
				FROM 
				FIL_RENT_PLAN_HEAD_BAS_MAX__V A,
				FIL_PROJECT_HEAD C ,
				FIL_CUST_CLIENT D,
				FIL_PROJECT_EQUIPMENT E,
				FIL_RENT_PLAN_HEAD_BAS_MIN__V H,
				FIL_RENT_PLAN_HEAD G
				WHERE A.PROJECT_ID=C.ID--支付表关联项目表
				AND C.CLIENT_ID=D.ID--由项目表关联客户表
				AND C.ID=E.PROJECT_ID AND E.ID = (SELECT MAX(O.ID) FROM FIL_PROJECT_EQUIPMENT O WHERE O.PROJECT_ID=C.ID)
				AND A.PAYLIST_CODE=H.PAYLIST_CODE
				AND A.ID=G.ID
				<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==2">and trunc(A.CREATE_DATE)>=trunc(sysdate, 'mm')</if>
				<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==3">and trunc(A.CREATE_DATE)&lt;trunc(sysdate, 'mm') and trunc(A.CREATE_DATE) >= trunc(trunc(sysdate, 'mm')-1, 'mm')</if>
				<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==4">and trunc(A.CREATE_DATE)>=trunc(sysdate, 'yy')</if>
				<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==5">and trunc(A.CREATE_DATE)&lt;trunc(sysdate, 'yy') and trunc(A.CREATE_DATE) >= trunc(trunc(sysdate, 'yy')-1, 'yy')</if>
				<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==6 and START_TIME !=null and START_TIME !=''">and trunc(A.CREATE_DATE)>=to_date(#{START_TIME},'yyyy-MM-dd')</if>
				<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==6 and END_TIME !=null and END_TIME !=''">and trunc(A.CREATE_DATE)&lt;=to_date(#{END_TIME},'yyyy-MM-dd')</if>
		) aa
		group by 
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==4">aa.PLATFORM_TYPE</if>
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==3">aa.CLERK_NAME</if>
	</select>
<!-- 正常，饼状图 -->	
	<select id="showGroupNormalPay" parameterType="map" resultType="map">
		select 
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==5">aa.PROVINCE_NAME DATA_TYPE,count(aa.PROVINCE_NAME) DATA_VALUE</if>
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==6">aa.CLIENT_TYPE DATA_TYPE,count(aa.CLIENT_TYPE) DATA_VALUE</if>
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==7">aa.SUPPLIERS_NAME DATA_TYPE,count(aa.SUPPLIERS_NAME) DATA_VALUE</if>
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==3">aa.CLERK_NAME DATA_TYPE,count(aa.CLERK_NAME) DATA_VALUE</if>
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==4">aa.PLATFORM_TYPE DATA_TYPE,count(aa.PLATFORM_TYPE) DATA_VALUE</if>
		from (
			SELECT 
				(SELECT B.FLAG FROM T_SYS_DATA_DICTIONARY B WHERE B.TYPE='还款计划状态' AND B.CODE=A.STATUS) STATUS,--状态
				C.LEASE_CODE,A.PAYLIST_CODE,A.VERSION_CODE,C.CLERK_NAME,D.NAME CLIENT_NAME,--客户名称
				to_char(A.CREATE_DATE,'yyyy-MM-dd') CREATE_DATE,to_char(A.START_DATE,'yyyy-MM-dd') START_DATE,
				E.PRODUCT_NAME,E.SPEC_NAME,E.COMPANY_NAME,E.WHOLE_ENGINE_CODE,E.AMOUNT,
				A.LEASE_TERM,to_char(A.END_DATE,'yyyy-MM-dd') END_DATE,A.LEASE_TOPRIC,A.MONEY_ALL,A.TOPRIC_SUBFIRENT,
				H.YEAR_INTEREST YD_INTEREST,--约定利率
				A.YEAR_INTEREST,--现行利率
				A.FIRSTRENT_VALUE,A.FIRSTRENT_RATE,
				(SELECT MAX(P.ITEM_MONEY) FROM FIL_RENT_PLAN_DETAIL P WHERE P.PAY_ID=A.ID AND P.PERIOD_NUM=1 AND P.ITEM_NAME='租金') FIRST_RENTMONEY,--第一期租金
				A.DEPOSIT_VALUE,(G.INSURANCE_PERCENT*0.01*G.LEASE_TOPRIC) INSURANCE_VALUE,
				A.POUNDAGE_PRICE,A.POUNDAGE_VALUE,E.STAYBUY_PRICE,A.FIRST_MONEY_ALL,
				(SELECT SUM(P.ITEM_MONEY) FROM FIL_RENT_PLAN_DETAIL P WHERE P.PAY_ID=A.ID AND P.ITEM_FLAG=4) OTHER_SUM,--其他费用合计
				(SELECT B.FLAG FROM T_SYS_SITE_DICTIONARY B WHERE B.TYPE='业务类型' AND B.CODE=C.PLATFORM_TYPE) PLATFORM_TYPE,--业务类型
				C.PROVINCE_NAME,--区域
				(SELECT B.FLAG FROM T_SYS_DATA_DICTIONARY B WHERE B.TYPE='客户类型' AND B.CODE=D.TYPE) CLIENT_TYPE,--客户类型
				E.SUPPLIERS_NAME--经销商
				FROM 
				FIL_RENT_PLAN_HEAD_BAS_MAX__V A,
				FIL_PROJECT_HEAD C ,
				FIL_CUST_CLIENT D,
				FIL_PROJECT_EQUIPMENT E,
				FIL_RENT_PLAN_HEAD_BAS_MIN__V H,
				FIL_RENT_PLAN_HEAD G
				WHERE A.PROJECT_ID=C.ID--支付表关联项目表
				AND C.CLIENT_ID=D.ID--由项目表关联客户表
				AND C.ID=E.PROJECT_ID AND E.ID = (SELECT MAX(O.ID) FROM FIL_PROJECT_EQUIPMENT O WHERE O.PROJECT_ID=C.ID)
				AND A.PAYLIST_CODE=H.PAYLIST_CODE
				AND A.ID=G.ID
				AND A.STATUS=0
				<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==2">and trunc(A.CREATE_DATE)>=trunc(sysdate, 'mm')</if>
				<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==3">and trunc(A.CREATE_DATE)&lt;trunc(sysdate, 'mm') and trunc(A.CREATE_DATE) >= trunc(trunc(sysdate, 'mm')-1, 'mm')</if>
				<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==4">and trunc(A.CREATE_DATE)>=trunc(sysdate, 'yy')</if>
				<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==5">and trunc(A.CREATE_DATE)&lt;trunc(sysdate, 'yy') and trunc(A.CREATE_DATE) >= trunc(trunc(sysdate, 'yy')-1, 'yy')</if>
				<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==6 and START_TIME !=null and START_TIME !=''">and trunc(A.CREATE_DATE)>=to_date(#{START_TIME},'yyyy-MM-dd')</if>
				<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==6 and END_TIME !=null and END_TIME !=''">and trunc(A.CREATE_DATE)&lt;=to_date(#{END_TIME},'yyyy-MM-dd')</if>
		) aa
		group by 
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==5">aa.PROVINCE_NAME</if>
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==6">aa.CLIENT_TYPE</if>
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==7">aa.SUPPLIERS_NAME</if>
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==3">aa.CLERK_NAME</if>
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==4">aa.PLATFORM_TYPE</if>
	</select>
<!-- 变更，饼状图 -->	
	<select id="showGroupChangePay" parameterType="map" resultType="map">
		select
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==8">aa.STATUS DATA_TYPE,count(aa.STATUS) DATA_VALUE</if>
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==5">aa.PROVINCE_NAME DATA_TYPE,count(aa.PROVINCE_NAME) DATA_VALUE</if>
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==6">aa.CLIENT_TYPE DATA_TYPE,count(aa.CLIENT_TYPE) DATA_VALUE</if>
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==7">aa.SUPPLIERS_NAME DATA_TYPE,count(aa.SUPPLIERS_NAME) DATA_VALUE</if>
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==3">aa.CLERK_NAME DATA_TYPE,count(aa.CLERK_NAME) DATA_VALUE</if>
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==4">aa.PLATFORM_TYPE DATA_TYPE,count(aa.PLATFORM_TYPE) DATA_VALUE</if>
		from (
			SELECT 
				(SELECT B.FLAG FROM T_SYS_DATA_DICTIONARY B WHERE B.TYPE='还款计划状态' AND B.CODE=A.STATUS) STATUS,--状态
				C.LEASE_CODE,A.PAYLIST_CODE,A.VERSION_CODE,C.CLERK_NAME,D.NAME CLIENT_NAME,--客户名称
				to_char(A.CREATE_DATE,'yyyy-MM-dd') CREATE_DATE,to_char(A.START_DATE,'yyyy-MM-dd') START_DATE,
				E.PRODUCT_NAME,E.SPEC_NAME,E.COMPANY_NAME,E.WHOLE_ENGINE_CODE,E.AMOUNT,
				A.LEASE_TERM,to_char(A.END_DATE,'yyyy-MM-dd') END_DATE,A.LEASE_TOPRIC,A.MONEY_ALL,A.TOPRIC_SUBFIRENT,
				H.YEAR_INTEREST YD_INTEREST,--约定利率
				A.YEAR_INTEREST,--现行利率
				A.FIRSTRENT_VALUE,A.FIRSTRENT_RATE,
				(SELECT MAX(P.ITEM_MONEY) FROM FIL_RENT_PLAN_DETAIL P WHERE P.PAY_ID=A.ID AND P.PERIOD_NUM=1 AND P.ITEM_NAME='租金') FIRST_RENTMONEY,--第一期租金
				A.DEPOSIT_VALUE,(G.INSURANCE_PERCENT*0.01*G.LEASE_TOPRIC) INSURANCE_VALUE,
				A.POUNDAGE_PRICE,A.POUNDAGE_VALUE,E.STAYBUY_PRICE,A.FIRST_MONEY_ALL,
				(SELECT SUM(P.ITEM_MONEY) FROM FIL_RENT_PLAN_DETAIL P WHERE P.PAY_ID=A.ID AND P.ITEM_FLAG=4) OTHER_SUM,--其他费用合计
				(SELECT B.FLAG FROM T_SYS_SITE_DICTIONARY B WHERE B.TYPE='业务类型' AND B.CODE=C.PLATFORM_TYPE) PLATFORM_TYPE,--业务类型
				C.PROVINCE_NAME,--区域
				(SELECT B.FLAG FROM T_SYS_DATA_DICTIONARY B WHERE B.TYPE='客户类型' AND B.CODE=D.TYPE) CLIENT_TYPE,--客户类型
				E.SUPPLIERS_NAME--经销商
				FROM 
				FIL_RENT_PLAN_HEAD_BAS_MAX__V A,
				FIL_PROJECT_HEAD C ,
				FIL_CUST_CLIENT D,
				FIL_PROJECT_EQUIPMENT E,
				FIL_RENT_PLAN_HEAD_BAS_MIN__V H,
				FIL_RENT_PLAN_HEAD G
				WHERE A.PROJECT_ID=C.ID--支付表关联项目表
				AND C.CLIENT_ID=D.ID--由项目表关联客户表
				AND C.ID=E.PROJECT_ID AND E.ID = (SELECT MAX(O.ID) FROM FIL_PROJECT_EQUIPMENT O WHERE O.PROJECT_ID=C.ID)
				AND A.PAYLIST_CODE=H.PAYLIST_CODE
				AND A.ID=G.ID
				AND A.STATUS!=0
				<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==2">and trunc(A.CREATE_DATE)>=trunc(sysdate, 'mm')</if>
				<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==3">and trunc(A.CREATE_DATE)&lt;trunc(sysdate, 'mm') and trunc(A.CREATE_DATE) >= trunc(trunc(sysdate, 'mm')-1, 'mm')</if>
				<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==4">and trunc(A.CREATE_DATE)>=trunc(sysdate, 'yy')</if>
				<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==5">and trunc(A.CREATE_DATE)&lt;trunc(sysdate, 'yy') and trunc(A.CREATE_DATE) >= trunc(trunc(sysdate, 'yy')-1, 'yy')</if>
				<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==6 and START_TIME !=null and START_TIME !=''">and trunc(A.CREATE_DATE)>=to_date(#{START_TIME},'yyyy-MM-dd')</if>
				<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==6 and END_TIME !=null and END_TIME !=''">and trunc(A.CREATE_DATE)&lt;=to_date(#{END_TIME},'yyyy-MM-dd')</if>
		) aa
		group by 
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==8">aa.STATUS</if>
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==5">aa.PROVINCE_NAME</if>
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==6">aa.CLIENT_TYPE</if>
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==7">aa.SUPPLIERS_NAME</if>
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==3">aa.CLERK_NAME</if>
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==4">aa.PLATFORM_TYPE</if>
	</select>
	
	<select id="dictionaryByTypeCode" parameterType="map" resultType="map">
		select tsdd.TYPE,tsdd.FLAG,tsdd.CODE,tsdd.SHORTNAME from t_sys_data_dictionary tsdd where tsdd.type=#{TYPE} and tsdd.code=#{CODE} and rownum=1
	</select>
<!-- 新增支付表数，柱状图 -->	
	<select id="showGroupNewPayFX" parameterType="map" resultType="map">
		  select t1.CREATE_DATE CR,nvl(t2.COUNTS,0) COUNTS from (
      				select b.CREATE_DATE from (
						SELECT 
						<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==1">TO_CHAR(ADD_MONTHS (trunc(TO_DATE (#{END_TIME}, 'yyyy-mm-dd'), 'mm'), - (ROWNUM - 1)), 'yyyy-mm')</if>
						<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==2">TO_CHAR(ADD_MONTHS (trunc(sysdate, 'mm'), - (ROWNUM - 1)), 'yyyy-mm') </if>
						<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==3">TO_CHAR(ADD_MONTHS (trunc(trunc(sysdate, 'mm')-1, 'mm'), - (ROWNUM - 1)), 'yyyy-mm') </if>
						<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==4">TO_CHAR(ADD_MONTHS (trunc(sysdate, 'mm'), - (ROWNUM - 1)), 'yyyy-mm') </if>
						<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==5">TO_CHAR(ADD_MONTHS (trunc(trunc(sysdate, 'yy')-1, 'mm'), - (ROWNUM - 1)), 'yyyy-mm') </if>
						<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==6">TO_CHAR(ADD_MONTHS (trunc(TO_DATE (#{END_TIME}, 'yyyy-mm-dd'), 'mm'), - (ROWNUM - 1)), 'yyyy-mm')</if>
						CREATE_DATE
				  		FROM DUAL CONNECT BY ROWNUM &lt;
						<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==1">MONTHS_BETWEEN(trunc(TO_DATE (#{END_TIME}, 'yyyy-mm-dd'), 'mm'), trunc(TO_DATE (#{START_TIME}, 'yyyy-mm-dd'), 'mm'))+2</if>
						<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==2">MONTHS_BETWEEN(trunc(sysdate, 'mm'), trunc(sysdate, 'mm'))+2</if>
						<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==3">MONTHS_BETWEEN(trunc(trunc(sysdate, 'mm')-1, 'mm'), trunc(trunc(sysdate, 'mm')-1, 'mm'))+2</if>
						<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==4">MONTHS_BETWEEN(trunc(sysdate, 'mm'), trunc(sysdate, 'yy'))+2</if>
						<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==5">MONTHS_BETWEEN(trunc(trunc(sysdate, 'yy')-1, 'mm'), trunc(trunc(sysdate, 'yy')-1, 'yy'))+2</if>
						<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==6">MONTHS_BETWEEN(trunc(TO_DATE (#{END_TIME}, 'yyyy-mm-dd'), 'mm'), trunc(TO_DATE (#{START_TIME}, 'yyyy-mm-dd'), 'mm'))+2</if>
					) b order by b.CREATE_DATE
		   )t1
		  left join ( SELECT  T.CREATE_DATE CR,COUNT(CREATE_DATE) COUNTS FROM (
				  	select to_char(aa.CREATE_DATE,'YYYY-MM') CREATE_DATE
					from (
						SELECT 
							(SELECT B.FLAG FROM T_SYS_DATA_DICTIONARY B WHERE B.TYPE='还款计划状态' AND B.CODE=A.STATUS) STATUS,--状态
							C.LEASE_CODE,A.PAYLIST_CODE,A.VERSION_CODE,C.CLERK_NAME,C.CLERK_ID,D.NAME CLIENT_NAME,--客户名称
							A.CREATE_DATE,to_char(A.START_DATE,'yyyy-MM-dd') START_DATE,
							E.PRODUCT_NAME,E.SPEC_NAME,E.COMPANY_NAME,E.WHOLE_ENGINE_CODE,E.AMOUNT,
							A.LEASE_TERM,to_char(A.END_DATE,'yyyy-MM-dd') END_DATE,A.LEASE_TOPRIC,A.MONEY_ALL,A.TOPRIC_SUBFIRENT,
							H.YEAR_INTEREST YD_INTEREST,--约定利率
							A.YEAR_INTEREST,--现行利率
							A.FIRSTRENT_VALUE,A.FIRSTRENT_RATE,
							(SELECT MAX(P.ITEM_MONEY) FROM FIL_RENT_PLAN_DETAIL P WHERE P.PAY_ID=A.ID AND P.PERIOD_NUM=1 AND P.ITEM_NAME='租金') FIRST_RENTMONEY,--第一期租金
							A.DEPOSIT_VALUE,(G.INSURANCE_PERCENT*0.01*G.LEASE_TOPRIC) INSURANCE_VALUE,
							A.POUNDAGE_PRICE,A.POUNDAGE_VALUE,E.STAYBUY_PRICE,A.FIRST_MONEY_ALL,
							(SELECT SUM(P.ITEM_MONEY) FROM FIL_RENT_PLAN_DETAIL P WHERE P.PAY_ID=A.ID AND P.ITEM_FLAG=4) OTHER_SUM,--其他费用合计
							(SELECT B.FLAG FROM T_SYS_SITE_DICTIONARY B WHERE B.TYPE='业务类型' AND B.CODE=C.PLATFORM_TYPE) PLATFORM_TYPE,--业务类型
							C.PROVINCE_NAME,--区域
							(SELECT B.FLAG FROM T_SYS_DATA_DICTIONARY B WHERE B.TYPE='客户类型' AND B.CODE=D.TYPE) CLIENT_TYPE,--客户类型
							E.SUPPLIERS_NAME--经销商
							FROM 
							FIL_RENT_PLAN_HEAD_BAS_MAX__V A,
							FIL_PROJECT_HEAD C ,
							FIL_CUST_CLIENT D,
							FIL_PROJECT_EQUIPMENT E,
							FIL_RENT_PLAN_HEAD_BAS_MIN__V H,
							FIL_RENT_PLAN_HEAD G
							WHERE A.PROJECT_ID=C.ID--支付表关联项目表
							AND C.CLIENT_ID=D.ID--由项目表关联客户表
							AND C.ID=E.PROJECT_ID AND E.ID = (SELECT MAX(O.ID) FROM FIL_PROJECT_EQUIPMENT O WHERE O.PROJECT_ID=C.ID)
							AND A.PAYLIST_CODE=H.PAYLIST_CODE
							AND A.ID=G.ID
							<if test="STATUS !=null and STATUS !='' and STATUS==0">and A.STATUS=0</if>
							<if test="STATUS !=null and STATUS !='' and STATUS==1">and A.STATUS!=0</if>
							<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==2">and trunc(A.CREATE_DATE)>=trunc(sysdate, 'mm')</if>
							<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==3">and trunc(A.CREATE_DATE)&lt;trunc(sysdate, 'mm') and trunc(A.CREATE_DATE) >= trunc(trunc(sysdate, 'mm')-1, 'mm')</if>
							<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==4">and trunc(A.CREATE_DATE)>=trunc(sysdate, 'yy')</if>
							<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==5">and trunc(A.CREATE_DATE)&lt;trunc(sysdate, 'yy') and trunc(A.CREATE_DATE) >= trunc(trunc(sysdate, 'yy')-1, 'yy')</if>
							<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==6 and START_TIME !=null and START_TIME !=''">and trunc(A.CREATE_DATE)>=to_date(#{START_TIME},'yyyy-MM-dd')</if>
							<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==6 and END_TIME !=null and END_TIME !=''">and trunc(A.CREATE_DATE)&lt;=to_date(#{END_TIME},'yyyy-MM-dd')</if>
					) aa
					<where>
						<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==4">and aa.PLATFORM_TYPE=#{DATA_TYPE}</if>
						<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==3">and aa.CLERK_ID=#{CLERK_ID}</if>
					</where>
		    
			) T GROUP BY T.CREATE_DATE order by T.CREATE_DATE) t2  on t1.CREATE_DATE=t2.CR
		  order by t1.CREATE_DATE
		
	</select>
<!-- 变更，柱状图 -->
	<select id="showGroupChangePayFX" parameterType="map" resultType="map">
		  select t1.CREATE_DATE CR,nvl(t2.COUNTS,0) COUNTS from (
      				select b.CREATE_DATE from (
						SELECT 
						<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==1">TO_CHAR(ADD_MONTHS (trunc(TO_DATE (#{END_TIME}, 'yyyy-mm-dd'), 'mm'), - (ROWNUM - 1)), 'yyyy-mm')</if>
						<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==2">TO_CHAR(ADD_MONTHS (trunc(sysdate, 'mm'), - (ROWNUM - 1)), 'yyyy-mm') </if>
						<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==3">TO_CHAR(ADD_MONTHS (trunc(trunc(sysdate, 'mm')-1, 'mm'), - (ROWNUM - 1)), 'yyyy-mm') </if>
						<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==4">TO_CHAR(ADD_MONTHS (trunc(sysdate, 'mm'), - (ROWNUM - 1)), 'yyyy-mm') </if>
						<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==5">TO_CHAR(ADD_MONTHS (trunc(trunc(sysdate, 'yy')-1, 'mm'), - (ROWNUM - 1)), 'yyyy-mm') </if>
						<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==6">TO_CHAR(ADD_MONTHS (trunc(TO_DATE (#{END_TIME}, 'yyyy-mm-dd'), 'mm'), - (ROWNUM - 1)), 'yyyy-mm')</if>
						CREATE_DATE
				  		FROM DUAL CONNECT BY ROWNUM &lt;
						<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==1">MONTHS_BETWEEN(trunc(TO_DATE (#{END_TIME}, 'yyyy-mm-dd'), 'mm'), trunc(TO_DATE (#{START_TIME}, 'yyyy-mm-dd'), 'mm'))+2</if>
						<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==2">MONTHS_BETWEEN(trunc(sysdate, 'mm'), trunc(sysdate, 'mm'))+2</if>
						<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==3">MONTHS_BETWEEN(trunc(trunc(sysdate, 'mm')-1, 'mm'), trunc(trunc(sysdate, 'mm')-1, 'mm'))+2</if>
						<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==4">MONTHS_BETWEEN(trunc(sysdate, 'mm'), trunc(sysdate, 'yy'))+2</if>
						<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==5">MONTHS_BETWEEN(trunc(trunc(sysdate, 'yy')-1, 'mm'), trunc(trunc(sysdate, 'yy')-1, 'yy'))+2</if>
						<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==6">MONTHS_BETWEEN(trunc(TO_DATE (#{END_TIME}, 'yyyy-mm-dd'), 'mm'), trunc(TO_DATE (#{START_TIME}, 'yyyy-mm-dd'), 'mm'))+2</if>
					) b order by b.CREATE_DATE
		   )t1
		  left join ( SELECT  T.CREATE_DATE CR,COUNT(CREATE_DATE) COUNTS FROM (
				  	select to_char(aa.CREATE_DATE,'YYYY-MM') CREATE_DATE
					from (
						SELECT 
						(SELECT B.FLAG FROM T_SYS_DATA_DICTIONARY B WHERE B.TYPE='还款计划状态' AND B.CODE=A.STATUS) STATUS,--状态
						C.LEASE_CODE,A.PAYLIST_CODE,A.VERSION_CODE,C.CLERK_NAME,C.CLERK_ID,D.NAME CLIENT_NAME,--客户名称
						A.CREATE_DATE,to_char(A.START_DATE,'yyyy-MM-dd') START_DATE,
						E.PRODUCT_NAME,E.SPEC_NAME,E.COMPANY_NAME,E.WHOLE_ENGINE_CODE,E.AMOUNT,
						A.LEASE_TERM,to_char(A.END_DATE,'yyyy-MM-dd') END_DATE,A.LEASE_TOPRIC,A.MONEY_ALL,A.TOPRIC_SUBFIRENT,
						H.YEAR_INTEREST YD_INTEREST,--约定利率
						A.YEAR_INTEREST,--现行利率
						A.FIRSTRENT_VALUE,A.FIRSTRENT_RATE,
						(SELECT MAX(P.ITEM_MONEY) FROM FIL_RENT_PLAN_DETAIL P WHERE P.PAY_ID=A.ID AND P.PERIOD_NUM=1 AND P.ITEM_NAME='租金') FIRST_RENTMONEY,--第一期租金
						A.DEPOSIT_VALUE,(G.INSURANCE_PERCENT*0.01*G.LEASE_TOPRIC) INSURANCE_VALUE,
						A.POUNDAGE_PRICE,A.POUNDAGE_VALUE,E.STAYBUY_PRICE,A.FIRST_MONEY_ALL,
						(SELECT SUM(P.ITEM_MONEY) FROM FIL_RENT_PLAN_DETAIL P WHERE P.PAY_ID=A.ID AND P.ITEM_FLAG=4) OTHER_SUM,--其他费用合计
						(SELECT B.FLAG FROM T_SYS_SITE_DICTIONARY B WHERE B.TYPE='业务类型' AND B.CODE=C.PLATFORM_TYPE) PLATFORM_TYPE,--业务类型
						C.PROVINCE_NAME,--区域
						(SELECT B.FLAG FROM T_SYS_DATA_DICTIONARY B WHERE B.TYPE='客户类型' AND B.CODE=D.TYPE) CLIENT_TYPE,--客户类型
						E.SUPPLIERS_NAME--经销商
						FROM 
						FIL_RENT_PLAN_HEAD_BAS_MAX__V A,
						FIL_PROJECT_HEAD C ,
						FIL_CUST_CLIENT D,
						FIL_PROJECT_EQUIPMENT E,
						FIL_RENT_PLAN_HEAD_BAS_MIN__V H,
						FIL_RENT_PLAN_HEAD G
						WHERE A.PROJECT_ID=C.ID--支付表关联项目表
						AND C.CLIENT_ID=D.ID--由项目表关联客户表
						AND C.ID=E.PROJECT_ID AND E.ID = (SELECT MAX(O.ID) FROM FIL_PROJECT_EQUIPMENT O WHERE O.PROJECT_ID=C.ID)
						AND A.PAYLIST_CODE=H.PAYLIST_CODE
						AND A.ID=G.ID
						AND A.STATUS!=0
						<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==2">and trunc(A.CREATE_DATE)>=trunc(sysdate, 'mm')</if>
						<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==3">and trunc(A.CREATE_DATE)&lt;trunc(sysdate, 'mm') and trunc(A.CREATE_DATE) >= trunc(trunc(sysdate, 'mm')-1, 'mm')</if>
						<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==4">and trunc(A.CREATE_DATE)>=trunc(sysdate, 'yy')</if>
						<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==5">and trunc(A.CREATE_DATE)&lt;trunc(sysdate, 'yy') and trunc(A.CREATE_DATE) >= trunc(trunc(sysdate, 'yy')-1, 'yy')</if>
						<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==6 and START_TIME !=null and START_TIME !=''">and trunc(A.CREATE_DATE)>=to_date(#{START_TIME},'yyyy-MM-dd')</if>
						<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==6 and END_TIME !=null and END_TIME !=''">and trunc(A.CREATE_DATE)&lt;=to_date(#{END_TIME},'yyyy-MM-dd')</if>
					) aa
					<where>
						<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==8">and aa.STATUS=#{DATA_TYPE}</if>
						<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==5">and aa.PROVINCE_NAME=#{DATA_TYPE}</if>
						<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==6">and aa.CLIENT_TYPE=#{DATA_TYPE}</if>
						<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==7">and aa.SUPPLIERS_NAME=#{DATA_TYPE}</if>
						<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==3">and aa.CLERK_ID=#{CLERK_ID}</if>
						<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==4">and aa.PLATFORM_TYPE=#{DATA_TYPE}</if>
					</where>
		    
			) T GROUP BY T.CREATE_DATE order by T.CREATE_DATE) t2  on t1.CREATE_DATE=t2.CR
		  order by t1.CREATE_DATE
		
	</select>
	
	<select id="REPORT_X_MONTH" parameterType="map" resultType="map">
		 select b.CREATE_DATE X_VALUE from (
			SELECT 
			<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==1">TO_CHAR(ADD_MONTHS (trunc(TO_DATE (#{END_TIME}, 'yyyy-mm-dd'), 'mm'), - (ROWNUM - 1)), 'yyyy-mm')</if>
			<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==2">TO_CHAR(ADD_MONTHS (trunc(sysdate, 'mm'), - (ROWNUM - 1)), 'yyyy-mm') </if>
			<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==3">TO_CHAR(ADD_MONTHS (trunc(trunc(sysdate, 'mm')-1, 'mm'), - (ROWNUM - 1)), 'yyyy-mm') </if>
			<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==4">TO_CHAR(ADD_MONTHS (trunc(sysdate, 'mm'), - (ROWNUM - 1)), 'yyyy-mm') </if>
			<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==5">TO_CHAR(ADD_MONTHS (trunc(trunc(sysdate, 'yy')-1, 'mm'), - (ROWNUM - 1)), 'yyyy-mm') </if>
			<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==6">TO_CHAR(ADD_MONTHS (trunc(TO_DATE (#{END_TIME}, 'yyyy-mm-dd'), 'mm'), - (ROWNUM - 1)), 'yyyy-mm')</if>
			CREATE_DATE
	  		FROM DUAL CONNECT BY ROWNUM &lt;
			<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==1">MONTHS_BETWEEN(trunc(TO_DATE (#{END_TIME}, 'yyyy-mm-dd'), 'mm'), trunc(TO_DATE (#{START_TIME}, 'yyyy-mm-dd'), 'mm'))+2</if>
			<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==2">MONTHS_BETWEEN(trunc(sysdate, 'mm'), trunc(sysdate, 'mm'))+2</if>
			<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==3">MONTHS_BETWEEN(trunc(trunc(sysdate, 'mm')-1, 'mm'), trunc(trunc(sysdate, 'mm')-1, 'mm'))+2</if>
			<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==4">MONTHS_BETWEEN(trunc(sysdate, 'mm'), trunc(sysdate, 'yy'))+2</if>
			<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==5">MONTHS_BETWEEN(trunc(trunc(sysdate, 'yy')-1, 'mm'), trunc(trunc(sysdate, 'yy')-1, 'yy'))+2</if>
			<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==6">MONTHS_BETWEEN(trunc(TO_DATE (#{END_TIME}, 'yyyy-mm-dd'), 'mm'), trunc(TO_DATE (#{START_TIME}, 'yyyy-mm-dd'), 'mm'))+2</if>
		) b order by b.CREATE_DATE
	</select>
<!--  -->	
	<select id="PAYCREATE_TIME" parameterType="map" resultType="map">
		select to_char(min(fcc.CREATE_TIME),'yyyy-MM-dd') START_TIME,to_char(sysdate,'yyyy-MM-dd') END_TIME
			from fil_cust_client fcc 
			left join (
			     select fph.client_id,count(fph.client_id) CUST_NUMBER from fil_project_head fph where fph.status>=8 and fph.status !=9 and fph.status !=27 group by fph.client_id
			) a on fcc.id=a.client_id
	</select>
<!--  -->
	<select id="NEW_PAY_TYPE"  parameterType="map" resultType="map">
		select 
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==1">'新增支付表数' DATA_TYPE</if>
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==4">aa.PLATFORM_TYPE DATA_TYPE</if>
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==3">aa.CLERK_NAME DATA_TYPE,aa.CLERK_ID</if>
		from (
			SELECT 
				(SELECT B.FLAG FROM T_SYS_DATA_DICTIONARY B WHERE B.TYPE='还款计划状态' AND B.CODE=A.STATUS) STATUS,--状态
				C.LEASE_CODE,A.PAYLIST_CODE,A.VERSION_CODE,C.CLERK_NAME,C.CLERK_ID,D.NAME CLIENT_NAME,--客户名称
				to_char(A.CREATE_DATE,'yyyy-MM-dd') CREATE_DATE,to_char(A.START_DATE,'yyyy-MM-dd') START_DATE,
				E.PRODUCT_NAME,E.SPEC_NAME,E.COMPANY_NAME,E.WHOLE_ENGINE_CODE,E.AMOUNT,
				A.LEASE_TERM,to_char(A.END_DATE,'yyyy-MM-dd') END_DATE,A.LEASE_TOPRIC,A.MONEY_ALL,A.TOPRIC_SUBFIRENT,
				H.YEAR_INTEREST YD_INTEREST,--约定利率
				A.YEAR_INTEREST,--现行利率
				A.FIRSTRENT_VALUE,A.FIRSTRENT_RATE,
				(SELECT MAX(P.ITEM_MONEY) FROM FIL_RENT_PLAN_DETAIL P WHERE P.PAY_ID=A.ID AND P.PERIOD_NUM=1 AND P.ITEM_NAME='租金') FIRST_RENTMONEY,--第一期租金
				A.DEPOSIT_VALUE,(G.INSURANCE_PERCENT*0.01*G.LEASE_TOPRIC) INSURANCE_VALUE,
				A.POUNDAGE_PRICE,A.POUNDAGE_VALUE,E.STAYBUY_PRICE,A.FIRST_MONEY_ALL,
				(SELECT SUM(P.ITEM_MONEY) FROM FIL_RENT_PLAN_DETAIL P WHERE P.PAY_ID=A.ID AND P.ITEM_FLAG=4) OTHER_SUM,--其他费用合计
				(SELECT B.FLAG FROM T_SYS_SITE_DICTIONARY B WHERE B.TYPE='业务类型' AND B.CODE=C.PLATFORM_TYPE) PLATFORM_TYPE,--业务类型
				C.PROVINCE_NAME,--区域
				(SELECT B.FLAG FROM T_SYS_DATA_DICTIONARY B WHERE B.TYPE='客户类型' AND B.CODE=D.TYPE) CLIENT_TYPE,--客户类型
				E.SUPPLIERS_NAME--经销商
				FROM 
				FIL_RENT_PLAN_HEAD_BAS_MAX__V A,
				FIL_PROJECT_HEAD C ,
				FIL_CUST_CLIENT D,
				FIL_PROJECT_EQUIPMENT E,
				FIL_RENT_PLAN_HEAD_BAS_MIN__V H,
				FIL_RENT_PLAN_HEAD G
				WHERE A.PROJECT_ID=C.ID--支付表关联项目表
				AND C.CLIENT_ID=D.ID--由项目表关联客户表
				AND C.ID=E.PROJECT_ID AND E.ID = (SELECT MAX(O.ID) FROM FIL_PROJECT_EQUIPMENT O WHERE O.PROJECT_ID=C.ID)
				AND A.PAYLIST_CODE=H.PAYLIST_CODE
				AND A.ID=G.ID
				<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==2">and trunc(A.CREATE_DATE)>=trunc(sysdate, 'mm')</if>
				<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==3">and trunc(A.CREATE_DATE)&lt;trunc(sysdate, 'mm') and trunc(A.CREATE_DATE) >= trunc(trunc(sysdate, 'mm')-1, 'mm')</if>
				<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==4">and trunc(A.CREATE_DATE)>=trunc(sysdate, 'yy')</if>
				<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==5">and trunc(A.CREATE_DATE)&lt;trunc(sysdate, 'yy') and trunc(A.CREATE_DATE) >= trunc(trunc(sysdate, 'yy')-1, 'yy')</if>
				<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==6 and START_TIME !=null and START_TIME !=''">and trunc(A.CREATE_DATE)>=to_date(#{START_TIME},'yyyy-MM-dd')</if>
				<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==6 and END_TIME !=null and END_TIME !=''">and trunc(A.CREATE_DATE)&lt;=to_date(#{END_TIME},'yyyy-MM-dd')</if>
		) aa
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==1"> where rownum=1</if>
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==4">group by aa.PLATFORM_TYPE</if>
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==3">group by aa.CLERK_NAME,aa.CLERK_ID</if>
		
	</select>
<!--  -->	
	<select id="CHANGE_PAY_TYPE"  parameterType="map" resultType="map">
		select 
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==8">aa.STATUS DATA_TYPE</if>
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==5">aa.PROVINCE_NAME DATA_TYPE</if>
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==6">aa.CLIENT_TYPE DATA_TYPE</if>
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==7">aa.SUPPLIERS_NAME DATA_TYPE</if>
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==3">aa.CLERK_NAME DATA_TYPE,aa.CLERK_ID</if>
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==4">aa.PLATFORM_TYPE DATA_TYPE</if>
		from (
			SELECT 
				(SELECT B.FLAG FROM T_SYS_DATA_DICTIONARY B WHERE B.TYPE='还款计划状态' AND B.CODE=A.STATUS) STATUS,--状态
				C.LEASE_CODE,A.PAYLIST_CODE,A.VERSION_CODE,C.CLERK_NAME,C.CLERK_ID,D.NAME CLIENT_NAME,--客户名称
				to_char(A.CREATE_DATE,'yyyy-MM-dd') CREATE_DATE,to_char(A.START_DATE,'yyyy-MM-dd') START_DATE,
				E.PRODUCT_NAME,E.SPEC_NAME,E.COMPANY_NAME,E.WHOLE_ENGINE_CODE,E.AMOUNT,
				A.LEASE_TERM,to_char(A.END_DATE,'yyyy-MM-dd') END_DATE,A.LEASE_TOPRIC,A.MONEY_ALL,A.TOPRIC_SUBFIRENT,
				H.YEAR_INTEREST YD_INTEREST,--约定利率
				A.YEAR_INTEREST,--现行利率
				A.FIRSTRENT_VALUE,A.FIRSTRENT_RATE,
				(SELECT MAX(P.ITEM_MONEY) FROM FIL_RENT_PLAN_DETAIL P WHERE P.PAY_ID=A.ID AND P.PERIOD_NUM=1 AND P.ITEM_NAME='租金') FIRST_RENTMONEY,--第一期租金
				A.DEPOSIT_VALUE,(G.INSURANCE_PERCENT*0.01*G.LEASE_TOPRIC) INSURANCE_VALUE,
				A.POUNDAGE_PRICE,A.POUNDAGE_VALUE,E.STAYBUY_PRICE,A.FIRST_MONEY_ALL,
				(SELECT SUM(P.ITEM_MONEY) FROM FIL_RENT_PLAN_DETAIL P WHERE P.PAY_ID=A.ID AND P.ITEM_FLAG=4) OTHER_SUM,--其他费用合计
				(SELECT B.FLAG FROM T_SYS_SITE_DICTIONARY B WHERE B.TYPE='业务类型' AND B.CODE=C.PLATFORM_TYPE) PLATFORM_TYPE,--业务类型
				C.PROVINCE_NAME,--区域
				(SELECT B.FLAG FROM T_SYS_DATA_DICTIONARY B WHERE B.TYPE='客户类型' AND B.CODE=D.TYPE) CLIENT_TYPE,--客户类型
				E.SUPPLIERS_NAME--经销商
				FROM 
				FIL_RENT_PLAN_HEAD_BAS_MAX__V A,
				FIL_PROJECT_HEAD C ,
				FIL_CUST_CLIENT D,
				FIL_PROJECT_EQUIPMENT E,
				FIL_RENT_PLAN_HEAD_BAS_MIN__V H,
				FIL_RENT_PLAN_HEAD G
				WHERE A.PROJECT_ID=C.ID--支付表关联项目表
				AND C.CLIENT_ID=D.ID--由项目表关联客户表
				AND C.ID=E.PROJECT_ID AND E.ID = (SELECT MAX(O.ID) FROM FIL_PROJECT_EQUIPMENT O WHERE O.PROJECT_ID=C.ID)
				AND A.PAYLIST_CODE=H.PAYLIST_CODE
				AND A.ID=G.ID
				AND A.STATUS!=0
				<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==2">and trunc(A.CREATE_DATE)>=trunc(sysdate, 'mm')</if>
				<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==3">and trunc(A.CREATE_DATE)&lt;trunc(sysdate, 'mm') and trunc(A.CREATE_DATE) >= trunc(trunc(sysdate, 'mm')-1, 'mm')</if>
				<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==4">and trunc(A.CREATE_DATE)>=trunc(sysdate, 'yy')</if>
				<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==5">and trunc(A.CREATE_DATE)&lt;trunc(sysdate, 'yy') and trunc(A.CREATE_DATE) >= trunc(trunc(sysdate, 'yy')-1, 'yy')</if>
				<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==6 and START_TIME !=null and START_TIME !=''">and trunc(A.CREATE_DATE)>=to_date(#{START_TIME},'yyyy-MM-dd')</if>
				<if test="REPORT_DATE !=null and REPORT_DATE !='' and REPORT_DATE ==6 and END_TIME !=null and END_TIME !=''">and trunc(A.CREATE_DATE)&lt;=to_date(#{END_TIME},'yyyy-MM-dd')</if>
		) aa
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==8">group by aa.STATUS</if>
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==5">group by aa.PROVINCE_NAME</if>
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==6">group by aa.CLIENT_TYPE</if>
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==7">group by aa.SUPPLIERS_NAME</if>
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==3">group by aa.CLERK_NAME,aa.CLERK_ID</if>
		<if test="REPORT_TYPE !=null and REPORT_TYPE !='' and REPORT_TYPE ==4">group by aa.PLATFORM_TYPE</if>
		
	</select>
</mapper>